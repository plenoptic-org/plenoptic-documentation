

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plenoptic.tools package &mdash; plenoptic 1.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css?v=7f9a90b1" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=1ed6394b"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Display and animate functions" href="../tutorials/advanced/Display.html" />
    <link rel="prev" title="plenoptic.synthesize package" href="plenoptic.synthesize.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            plenoptic
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basic concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conceptual_intro.html">Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Model requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/00_quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citation Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method introductions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/02_Eigendistortions.html">Eigendistortions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/05_Geodesics.html">Representational Geodesic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/06_Metamer.html">Metamers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/07_Simple_MAD.html">MAD Competition Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/08_MAD_Competition.html">MAD Competition Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models and metrics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/03_Steerable_Pyramid.html">Steerable Pyramid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/04_Perceptual_distance.html">Perceptual distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/Metamer-Portilla-Simoncelli.html">Portilla-Simoncelli Texture Metamer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/09_Original_MAD.html">Reproducing Wang and Simoncelli, 2008 (MAD Competition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/Demo_Eigendistortion.html">Reproducing Berardino et al., 2017 (Eigendistortions)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../synthesis.html">Synthesis object design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tips.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reproducibility.html">Reproducibility</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="plenoptic.html">plenoptic package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="plenoptic.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="plenoptic.metric.html">plenoptic.metric package</a></li>
<li class="toctree-l4"><a class="reference internal" href="plenoptic.simulate.html">plenoptic.simulate package</a></li>
<li class="toctree-l4"><a class="reference internal" href="plenoptic.synthesize.html">plenoptic.synthesize package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">plenoptic.tools package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plenoptic.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="plenoptic.html#module-plenoptic.version">plenoptic.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="plenoptic.html#module-plenoptic">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Display.html">Display and animate functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Synthesis_extensions.html">Extending existing synthesis objects</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">plenoptic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">plenoptic</a></li>
          <li class="breadcrumb-item"><a href="plenoptic.html">plenoptic package</a></li>
      <li class="breadcrumb-item active">plenoptic.tools package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/plenoptic.tools.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plenoptic-tools-package">
<h1>plenoptic.tools package<a class="headerlink" href="#plenoptic-tools-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-plenoptic.tools.conv">
<span id="plenoptic-tools-conv-module"></span><h2>plenoptic.tools.conv module<a class="headerlink" href="#module-plenoptic.tools.conv" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.conv.blur_downsample">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.conv.</span></span><span class="sig-name descname"><span class="pre">blur_downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'binom5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/conv.html#blur_downsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.conv.blur_downsample" title="Link to this definition"></a></dt>
<dd><p>Correlate with a binomial coefficient filter and downsample by 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em><em> of </em><em>shape</em><em> (</em><em>batch</em><em>, </em><em>channel</em><em>, </em><em>height</em><em>, </em><em>width</em><em>)</em>) – Image, or batch of images. Channels are treated in the same way as batches.</p></li>
<li><p><strong>n_scales</strong> (<em>int</em><em>, </em><em>optional. Should be non-negative.</em>) – Apply the blur and downsample procedure recursively <cite>n_scales</cite> times. Default to 1.</p></li>
<li><p><strong>filtname</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the filter. See <cite>pt.named_filter</cite> for options. Default to “binom5”.</p></li>
<li><p><strong>scale_filter</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true (default), the filter sums to 1 (ie. it does not affect the DC
component of the signal). If false, the filter sums to 2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.conv.correlate_downsample">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.conv.</span></span><span class="sig-name descname"><span class="pre">correlate_downsample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/conv.html#correlate_downsample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.conv.correlate_downsample" title="Link to this definition"></a></dt>
<dd><p>Correlate with a filter and downsample by 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em><em> of </em><em>shape</em><em> (</em><em>batch</em><em>, </em><em>channel</em><em>, </em><em>height</em><em>, </em><em>width</em><em>)</em>) – Image, or batch of images. Channels are treated in the same way as batches.</p></li>
<li><p><strong>filt</strong> (<em>2-D torch.Tensor</em>) – The filter to correlate with the input image</p></li>
<li><p><strong>padding_mode</strong> (<em>string</em><em>, </em><em>optional</em>) – One of “constant”, “reflect”, “replicate”, “circular”. The option “constant”
means padding with zeros.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.conv.same_padding">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.conv.</span></span><span class="sig-name descname"><span class="pre">same_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'circular'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/conv.html#same_padding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.conv.same_padding" title="Link to this definition"></a></dt>
<dd><p>Pad a tensor so that 2D convolution will result in output with same dims.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.conv.upsample_blur">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.conv.</span></span><span class="sig-name descname"><span class="pre">upsample_blur</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filtname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'binom5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/conv.html#upsample_blur"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.conv.upsample_blur" title="Link to this definition"></a></dt>
<dd><p>Upsample by 2 and convolve with a binomial coefficient filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em><em> of </em><em>shape</em><em> (</em><em>batch</em><em>, </em><em>channel</em><em>, </em><em>height</em><em>, </em><em>width</em><em>)</em>) – Image, or batch of images. Channels are treated in the same way as batches.</p></li>
<li><p><strong>odd</strong> (<em>tuple</em><em>, </em><em>list</em><em> or </em><em>numpy.ndarray</em>) – This should contain two integers of value 0 or 1, which determines whether
the output height and width should be even (0) or odd (1).</p></li>
<li><p><strong>filtname</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the filter. See <cite>pt.named_filter</cite> for options. Default to “binom5”.</p></li>
<li><p><strong>scale_filter</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true (default), the filter sums to 4 (ie. it multiplies the signal
by 4 before the blurring operation). If false, the filter sums to 2.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.conv.upsample_convolve">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.conv.</span></span><span class="sig-name descname"><span class="pre">upsample_convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">odd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/conv.html#upsample_convolve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.conv.upsample_convolve" title="Link to this definition"></a></dt>
<dd><p>Upsample by 2 and convolve with a filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em><em> of </em><em>shape</em><em> (</em><em>batch</em><em>, </em><em>channel</em><em>, </em><em>height</em><em>, </em><em>width</em><em>)</em>) – Image, or batch of images. Channels are treated in the same way as batches.</p></li>
<li><p><strong>odd</strong> (<em>tuple</em><em>, </em><em>list</em><em> or </em><em>numpy.ndarray</em>) – This should contain two integers of value 0 or 1, which determines whether
the output height and width should be even (0) or odd (1).</p></li>
<li><p><strong>filt</strong> (<em>2-D torch.Tensor</em>) – The filter to convolve with the upsampled image</p></li>
<li><p><strong>padding_mode</strong> (<em>string</em><em>, </em><em>optional</em>) – One of “constant”, “reflect”, “replicate”, “circular”. The option “constant”
means padding with zeros.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.convergence">
<span id="plenoptic-tools-convergence-module"></span><h2>plenoptic.tools.convergence module<a class="headerlink" href="#module-plenoptic.tools.convergence" title="Link to this heading"></a></h2>
<p>Functions that check for optimization convergence/stabilization.</p>
<p>The functions herein generally differ in what they are checking for
convergence: loss, pixel change, etc.</p>
<p>They should probably be able to accept the following arguments, in this order
(they can accept more):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">synth</span></code>: an OptimizedSynthesis object to check.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>: the value used as criterion / tolerance that our
convergence target is compared against.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code>: how many iterations back to check for convergence.</p></li>
</ul>
<p>They must return a single <code class="docutils literal notranslate"><span class="pre">bool</span></code>: <code class="docutils literal notranslate"><span class="pre">True</span></code> if we’ve reached convergence,
<code class="docutils literal notranslate"><span class="pre">False</span></code> if not.</p>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.convergence.coarse_to_fine_enough">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.convergence.</span></span><span class="sig-name descname"><span class="pre">coarse_to_fine_enough</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf_iters_to_check</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/convergence.html#coarse_to_fine_enough"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.convergence.coarse_to_fine_enough" title="Link to this definition"></a></dt>
<dd><p>Check whether we’ve synthesized all scales and done so for at least ctf_iters_to_check iterations</p>
<p>This is meant to be paired with another convergence check, such as <code class="docutils literal notranslate"><span class="pre">loss_convergence</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>synth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="plenoptic.synthesize.html#plenoptic.synthesize.metamer.Metamer" title="plenoptic.synthesize.metamer.Metamer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Metamer</span></code></a></span>) – The Metamer object to check.</p></li>
<li><p><strong>i</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – The current iteration (0-indexed).</p></li>
<li><p><strong>ctf_iters_to_check</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Minimum number of iterations coarse-to-fine must run at each scale.
If self.coarse_to_fine is False, then this is ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether we’ve been doing coarse to fine synthesis for long enough.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ctf_enough</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.convergence.loss_convergence">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.convergence.</span></span><span class="sig-name descname"><span class="pre">loss_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_iters_to_check</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/convergence.html#loss_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.convergence.loss_convergence" title="Link to this definition"></a></dt>
<dd><p>Check whether the loss has stabilized and, if so, return True.</p>
<blockquote>
<div><p>Have we been synthesizing for <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> iterations?
| |</p>
</div></blockquote>
<dl>
<dt>no yes</dt><dd><div class="line-block">
<div class="line">‘—-&gt;Is <code class="docutils literal notranslate"><span class="pre">abs(synth.loss[-1]</span> <span class="pre">-</span> <span class="pre">synth.losses[-stop_iters_to_check])</span> <span class="pre">&lt;</span> <span class="pre">stop_criterion</span></code>?</div>
<div class="line-block">
<div class="line">no |</div>
<div class="line-block">
<div class="line">| yes</div>
</div>
</div>
</div>
<p>&lt;——-’ |
|         ‘——&gt; return <code class="docutils literal notranslate"><span class="pre">True</span></code>
|
‘———&gt; return <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>synth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="plenoptic.synthesize.html#plenoptic.synthesize.synthesis.OptimizedSynthesis" title="plenoptic.synthesize.synthesis.OptimizedSynthesis"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizedSynthesis</span></code></a></span>) – The OptimizedSynthesis object to check.</p></li>
<li><p><strong>stop_criterion</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – If the loss over the past <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> has changed
less than <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>, we terminate synthesis.</p></li>
<li><p><strong>stop_iters_to_check</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – How many iterations back to check in order to see if the
loss has stopped decreasing (for <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the loss has stabilized or not.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss_stabilized</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.convergence.pixel_change_convergence">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.convergence.</span></span><span class="sig-name descname"><span class="pre">pixel_change_convergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_iters_to_check</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/convergence.html#pixel_change_convergence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.convergence.pixel_change_convergence" title="Link to this definition"></a></dt>
<dd><p>Check whether the pixel change norm has stabilized and, if so, return True.</p>
<blockquote>
<div><p>Have we been synthesizing for <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> iterations?
| |</p>
</div></blockquote>
<dl>
<dt>no yes</dt><dd><div class="line-block">
<div class="line">‘—-&gt;Is <code class="docutils literal notranslate"><span class="pre">(synth.pixel_change_norm[-stop_iters_to_check:]</span> <span class="pre">&lt;</span> <span class="pre">stop_criterion).all()</span></code>?</div>
<div class="line-block">
<div class="line">no |</div>
<div class="line-block">
<div class="line">| yes</div>
</div>
</div>
</div>
<p>&lt;——-’ |
|         ‘——&gt; return <code class="docutils literal notranslate"><span class="pre">True</span></code>
|
‘———&gt; return <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>synth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="plenoptic.synthesize.html#plenoptic.synthesize.synthesis.OptimizedSynthesis" title="plenoptic.synthesize.synthesis.OptimizedSynthesis"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptimizedSynthesis</span></code></a></span>) – The OptimizedSynthesis object to check.</p></li>
<li><p><strong>stop_criterion</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – If the pixel change norm has been less than <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code> for all
of the past <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code>, we terminate synthesis.</p></li>
<li><p><strong>stop_iters_to_check</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – How many iterations back to check in order to see if the
pixel change norm has stopped decreasing (for <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the pixel change norm has stabilized or not.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss_stabilized</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.data">
<span id="plenoptic-tools-data-module"></span><h2>plenoptic.tools.data module<a class="headerlink" href="#module-plenoptic.tools.data" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.data.convert_float_to_int">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.data.</span></span><span class="sig-name descname"><span class="pre">convert_float_to_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.uint8'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/data.html#convert_float_to_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.data.convert_float_to_int" title="Link to this definition"></a></dt>
<dd><p>Convert image from float to 8 or 16 bit image</p>
<p>We work with float images that lie between 0 and 1, but for saving
them (either as png or in a numpy array), we want to convert them to
8 or 16 bit integers. This function does that by multiplying it by
the max value for the target dtype (255 for 8 bit 65535 for 16 bit)
and then converting it to the proper type.</p>
<p>We’ll raise an exception if the max is higher than 1, in which case
we have no idea what to do.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span>) – The image to convert</p></li>
<li><p><strong>dtype</strong> – The target data type.  {np.uint8, np.uint16}</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted image, now with dtype=dtype</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>im</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.data.load_images">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.data.</span></span><span class="sig-name descname"><span class="pre">load_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_gray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/data.html#load_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.data.load_images" title="Link to this definition"></a></dt>
<dd><p>Correctly load in images</p>
<p>Our models and synthesis methods expect their inputs to be 4d
float32 images: (batch, channel, height, width), where the batch
dimension contains multiple images and channel contains something
like RGB or color channel. This function helps you get your inputs
into that format. It accepts either a single file, a list of files,
or a single directory containing images, will load them in,
normalize them to lie between 0 and 1, convert them to float32,
optionally convert them to grayscale, make them tensors, and get
them into the right shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]]</span>) – A str or list of strs. If a list, must contain paths of image
files. If a str, can either be the path of a single image file
or of a single directory. If a directory, we try to load every
file it contains (using imageio.imwrite) and skip those we
cannot (thus, for efficiency you should not point this to a
directory with lots of non-image files). This is NOT recursive.</p></li>
<li><p><strong>as_gray</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether to convert the images into grayscale or not after
loading them. If False, we do nothing. If True, we call
skimage.color.rgb2gray on them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>4d tensor containing the images.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>images</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.data.make_synthetic_stimuli">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.data.</span></span><span class="sig-name descname"><span class="pre">make_synthetic_stimuli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/data.html#make_synthetic_stimuli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.data.make_synthetic_stimuli" title="Link to this definition"></a></dt>
<dd><p>Make a set of basic stimuli, useful for developping and debugging models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – The stimuli will have <cite>torch.Size([size, size])</cite>.</p></li>
<li><p><strong>requires_grad</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether to initialize the simuli with gradients.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape [11, 1, size, size]. The set of basic stiuli:
[impulse, step_edge, ramp, bar, curv_edge, sine_grating, square_grating,
polar_angle, angular_sine, zone_plate, fractal]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>stimuli</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.data.polar_angle">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.data.</span></span><span class="sig-name descname"><span class="pre">polar_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/data.html#polar_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.data.polar_angle" title="Link to this definition"></a></dt>
<dd><p>Make polar angle matrix (in radians).</p>
<p>Compute a matrix of given size containing samples of the polar angle (in radians, CW from the
X-axis, ranging from -pi to pi), relative to given phase, about the given origin pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – If an int, we assume the image should be of dimensions <cite>(size, size)</cite>. if a tuple, must be
a 2-tuple of ints specifying the dimensions</p></li>
<li><p><strong>phase</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – The phase of the polar angle function (in radians, clockwise from the X-axis)</p></li>
<li><p><strong>origin</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – The center of the image. if an int, we assume the origin is at <cite>(origin, origin)</cite>. if a
tuple, must be a 2-tuple of ints specifying the origin (where <cite>(0, 0)</cite> is the upper left).
if None, we assume the origin lies at the center of the matrix, <cite>(size+1)/2</cite>.</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>]</span>) – The device to create this tensor on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The polar angle matrix</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>res</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.data.polar_radius">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.data.</span></span><span class="sig-name descname"><span class="pre">polar_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/data.html#polar_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.data.polar_radius" title="Link to this definition"></a></dt>
<dd><p>Make distance-from-origin (r) matrix</p>
<p>Compute a matrix of given size containing samples of a radial ramp
function, raised to given exponent, centered at given origin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – If an int, we assume the image should be of dimensions <cite>(size,
size)</cite>. if a tuple, must be a 2-tuple of ints specifying the
dimensions.</p></li>
<li><p><strong>exponent</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – The exponent of the radial ramp function.</p></li>
<li><p><strong>origin</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – The center of the image. if an int, we assume the origin is at
<cite>(origin, origin)</cite>. if a tuple, must be a 2-tuple of ints
specifying the origin (where <cite>(0, 0)</cite> is the upper left).  if
None, we assume the origin lies at the center of the matrix,
<cite>(size+1)/2</cite>.</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – The device to create this tensor on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The polar radius matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>res</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.data.to_numpy">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.data.</span></span><span class="sig-name descname"><span class="pre">to_numpy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/data.html#to_numpy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.data.to_numpy" title="Link to this definition"></a></dt>
<dd><p>cast tensor to numpy in the most conservative way possible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – Tensor to be converted to <cite>numpy.ndarray</cite> on CPU.</p></li>
<li><p><strong>squeeze</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Removes all dummy dimensions of the tensor</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted tensor as <cite>numpy.ndarray</cite> on CPU.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.display">
<span id="plenoptic-tools-display-module"></span><h2>plenoptic.tools.display module<a class="headerlink" href="#module-plenoptic.tools.display" title="Link to this heading"></a></h2>
<p>various helpful utilities for plotting or displaying information</p>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.animshow">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">animshow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framerate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indep1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#animshow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.animshow" title="Link to this definition"></a></dt>
<dd><p>Animate video(s) correctly.</p>
<p>This function animates videos correctly, making sure that each element in
the tensor corresponds to a pixel or an integer number of pixels, to avoid
aliasing (NOTE: this guarantee only holds for the saved animation (assuming
video compression doesn’t interfere); it should generally hold in notebooks
as well, but will fail if, e.g., your video is 2000 pixels wide on an
monitor 1000 pixels wide; the notebook handles the rescaling in a way we
can’t control).</p>
<p>This functions returns the matplotlib FuncAnimation object. In order to
view it in a Jupyter notebook, use the
<code class="docutils literal notranslate"><span class="pre">plenoptic.convert_anim_to_html(anim)</span></code> function. In order to save, use
<code class="docutils literal notranslate"><span class="pre">anim.save(filename)</span></code> (note for this that you’ll need the appropriate
writer installed and on your path, e.g., ffmpeg, imagemagick, etc).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>video</strong> (<em>torch.Tensor</em><em> or </em><em>list</em>) – The videos to display. Tensors should be 5d (batch, channel, time,
height, width). List of tensors should be used for tensors of different
height and width: all videos will automatically be rescaled so they’re
displayed at the same height and width, thus, their heights and widths
must be scalar multiples of each other. Videos must all have the same
number of frames as well.</p></li>
<li><p><strong>framerate</strong> (<cite>float</cite>) – Temporal resolution of the video, in Hz (frames per second).</p></li>
<li><p><strong>repeat</strong> (<cite>bool</cite>) – whether to loop the animation or just play it once</p></li>
<li><p><strong>vrange</strong> (<cite>tuple</cite> or <cite>str</cite>) – <p>If a 2-tuple, specifies the image values vmin/vmax that are mapped to
the minimum and maximum value of the colormap, respectively. If a
string:</p>
<ul>
<li><dl class="simple">
<dt><cite>’auto0’</cite>: all images have same vmin/vmax, which have the same absolute</dt><dd><p>value, and come from the minimum or maximum across all
images, whichever has the larger absolute value</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto/auto1’</cite>: all images have same vmin/vmax, which are the</dt><dd><p>minimum/maximum values across all images</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto2’</cite>: all images have same vmin/vmax, which are the mean (across</dt><dd><p>all images) minus/ plus 2 std dev (across all images)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto3’</cite>: all images have same vmin/vmax, chosen so as to map the</dt><dd><p>10th/90th percentile values to the 10th/90th percentile of
the display intensity range. For example: vmin is the 10th
percentile image value minus 1/8 times the difference
between the 90th and 10th percentile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep0’</cite>: each image has an independent vmin/vmax, which have the</dt><dd><p>same absolute value, which comes from either their
minimum or maximum value, whichever has the larger
absolute value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep1’</cite>: each image has an independent vmin/vmax, which are their</dt><dd><p>minimum/maximum values</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep2’</cite>: each image has an independent vmin/vmax, which is their</dt><dd><p>mean minus/plus 2 std dev</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep3’</cite>: each image has an independent vmin/vmax, chosen so that</dt><dd><p>the 10th/90th percentile values map to the 10th/90th
percentile intensities.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>zoom</strong> (<cite>float</cite>) – ratio of display pixels to image pixels. if &gt;1, must be an integer. If
&lt;1, must be 1/d where d is a a divisor of the size of the largest
image.</p></li>
<li><p><strong>title</strong> (<cite>str</cite>, <cite>list</cite>, or None, optional) – <p>Title for the plot. In addition to the specified title, we add a
subtitle giving the plotted range and dimensionality (with zoom)
* if <cite>str</cite>, will put the same title on every plot.
* if <cite>list</cite>, all values must be <cite>str</cite>, must be the same length as img,</p>
<blockquote>
<div><p>assigning each title to corresponding image.</p>
</div></blockquote>
<ul>
<li><p>if None, no title will be printed (and subtitle will be removed).</p></li>
</ul>
</p></li>
<li><p><strong>col_wrap</strong> (<cite>int</cite> or None, optional) – number of axes to have in each row. If None, will fit all axes in a
single row.</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.axis</cite> or None, optional) – if None, we make the appropriate figure. otherwise, we resize the axes
so that it’s the appropriate number of pixels (done by shrinking the
bbox - if the bbox is already too small, this will throw an Exception!,
so first define a large enough figure using either
pyrtools.make_figure or plt.figure)</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib colormap</em><em>, </em><em>optional</em>) – colormap to use when showing these images</p></li>
<li><p><strong>plot_complex</strong> (<em>{'rectangular'</em><em>, </em><em>'polar'</em><em>, </em><em>'logpolar'}</em>) – <p>specifies handling of complex values.</p>
<ul>
<li><p><cite>’rectangular’</cite>: plot real and imaginary components as separate images</p></li>
<li><p><cite>’polar’</cite>: plot amplitude and phase as separate images</p></li>
<li><p><cite>’logpolar’</cite>: plot log_2 amplitude and phase as separate images</p></li>
</ul>
<p>for any other value, we raise a warning and default to rectangular.</p>
</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Which element from the batch dimension to plot. If None, we plot all.</p></li>
<li><p><strong>channel_idx</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Which element from the channel dimension to plot. If None, we plot all.
Note if this is an int, then <cite>as_rgb=True</cite> will fail, because we
restrict the channels.</p></li>
<li><p><strong>as_rgb</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to consider the channels as encoding RGB(A) values. If True, we
attempt to plot the image in color, so your tensor must have 3 (or 4 if
you want the alpha channel) elements in the channel dimension, or this
will raise an Exception. If False, we plot each channel as a separate
grayscale image.</p></li>
<li><p><strong>kwargs</strong> – Passed to <cite>ax.imshow</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>anim</strong> – The animation object. In order to view, must convert to HTML
or save.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.animation.FuncAnimation</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>By default, we use the ffmpeg backend, which requires that you have
ffmpeg installed and on your path (<a class="reference external" href="https://ffmpeg.org/download.html">https://ffmpeg.org/download.html</a>).
To use a different, use the matplotlib rcParams:
<cite>matplotlib.rcParams[‘animation.writer’] = writer</cite>, see
<a class="reference external" href="https://matplotlib.org/stable/api/animation_api.html#writer-classes">https://matplotlib.org/stable/api/animation_api.html#writer-classes</a> for
more details.</p>
<p>For displaying in a jupyter notebook, ffmpeg appears to be required.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.clean_stem_plot">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">clean_stem_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#clean_stem_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.clean_stem_plot" title="Link to this definition"></a></dt>
<dd><p>convenience wrapper for plotting stem plots</p>
<p>This plots the data, baseline, cleans up the axis, and sets the
title</p>
<p>Should not be called by users directly, but is a helper function for
the various plot_representation() functions</p>
<p>By default, stem plot would have a baseline that covers the entire
range of the data. We want to be able to break that up visually (so
there’s a line from 0 to 9, from 10 to 19, etc), and passing xvals
separately allows us to do that. If you want the default stem plot
behavior, leave xvals as None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<cite>np.ndarray</cite>) – The data to plot (as a stem plot)</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.axis</cite> or <cite>None</cite>, optional) – The axis to plot the data on. If None, we plot on the current
axis</p></li>
<li><p><strong>title</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The title to put on the axis if not None. If None, we don’t call
<code class="docutils literal notranslate"><span class="pre">ax.set_title</span></code> (useful if you want to avoid changing the title
on an existing plot)</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If not None, the y-limits to use for this plot. If None, we
use the default, slightly adjusted so that the minimum is 0</p></li>
<li><p><strong>xvals</strong> (<cite>tuple</cite> or <cite>None</cite>, optional) – A 2-tuple of lists, containing the start (<code class="docutils literal notranslate"><span class="pre">xvals[0]</span></code>) and stop
(<code class="docutils literal notranslate"><span class="pre">xvals[1]</span></code>) x values for plotting. If None, we use the
default stem plot behavior.</p></li>
<li><p><strong>kwargs</strong> – passed to ax.stem</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – The axis with the plot</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>matplotlib.pyplot.axis</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>We allow for breaks in the baseline value if we want to visually
break up the plot, as we see below.</p>
<dl>
<dt>..plot::</dt><dd><dl class="field-list simple">
<dt class="field-odd">include-source<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>import plenoptic as po
import numpy as np
import matplotlib.pyplot as plt
# if ylim=None, as in this example, the minimum y-valuewill get
# set to 0, so we want to make sure our values are all positive
y = np.abs(np.random.randn(55))
y[15:20] = np.nan
y[35:40] = np.nan
# we want to draw the baseline from 0 to 14, 20 to 34, and 40 to
# 54, everywhere that we have non-NaN values for y
xvals = ([0, 20, 40], [14, 34, 54])
po.tools.display.clean_stem_plot(y,  xvals=xvals)
plt.show()</p>
</dd>
</dl>
<p>If we don’t care about breaking up the x-axis, you can simply use
the default xvals (<code class="docutils literal notranslate"><span class="pre">None</span></code>). In this case, this function will just
clean up the plot a little bit</p>
<dl>
<dt>..plot::</dt><dd><dl class="field-list simple">
<dt class="field-odd">include-source<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>import plenoptic as po
import numpy as np
import matplotlib.pyplot as plt
# if ylim=None, as in this example, the minimum y-valuewill get
# set to 0, so we want to make sure our values are all positive
y = np.abs(np.random.randn(55))
po.tools.display.clean_stem_plot(y)
plt.show()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.clean_up_axes">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">clean_up_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spines_to_remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['top',</span> <span class="pre">'right',</span> <span class="pre">'bottom']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes_to_remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['x']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#clean_up_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.clean_up_axes" title="Link to this definition"></a></dt>
<dd><p>Clean up an axis, as desired when making a stem plot of the representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.axis</cite>) – The axis to clean up.</p></li>
<li><p><strong>ylim</strong> (<cite>tuple</cite>, False, or None) – If a tuple, the y-limits to use for this plot. If None, we use the
default, slightly adjusted so that the minimum is 0. If False,
we do nothing.</p></li>
<li><p><strong>spines_to_remove</strong> (<cite>list</cite>) – Some combination of ‘top’, ‘right’, ‘bottom’, and ‘left’. The spines we
remove from the axis.</p></li>
<li><p><strong>axes_to_remove</strong> (<cite>list</cite>) – Some combination of ‘x’, ‘y’. The axes to set as invisible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – The cleaned-up axis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.pyplot.axis</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.convert_anim_to_html">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">convert_anim_to_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#convert_anim_to_html"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.convert_anim_to_html" title="Link to this definition"></a></dt>
<dd><p>convert a matplotlib animation object to HTML (for display)</p>
<p>This is a simple little wrapper function that allows the animation
to be displayed in a Jupyter notebook</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>anim</strong> (<cite>matplotlib.animation.FuncAnimation</cite>) – The animation object to convert to HTML</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.imshow">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">imshow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indep1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_wrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#imshow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.imshow" title="Link to this definition"></a></dt>
<dd><p>Show image(s) correctly.</p>
<p>This function shows images correctly, making sure that each element in the
tensor corresponds to a pixel or an integer number of pixels, to avoid
aliasing (NOTE: this guarantee only holds for the saved image; it should
generally hold in notebooks as well, but will fail if, e.g., you plot an
image that’s 2000 pixels wide on an monitor 1000 pixels wide; the notebook
handles the rescaling in a way we can’t control).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>torch.Tensor</em><em> or </em><em>list</em>) – The images to display. Tensors should be 4d (batch, channel, height,
width). List of tensors should be used for tensors of different height
and width: all images will automatically be rescaled so they’re
displayed at the same height and width, thus, their heights and widths
must be scalar multiples of each other.</p></li>
<li><p><strong>vrange</strong> (<cite>tuple</cite> or <cite>str</cite>) – <p>If a 2-tuple, specifies the image values vmin/vmax that are mapped to
the minimum and maximum value of the colormap, respectively. If a
string:</p>
<ul>
<li><dl class="simple">
<dt><cite>’auto0’</cite>: all images have same vmin/vmax, which have the same absolute</dt><dd><p>value, and come from the minimum or maximum across all
images, whichever has the larger absolute value</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto/auto1’</cite>: all images have same vmin/vmax, which are the</dt><dd><p>minimum/maximum values across all images</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto2’</cite>: all images have same vmin/vmax, which are the mean (across</dt><dd><p>all images) minus/ plus 2 std dev (across all images)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto3’</cite>: all images have same vmin/vmax, chosen so as to map the</dt><dd><p>10th/90th percentile values to the 10th/90th percentile of
the display intensity range. For example: vmin is the 10th
percentile image value minus 1/8 times the difference
between the 90th and 10th percentile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep0’</cite>: each image has an independent vmin/vmax, which have the</dt><dd><p>same absolute value, which comes from either their
minimum or maximum value, whichever has the larger
absolute value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep1’</cite>: each image has an independent vmin/vmax, which are their</dt><dd><p>minimum/maximum values</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep2’</cite>: each image has an independent vmin/vmax, which is their</dt><dd><p>mean minus/plus 2 std dev</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep3’</cite>: each image has an independent vmin/vmax, chosen so that</dt><dd><p>the 10th/90th percentile values map to the 10th/90th
percentile intensities.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>zoom</strong> (<cite>float</cite> or <cite>None</cite>) – ratio of display pixels to image pixels. if &gt;1, must be an integer. If
&lt;1, must be 1/d where d is a a divisor of the size of the largest
image. If None, we try to determine the best zoom.</p></li>
<li><p><strong>title</strong> (<cite>str</cite>, <cite>list</cite>, or None, optional) – <p>Title for the plot. In addition to the specified title, we add a
subtitle giving the plotted range and dimensionality (with zoom)
* if <cite>str</cite>, will put the same title on every plot.
* if <cite>list</cite>, all values must be <cite>str</cite>, must be the same length as img,</p>
<blockquote>
<div><p>assigning each title to corresponding image.</p>
</div></blockquote>
<ul>
<li><p>if None, no title will be printed (and subtitle will be removed).</p></li>
</ul>
</p></li>
<li><p><strong>col_wrap</strong> (<cite>int</cite> or None, optional) – number of axes to have in each row. If None, will fit all axes in a
single row.</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.axis</cite> or None, optional) – if None, we make the appropriate figure. otherwise, we resize the axes
so that it’s the appropriate number of pixels (done by shrinking the
bbox - if the bbox is already too small, this will throw an Exception!,
so first define a large enough figure using either make_figure or
plt.figure)</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib colormap</em><em>, </em><em>optional</em>) – colormap to use when showing these images</p></li>
<li><p><strong>plot_complex</strong> (<em>{'rectangular'</em><em>, </em><em>'polar'</em><em>, </em><em>'logpolar'}</em>) – <p>specifies handling of complex values.</p>
<ul>
<li><p><cite>’rectangular’</cite>: plot real and imaginary components as separate images</p></li>
<li><p><cite>’polar’</cite>: plot amplitude and phase as separate images</p></li>
<li><p><cite>’logpolar’</cite>: plot log_2 amplitude and phase as separate images</p></li>
</ul>
<p>for any other value, we raise a warning and default to rectangular.</p>
</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Which element from the batch dimension to plot. If None, we plot all.</p></li>
<li><p><strong>channel_idx</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Which element from the channel dimension to plot. If None, we plot all.
Note if this is an int, then <cite>as_rgb=True</cite> will fail, because we
restrict the channels.</p></li>
<li><p><strong>as_rgb</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to consider the channels as encoding RGB(A) values. If True, we
attempt to plot the image in color, so your tensor must have 3 (or 4 if
you want the alpha channel) elements in the channel dimension, or this
will raise an Exception. If False, we plot each channel as a separate
grayscale image.</p></li>
<li><p><strong>kwargs</strong> – Passed to <cite>ax.imshow</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – figure containing the plotted images</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>PyrFigure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.plot_representation">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">plot_representation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_rgb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#plot_representation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.plot_representation" title="Link to this definition"></a></dt>
<dd><p>Helper function for plotting model representation</p>
<p>We are trying to plot <code class="docutils literal notranslate"><span class="pre">data</span></code> on <code class="docutils literal notranslate"><span class="pre">ax</span></code>, using
<code class="docutils literal notranslate"><span class="pre">model.plot_representation</span></code> method, if it has it, and otherwise
default to a function that makes sense based on the shape of <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<p>All of these arguments are optional, but at least some of them need
to be set:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, we fall-back to a type of plot based on the
shape of <code class="docutils literal notranslate"><span class="pre">data</span></code>. If it looks image-like, we’ll use <code class="docutils literal notranslate"><span class="pre">plenoptic.imshow</span></code>
and if it looks vector-like, we’ll use <code class="docutils literal notranslate"><span class="pre">plenoptic.clean_stem_plot</span></code>. If
it’s a dictionary, we’ll assume each key, value pair gives the title and
data to plot on a separate sub-plot.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">data</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, we can only do something if
<code class="docutils literal notranslate"><span class="pre">model.plot_representation</span></code> has some default behavior when
<code class="docutils literal notranslate"><span class="pre">data=None</span></code>; this is probably to plot its own <code class="docutils literal notranslate"><span class="pre">representation</span></code>
attribute. Thus, this will raise an Exception if both <code class="docutils literal notranslate"><span class="pre">model</span></code> and
<code class="docutils literal notranslate"><span class="pre">data</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code>, because we have no idea what to plot then.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">ax</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, we create a one-subplot figure using <code class="docutils literal notranslate"><span class="pre">figsize</span></code>.
If <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, we therefore ignore <code class="docutils literal notranslate"><span class="pre">figsize</span></code>.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">ylim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, we call <code class="docutils literal notranslate"><span class="pre">rescale_ylim</span></code>, which sets the axes’
y-limits to be <code class="docutils literal notranslate"><span class="pre">(-y_max,</span> <span class="pre">y_max)</span></code>, where <code class="docutils literal notranslate"><span class="pre">y_max=np.abs(data).max()</span></code>.
If it’s <code class="docutils literal notranslate"><span class="pre">False</span></code>, we do nothing.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<cite>torch.nn.Module</cite> or None, optional) – A differentiable model that tells us how to plot <code class="docutils literal notranslate"><span class="pre">data</span></code>. See
above for behavior if <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>data</strong> (<cite>array_like</cite>, <cite>dict</cite>, or <cite>None</cite>, optional) – The data to plot. See above for behavior if <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.pyplot.axis</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The axis to plot on. See above for behavior if <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>figsize</strong> (<cite>tuple</cite>, optional) – The size of the figure to create. Ignored if <code class="docutils literal notranslate"><span class="pre">ax</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>ylim</strong> (<cite>tuple</cite>, <cite>None</cite>, or <cite>False</cite>, optional) – If not None, the y-limits to use for this plot. See above for
behavior if <code class="docutils literal notranslate"><span class="pre">None</span></code>. If False, we do nothing.</p></li>
<li><p><strong>batch_idx</strong> (<cite>int</cite>, optional) – Which index to take from the batch dimension</p></li>
<li><p><strong>title</strong> (<cite>str</cite>, optional) – The title to put above this axis. If you want no title, pass
the empty string (<code class="docutils literal notranslate"><span class="pre">''</span></code>)</p></li>
<li><p><strong>as_rgb</strong> (<em>bool</em><em>, </em><em>optional</em>) – The representation can be image-like with multiple channels, and we
have no way to determine whether it should be represented as an RGB
image or not, so the user must set this flag to tell us. It will be
ignored if the representation doesn’t look image-like or if the
model has its own plot_representation_error() method. Else, it will
be passed to <cite>po.imshow()</cite>, see that methods docstring for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axes</strong> – List of created axes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.pyrshow">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">pyrshow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indep1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rectangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#pyrshow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.pyrshow" title="Link to this definition"></a></dt>
<dd><p>Display steerable pyramid coefficients in orderly fashion.</p>
<p>This function uses <code class="docutils literal notranslate"><span class="pre">imshow</span></code> to show the coefficients of the steeable
pyramid, such that each scale shows up on a single row, with each scale in
a given column.</p>
<p>Note that unlike imshow, we can only show one batch or channel at a time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_coeffs</strong> (<cite>dict</cite>) – pyramid coefficients in the standard dictionary format as returned by
<code class="docutils literal notranslate"><span class="pre">SteerablePyramidFreq.forward()</span></code></p></li>
<li><p><strong>vrange</strong> (<cite>tuple</cite> or <cite>str</cite>) – <p>If a 2-tuple, specifies the image values vmin/vmax that are mapped to
the minimum and maximum value of the colormap, respectively. If a
string:</p>
<ul>
<li><dl class="simple">
<dt><cite>’auto0’</cite>: all images have same vmin/vmax, which have the same absolute</dt><dd><p>value, and come from the minimum or maximum across all
images, whichever has the larger absolute value</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto/auto1’</cite>: all images have same vmin/vmax, which are the</dt><dd><p>minimum/maximum values across all images</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto2’</cite>: all images have same vmin/vmax, which are the mean (across</dt><dd><p>all images) minus/ plus 2 std dev (across all images)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’auto3’</cite>: all images have same vmin/vmax, chosen so as to map the</dt><dd><p>10th/90th percentile values to the 10th/90th percentile of
the display intensity range. For example: vmin is the 10th
percentile image value minus 1/8 times the difference
between the 90th and 10th percentile</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep0’</cite>: each image has an independent vmin/vmax, which have the</dt><dd><p>same absolute value, which comes from either their
minimum or maximum value, whichever has the larger
absolute value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep1’</cite>: each image has an independent vmin/vmax, which are their</dt><dd><p>minimum/maximum values</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep2’</cite>: each image has an independent vmin/vmax, which is their</dt><dd><p>mean minus/plus 2 std dev</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>’indep3’</cite>: each image has an independent vmin/vmax, chosen so that</dt><dd><p>the 10th/90th percentile values map to the 10th/90th
percentile intensities.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>zoom</strong> (<cite>float</cite>) – ratio of display pixels to image pixels. if &gt;1, must be an integer. If
&lt;1, must be 1/d where d is a a divisor of the size of the largest
image.</p></li>
<li><p><strong>show_residuals</strong> (<cite>bool</cite>) – whether to display the residual bands (lowpass, highpass depending on the pyramid type)</p></li>
<li><p><strong>cmap</strong> (<em>matplotlib colormap</em><em>, </em><em>optional</em>) – colormap to use when showing these images</p></li>
<li><p><strong>plot_complex</strong> (<em>{'rectangular'</em><em>, </em><em>'polar'</em><em>, </em><em>'logpolar'}</em>) – <p>specifies handling of complex values.</p>
<ul>
<li><p><cite>’rectangular’</cite>: plot real and imaginary components as separate images</p></li>
<li><p><cite>’polar’</cite>: plot amplitude and phase as separate images</p></li>
<li><p><cite>’logpolar’</cite>: plot log_2 amplitude and phase as separate images</p></li>
</ul>
<p>for any other value, we raise a warning and default to rectangular.</p>
</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em><em>, </em><em>optional</em>) – Which element from the batch dimension to plot.</p></li>
<li><p><strong>channel_idx</strong> (<em>int</em><em>, </em><em>optional</em>) – Which element from the channel dimension to plot.</p></li>
<li><p><strong>kwargs</strong> – Passed on to <code class="docutils literal notranslate"><span class="pre">pyrtools.pyrshow</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – the figure displaying the coefficients.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>PyrFigure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.rescale_ylim">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">rescale_ylim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#rescale_ylim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.rescale_ylim" title="Link to this definition"></a></dt>
<dd><p>rescale y-limits nicely</p>
<p>We take the axes and set their limits to be <code class="docutils literal notranslate"><span class="pre">(-y_max,</span> <span class="pre">y_max)</span></code>,
where <code class="docutils literal notranslate"><span class="pre">y_max=np.abs(data).max()</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<cite>list</cite>) – A list of matplotlib axes to rescale</p></li>
<li><p><strong>data</strong> (<em>array_like</em><em> or </em><em>dict</em>) – The data to use when rescaling (or a dictiontary of those
values)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.update_plot">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">update_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#update_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.update_plot" title="Link to this definition"></a></dt>
<dd><p>Update the information in some axes.</p>
<p>This is used for creating an animation over time. In order to create
the animation, we need to know how to update the matplotlib Artists,
and this provides a simple way of doing that. It assumes the plot
has been created by something like <code class="docutils literal notranslate"><span class="pre">plot_representation</span></code>, which
initializes all the artists.</p>
<p>We can update stem plots, lines (as returned by <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code>), scatter
plots, or images (RGB, RGBA, or grayscale).</p>
<p>There are two modes for this:</p>
<ul class="simple">
<li><p>single axis: axes is a single axis, which may contain multiple artists
(all of the same type) to update. data should be a Tensor with multiple
channels (one per artist in the same order) or be a dictionary whose keys
give the label(s) of the corresponding artist(s) and whose values are
Tensors.</p></li>
<li><p>multiple axes: axes is a list of axes, each of which contains a single
artist to update (artists can be different types). data should be a
Tensor with multiple channels (one per axis in the same order) or a
dictionary with the same number of keys as axes, which we can iterate
through in order, and whose values are Tensors.</p></li>
</ul>
<p>In all cases, data Tensors should be 3d (if the plot we’re updating is a
line or stem plot) or 4d (if it’s an image or scatter plot).</p>
<p>RGB(A) images are special, since we store that info along the channel
dimension, so they only work with single-axis mode (which will only have a
single artist, because that’s how imshow works).</p>
<p>If you have multiple axes, each with multiple artists you want to update,
that’s too complicated for us, and so you should write a
<code class="docutils literal notranslate"><span class="pre">model.update_plot()</span></code> function which handles that.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> is set, we try to call <code class="docutils literal notranslate"><span class="pre">model.update_plot()</span></code> (which
must also return artists). If model doesn’t have an <code class="docutils literal notranslate"><span class="pre">update_plot</span></code>
method, then we try to figure out how to update the axes ourselves,
based on the shape of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes</strong> (<cite>list</cite> or <cite>matplotlib.pyplot.axis</cite>) – The axis or list of axes to update. We assume that these are the axes
created by <code class="docutils literal notranslate"><span class="pre">plot_representation</span></code> and so contain stem plots in the
correct order.</p></li>
<li><p><strong>data</strong> (<cite>torch.Tensor</cite> or <cite>dict</cite>) – The new data to plot.</p></li>
<li><p><strong>model</strong> (<cite>torch.nn.Module</cite> or <cite>None</cite>, optional) – A differentiable model that tells us how to plot <code class="docutils literal notranslate"><span class="pre">data</span></code>. See
above for behavior if <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>batch_idx</strong> (<em>int</em><em>, </em><em>optional</em>) – Which index to take from the batch dimension</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>artists</strong> – A list of the artists used to update the information on the
plots</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.display.update_stem">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.display.</span></span><span class="sig-name descname"><span class="pre">update_stem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stem_container</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ydata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/display.html#update_stem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.display.update_stem" title="Link to this definition"></a></dt>
<dd><p>Update the information in a stem plot</p>
<p>We update the information in a single stem plot to match that given
by <code class="docutils literal notranslate"><span class="pre">ydata</span></code>. We update the position of the markers and and the
lines connecting them to the baseline, but we don’t change the
baseline at all and assume that the xdata shouldn’t change at all.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stem_container</strong> (<cite>matplotlib.container.StemContainer</cite>) – Single container for the artists created in a <code class="docutils literal notranslate"><span class="pre">plt.stem</span></code>
plot. It can be treated like a namedtuple <code class="docutils literal notranslate"><span class="pre">(markerline,</span>
<span class="pre">stemlines,</span> <span class="pre">baseline)</span></code>. In order to get this from an axis
<code class="docutils literal notranslate"><span class="pre">ax</span></code>, try <code class="docutils literal notranslate"><span class="pre">ax.containers[0]</span></code> (obviously if you have more
than one container in that axis, it may not be the first one).</p></li>
<li><p><strong>ydata</strong> (<em>array_like</em>) – The new y-data to show on the plot. Importantly, must be the
same length as the existing y-data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>stem_container</strong> – The StemContainer containing the updated artists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><cite>matplotlib.container.StemContainer</cite></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.external">
<span id="plenoptic-tools-external-module"></span><h2>plenoptic.tools.external module<a class="headerlink" href="#module-plenoptic.tools.external" title="Link to this heading"></a></h2>
<p>tools to deal with data from outside plenoptic</p>
<p>For example, pre-existing synthesized images</p>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.external.plot_MAD_results">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.external.</span></span><span class="sig-name descname"><span class="pre">plot_MAD_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'~/Documents/MAD_Competition/data/results'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zoom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indep1'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/external.html#plot_MAD_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.external.plot_MAD_results" title="Link to this definition"></a></dt>
<dd><p>plot original MAD results, provided by Zhou Wang</p>
<p>Plot the results of original MAD Competition, as provided in .mat
files. The figure created shows the results for one reference image
and multiple noise levels. The reference image is plotted on the
first row, followed by a separate row for each noise level, which
will show the initial (noisy) image and the four synthesized images,
with their respective losses for the two metrics (MSE and SSIM).</p>
<p>We also return a DataFrame that contains the losses, noise levels,
and original image name for each plotted noise level.</p>
<p>This code can probably be adapted to other uses, but requires that
all images are the same size and assumes they’re all 64 x 64 pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_image</strong> (<em>{samp1</em><em>, </em><em>samp2</em><em>, </em><em>samp3</em><em>, </em><em>samp4</em><em>, </em><em>samp5</em><em>, </em><em>samp6</em><em>, </em><em>samp7</em><em>,</em>) – samp8, samp9, samp10}
which of the sample images to plot</p></li>
<li><p><strong>noise_levels</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – which noise levels to plot. if None, will plot all. If a list,
elements must be 2**i where i is in [1, 10]</p></li>
<li><p><strong>results_dir</strong> (<em>str</em><em>, </em><em>optional</em>) – path to the results directory containing the results.mat files</p></li>
<li><p><strong>zoom</strong> (<em>int</em><em>, </em><em>optional</em>) – amount to zoom each image, passed to pyrtools.imshow</p></li>
<li><p><strong>vrange</strong> (<em>str</em><em>, </em><em>optional</em>) – in addition to the values accepted by pyrtools.imshow, we also
accept ‘row0/1/2/3’, which is the same as ‘auto0/1/2/3’, except
that we do it on a per-row basis (all images with same noise
level)</p></li>
<li><p><strong>kwargs</strong> – passed to pyrtools.imshow. Note that we call imshow separately
on each image and so any argument that relies on imshow having
access to all images will probably not work as expected</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>pyrtools.tools.display.Figure</em>) – figure containing the images</p></li>
<li><p><strong>results</strong> (<em>dict</em>) – dictionary containing the errors for each noise level. To
convert to a well-structured pandas DataFrame, run
<code class="docutils literal notranslate"><span class="pre">pd.DataFrame(results).T</span></code></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.optim">
<span id="plenoptic-tools-optim-module"></span><h2>plenoptic.tools.optim module<a class="headerlink" href="#module-plenoptic.tools.optim" title="Link to this heading"></a></h2>
<p>Tools related to optimization such as more objective functions.</p>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.optim.l2_norm">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.optim.</span></span><span class="sig-name descname"><span class="pre">l2_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synth_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_rep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/optim.html#l2_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.optim.l2_norm" title="Link to this definition"></a></dt>
<dd><p>l2-norm of the difference between ref_rep and synth_rep</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>synth_rep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The first tensor to compare, model representation of the
synthesized image.</p></li>
<li><p><strong>ref_rep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The second tensor to compare, model representation of the
reference image. must be same size as <code class="docutils literal notranslate"><span class="pre">synth_rep</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Ignored, only present to absorb extra arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The L2-norm of the difference between <code class="docutils literal notranslate"><span class="pre">ref_rep</span></code> and <code class="docutils literal notranslate"><span class="pre">synth_rep</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.optim.mse">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.optim.</span></span><span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synth_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_rep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/optim.html#mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.optim.mse" title="Link to this definition"></a></dt>
<dd><p>return the MSE between synth_rep and ref_rep</p>
<p>For two tensors, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, with <span class="math notranslate nohighlight">\(n\)</span> values
each:</p>
<div class="math notranslate nohighlight">
\[MSE &amp;= \frac{1}{n}\sum_i=1^n (x_i - y_i)^2\]</div>
<p>The two images must have a float dtype</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>synth_rep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The first tensor to compare, model representation of the
synthesized image</p></li>
<li><p><strong>ref_rep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The second tensor to compare, model representation of the
reference image. must be same size as <code class="docutils literal notranslate"><span class="pre">synth_rep</span></code>,</p></li>
<li><p><strong>kwargs</strong> – Ignored, only present to absorb extra arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean-squared error between <code class="docutils literal notranslate"><span class="pre">synth_rep</span></code> and <code class="docutils literal notranslate"><span class="pre">ref_rep</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.optim.penalize_range">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.optim.</span></span><span class="sig-name descname"><span class="pre">penalize_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synth_img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/optim.html#penalize_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.optim.penalize_range" title="Link to this definition"></a></dt>
<dd><p>penalize values outside of allowed_range</p>
<p>instead of clamping values to exactly fall in a range, this provides
a ‘softer’ way of doing it, by imposing a quadratic penalty on any
values outside the allowed_range. All values within the
allowed_range have a penalty of 0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>synth_img</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The tensor to penalize. the synthesized image.</p></li>
<li><p><strong>allowed_range</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</span>) – 2-tuple of values giving the (min, max) allowed values</p></li>
<li><p><strong>kwargs</strong> – Ignored, only present to absorb extra arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Penalty for values outside range</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>penalty</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.optim.relative_MSE">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.optim.</span></span><span class="sig-name descname"><span class="pre">relative_MSE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synth_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_rep</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/optim.html#relative_MSE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.optim.relative_MSE" title="Link to this definition"></a></dt>
<dd><p>Squared l2-norm of the difference between reference representation
and synthesized representation relative to the squared l2-norm of the
reference representation:</p>
<p>$$frac{||x - hat{x}||_2^2}{||x||_2^2}$$</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>synth_rep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The first tensor to compare, model representation of the
synthesized image.</p></li>
<li><p><strong>ref_rep</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The second tensor to compare, model representation of the
reference image. must be same size as <code class="docutils literal notranslate"><span class="pre">synth_rep</span></code>.</p></li>
<li><p><strong>kwargs</strong> – Ignored, only present to absorb extra arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ratio of the squared l2-norm of the difference between <code class="docutils literal notranslate"><span class="pre">ref_rep</span></code> and
<code class="docutils literal notranslate"><span class="pre">synth_rep</span></code> to the squared l2-norm of <code class="docutils literal notranslate"><span class="pre">ref_rep</span></code></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.optim.set_seed">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.optim.</span></span><span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/optim.html#set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.optim.set_seed" title="Link to this definition"></a></dt>
<dd><p>Set the seed.</p>
<p>We call both <code class="docutils literal notranslate"><span class="pre">torch.manual_seed()</span></code> and <code class="docutils literal notranslate"><span class="pre">np.random.seed()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) – The seed to set. If None, do nothing.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.signal">
<span id="plenoptic-tools-signal-module"></span><h2>plenoptic.tools.signal module<a class="headerlink" href="#module-plenoptic.tools.signal" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.add_noise">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_mse</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#add_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.add_noise" title="Link to this definition"></a></dt>
<dd><p>Add normally distributed noise to an image</p>
<p>This adds normally-distributed noise to an image so that the resulting
noisy version has the specified mean-squared error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The image to make noisy.</p></li>
<li><p><strong>noise_mse</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</span>) – The target MSE value / variance of the noise. More than one value is
allowed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The noisy image. If <cite>noise_mse</cite> contains only one element, this will be
the same size as <cite>img</cite>. Else, each separate value from <cite>noise_mse</cite> will
be along the batch dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>noisy_img</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.autocorr">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">autocorr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#autocorr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.autocorr" title="Link to this definition"></a></dt>
<dd><p>Compute the autocorrelation of <cite>x</cite> up to <cite>n_shifts</cite> shifts,
the calculation is performed in the frequency domain.
:type x: <span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>
:param x: Input signal of shape [b, c, h, w]
:type n_shifts: <span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>
:param n_shifts: Sets the length scale of the auto-correlation (ie. maximum offset or lag).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Computed autocorrelation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>autocorr</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>By the Einstein-Wiener-Khinchin theorem: The autocorrelation of a wide
sense stationary (WSS) process is the inverse Fourier transform of its
energy spectrum (ESD) - which itself is the multiplication between
FT(x(t)) and FT(x(-t)). In other words, the auto-correlation is
convolution of the signal <cite>x</cite> with itself, which corresponds to squaring
in the frequency domain. This approach is computationally more efficient
than brute force (n log(n) vs n^2).</p></li>
<li><p>By Cauchy-Swartz, the autocorrelation attains it is maximum at the center
location (ie. no shift) - that maximum value is the signal’s variance
(assuming that the input signal is mean centered).</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.interpolate1d">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">interpolate1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_new</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#interpolate1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.interpolate1d" title="Link to this definition"></a></dt>
<dd><p>One-dimensional linear interpolation.</p>
<p>Returns the one-dimensional piecewise linear interpolant to a
function with given discrete data points (X, Y), evaluated at x_new.</p>
<p>Note: this function is just a wrapper around <code class="docutils literal notranslate"><span class="pre">np.interp()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_new</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The x-coordinates at which to evaluate the interpolated values.</p></li>
<li><p><strong>Y</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – The y-coordinates of the data points.</p></li>
<li><p><strong>X</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) – The x-coordinates of the data points, same length as X.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated values of shape identical to <cite>x_new</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.make_disk">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">make_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#make_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.make_disk" title="Link to this definition"></a></dt>
<dd><p>Create a circular mask with softened edges to  an image.</p>
<p>All values within <code class="docutils literal notranslate"><span class="pre">inner_radius</span></code> will be 1, and all values from <code class="docutils literal notranslate"><span class="pre">inner_radius</span></code>
to <code class="docutils literal notranslate"><span class="pre">outer_radius</span></code> will decay smoothly to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Size</span></code>]</span>) – Size of image in pixels.</p></li>
<li><p><strong>outer_radius</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</span>) – Total radius of disk. Values from <code class="docutils literal notranslate"><span class="pre">inner_radius</span></code> to <code class="docutils literal notranslate"><span class="pre">outer_radius</span></code>
will decay smoothly to zero.</p></li>
<li><p><strong>inner_radius</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</span>) – Radius of inner disk. All elements from the origin to <code class="docutils literal notranslate"><span class="pre">inner_radius</span></code>
will be set to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor mask with torch.Size(img_size).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>mask</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.maximum">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">maximum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#maximum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.maximum" title="Link to this definition"></a></dt>
<dd><p>Compute maximum in torch over any dim or combination of axes in tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Input tensor</p></li>
<li><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – Dimensions over which you would like to compute the minimum</p></li>
<li><p><strong>keepdim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Keep original dimensions of tensor when returning result</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Maximum value of x.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>max_x</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.minimum">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">minimum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#minimum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.minimum" title="Link to this definition"></a></dt>
<dd><p>Compute minimum in torch over any axis or combination of axes in tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Input tensor.</p></li>
<li><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – Dimensions over which you would like to compute the minimum.</p></li>
<li><p><strong>keepdim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Keep original dimensions of tensor when returning result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum value of x.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>min_x</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.polar_to_rectangular">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">polar_to_rectangular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#polar_to_rectangular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.polar_to_rectangular" title="Link to this definition"></a></dt>
<dd><p>Polar to rectangular coordinate transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitude</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Tensor containing the amplitude (aka. complex modulus). Must be &gt; 0.</p></li>
<li><p><strong>phase</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Tensor containing the phase</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Complex tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.raised_cosine">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">raised_cosine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#raised_cosine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.raised_cosine" title="Link to this definition"></a></dt>
<dd><p>Return a lookup table containing a “raised cosine” soft threshold function.</p>
<dl>
<dt>Y =  VALUES(1)</dt><dd><ul class="simple">
<li><p>(VALUES(2)-VALUES(1))</p></li>
</ul>
<ul class="simple">
<li><p>cos^2( PI/2 * (X - POSITION + WIDTH)/WIDTH )</p></li>
</ul>
</dd>
</dl>
<p>This lookup table is suitable for use by <cite>interpolate1d</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – The width of the region over which the transition occurs.</p></li>
<li><p><strong>position</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – The location of the center of the threshold.</p></li>
<li><p><strong>values</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</span>) – 2-tuple specifying the values to the left and right of the transition.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>X</em> – The x values of this raised cosine.</p></li>
<li><p><em>Y</em> – The y values of this raised cosine.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.rectangular_to_polar">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">rectangular_to_polar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#rectangular_to_polar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.rectangular_to_polar" title="Link to this definition"></a></dt>
<dd><p>Rectangular to polar coordinate transform</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Complex tensor.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>amplitude</em> – Tensor containing the amplitude (aka. complex modulus).</p></li>
<li><p><em>phase</em> – Tensor containing the phase.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.rescale">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">rescale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#rescale"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.rescale" title="Link to this definition"></a></dt>
<dd><p>Linearly rescale the dynamic range of the input x to [a,b].</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.signal.steer">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.signal.</span></span><span class="sig-name descname"><span class="pre">steer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">harmonics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steermtx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/signal.html#steer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.signal.steer" title="Link to this definition"></a></dt>
<dd><p>Steer BASIS to the specfied ANGLE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Array whose columns are vectorized rotated copies of a steerable
function, or the responses of a set of steerable filters.</p></li>
<li><p><strong>angle</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) – Scalar or column vector the size of the basis. specifies the angle(s)
(in radians) to steer to</p></li>
<li><p><strong>harmonics</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – A list of harmonic numbers indicating the angular harmonic content of
the basis. if None (default), N even or odd low frequencies, as for
derivative filters</p></li>
<li><p><strong>steermtx</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – Matrix which maps the filters onto Fourier series components (ordered
[cos0 cos1 sin1 cos2 sin2 … sinN]). See steer_to_harmonics_mtx
function for more details. If None (default), assumes cosine phase
harmonic components, and filter positions at 2pi*n/N.</p></li>
<li><p><strong>return_weights</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether to return the weights or not.</p></li>
<li><p><strong>even_phase</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Specifies whether the harmonics are cosine or sine phase aligned about
those positions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>res</em> – The resteered basis.</p></li>
<li><p><em>steervect</em> – The weights used to resteer the basis. only returned if
<code class="docutils literal notranslate"><span class="pre">return_weights</span></code> is True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.stats">
<span id="plenoptic-tools-stats-module"></span><h2>plenoptic.tools.stats module<a class="headerlink" href="#module-plenoptic.tools.stats" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.stats.kurtosis">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.stats.</span></span><span class="sig-name descname"><span class="pre">kurtosis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/stats.html#kurtosis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.stats.kurtosis" title="Link to this definition"></a></dt>
<dd><p>sample estimate of <cite>x</cite> <em>tailedness</em> (presence of outliers)</p>
<p>kurtosis of univariate noral is 3.</p>
<p>smaller than 3: <em>platykurtic</em> (eg. uniform distribution)</p>
<p>greater than 3: <em>leptokurtic</em> (eg. Laplace distribution)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The input tensor.</p></li>
<li><p><strong>mean</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span>) – Reuse a precomputed mean.</p></li>
<li><p><strong>var</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span>) – Reuse a precomputed variance.</p></li>
<li><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – The dimension or dimensions to reduce.</p></li>
<li><p><strong>keepdim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether the output tensor has dim retained or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The kurtosis tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.stats.skew">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.stats.</span></span><span class="sig-name descname"><span class="pre">skew</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/stats.html#skew"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.stats.skew" title="Link to this definition"></a></dt>
<dd><p>Sample estimate of <cite>x</cite> <em>asymmetry</em> about its mean</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The input tensor</p></li>
<li><p><strong>mean</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span>) – Reuse a precomputed mean</p></li>
<li><p><strong>var</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span>) – Reuse a precomputed variance</p></li>
<li><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – The dimension or dimensions to reduce.</p></li>
<li><p><strong>keepdim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether the output tensor has dim retained or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The skewness tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.stats.variance">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.stats.</span></span><span class="sig-name descname"><span class="pre">variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/stats.html#variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.stats.variance" title="Link to this definition"></a></dt>
<dd><p>sample estimate of <cite>x</cite> <em>variability</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The input tensor</p></li>
<li><p><strong>mean</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span>) – Reuse a precomputed mean</p></li>
<li><p><strong>dim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span>) – The dimension or dimensions to reduce.</p></li>
<li><p><strong>keepdim</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether the output tensor has dim retained or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The variance tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>out</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.straightness">
<span id="plenoptic-tools-straightness-module"></span><h2>plenoptic.tools.straightness module<a class="headerlink" href="#module-plenoptic.tools.straightness" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.straightness.deviation_from_line">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.straightness.</span></span><span class="sig-name descname"><span class="pre">deviation_from_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/straightness.html#deviation_from_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.straightness.deviation_from_line" title="Link to this definition"></a></dt>
<dd><p>Compute the deviation of <cite>sequence</cite> to the straight line between its endpoints.</p>
<p>Project each point of the path <cite>sequence</cite> onto the line defined by
the anchor points, and measure the two sides of a right triangle:
- from the projected point to the first anchor point</p>
<blockquote>
<div><p>(aka. distance along line)</p>
</div></blockquote>
<ul class="simple">
<li><p>from the projected point to the corresponding point on the path <cite>sequence</cite>
(aka. distance from line).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – sequence of signals of shape [T, C, H, W]</p></li>
<li><p><strong>normalize</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – use the distance between the anchor points as a unit of measurement</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>dist_along_line</em> – sequence of T euclidian distances along the line</p></li>
<li><p><em>dist_from_line</em> – sequence of T euclidian distances to the line</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.straightness.make_straight_line">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.straightness.</span></span><span class="sig-name descname"><span class="pre">make_straight_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/straightness.html#make_straight_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.straightness.make_straight_line" title="Link to this definition"></a></dt>
<dd><p>make a straight line between <cite>start</cite> and <cite>stop</cite> with <cite>n_steps</cite> transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Images of shape [1, C, H, W], the anchor points between which a line
will be made.</p></li>
<li><p><strong>stop</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Images of shape [1, C, H, W], the anchor points between which a line
will be made.</p></li>
<li><p><strong>n_steps</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Number of steps (i.e., transitions) to create between the two anchor
points. Must be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor of shape [n_steps+1, C, H, W]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>straight</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.straightness.sample_brownian_bridge">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.straightness.</span></span><span class="sig-name descname"><span class="pre">sample_brownian_bridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/straightness.html#sample_brownian_bridge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.straightness.sample_brownian_bridge" title="Link to this definition"></a></dt>
<dd><p>Sample a brownian bridge between <cite>start</cite> and <cite>stop</cite> made up of <cite>n_steps</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – signal of shape [1, C, H, W], the anchor points between which
a random path will be sampled (like pylons on which
the bridge will rest)</p></li>
<li><p><strong>stop</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – signal of shape [1, C, H, W], the anchor points between which
a random path will be sampled (like pylons on which
the bridge will rest)</p></li>
<li><p><strong>n_steps</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – number of steps on the bridge</p></li>
<li><p><strong>max_norm</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – controls variability of the bridge by setting how far (in l2 norm)
it veers from the straight line interpolation at the midpoint between
pylons. each component of the bridge will reach a maximal variability
with std = max_norm / sqrt(d), where d is the dimension of the signal.
(ie. d = C*H*W). Must be non-negative.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>sequence of shape [n_steps+1, C, H, W] a brownian bridge across the two
pylons</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bridge</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.straightness.translation_sequence">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.straightness.</span></span><span class="sig-name descname"><span class="pre">translation_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/straightness.html#translation_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.straightness.translation_sequence" title="Link to this definition"></a></dt>
<dd><p>make a horizontal translation sequence on <cite>image</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – Base image of shape, [1, C, H, W]</p></li>
<li><p><strong>n_steps</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Number of steps in the sequence. The length of the sequence is n_steps
+ 1. Must be positive.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>translation sequence of shape [n_steps+1, C, H, W]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sequence</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plenoptic.tools.validate">
<span id="plenoptic-tools-validate-module"></span><h2>plenoptic.tools.validate module<a class="headerlink" href="#module-plenoptic.tools.validate" title="Link to this heading"></a></h2>
<p>Functions to validate synthesis inputs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.validate.remove_grad">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.validate.</span></span><span class="sig-name descname"><span class="pre">remove_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/validate.html#remove_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.validate.remove_grad" title="Link to this definition"></a></dt>
<dd><p>Detach all parameters of model (in place).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.validate.validate_coarse_to_fine">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.validate.</span></span><span class="sig-name descname"><span class="pre">validate_coarse_to_fine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/validate.html#validate_coarse_to_fine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.validate.validate_coarse_to_fine" title="Link to this definition"></a></dt>
<dd><p>Determine whether a model can be used for coarse-to-fine synthesis.</p>
<p>In particular, this function checks the following (with associated errors):</p>
<ul class="simple">
<li><p>Whether <code class="docutils literal notranslate"><span class="pre">model</span></code> has a <code class="docutils literal notranslate"><span class="pre">scales</span></code> attribute (<code class="docutils literal notranslate"><span class="pre">AttributeError</span></code>).</p></li>
<li><p>Whether <code class="docutils literal notranslate"><span class="pre">model.forward</span></code> accepts a <code class="docutils literal notranslate"><span class="pre">scales</span></code> keyword argument (<code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p></li>
<li><p>Whether the output of <code class="docutils literal notranslate"><span class="pre">model.forward</span></code> changes shape when the <code class="docutils literal notranslate"><span class="pre">scales</span></code>
keyword argument is set (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></span>) – The model to validate.</p></li>
<li><p><strong>image_shape</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – Some models (e.g., the steerable pyramid) can only accept inputs of a
certain shape. If that’s the case for <code class="docutils literal notranslate"><span class="pre">model</span></code>, use this to
specify the expected shape. If None, we use an image of shape
(1,1,16,16)</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>]</span>) – Which device to place the test image on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.validate.validate_input">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.validate.</span></span><span class="sig-name descname"><span class="pre">validate_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/validate.html#validate_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.validate.validate_input" title="Link to this definition"></a></dt>
<dd><p>Determine whether input_tensor tensor can be used for synthesis.</p>
<p>In particular, this function:</p>
<ul class="simple">
<li><p>Checks if input_tensor has a float or complex dtype</p></li>
<li><p>Checks if input_tensor is 4d.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">no_batch</span></code> is True, check whether <code class="docutils literal notranslate"><span class="pre">input_tensor.shape[0]</span> <span class="pre">!=</span> <span class="pre">1</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">allowed_range</span></code> is not None, check whether all values of <code class="docutils literal notranslate"><span class="pre">input_tensor</span></code> lie
within the specified range.</p></li>
</ul>
<p>If any of the above fail, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensor</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></span>) – The tensor to validate.</p></li>
<li><p><strong>no_batch</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If True, raise a ValueError if the batch dimension of <code class="docutils literal notranslate"><span class="pre">input_tensor</span></code> is greater
than 1.</p></li>
<li><p><strong>allowed_range</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]</span>) – If not None, ensure that all values of <code class="docutils literal notranslate"><span class="pre">input_tensor</span></code> lie within allowed_range.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.validate.validate_metric">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.validate.</span></span><span class="sig-name descname"><span class="pre">validate_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/validate.html#validate_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.validate.validate_metric" title="Link to this definition"></a></dt>
<dd><p>Determines whether a metric can be used for MADCompetition synthesis.</p>
<p>In particular, this functions checks the following (with associated
exceptions):</p>
<ul class="simple">
<li><p>Whether <code class="docutils literal notranslate"><span class="pre">metric</span></code> is callable and accepts two 4d tensors as input
(<code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p></li>
<li><p>Whether <code class="docutils literal notranslate"><span class="pre">metric</span></code> returns a scalar when called with two 4d tensors as
input (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>).</p></li>
<li><p>Whether <code class="docutils literal notranslate"><span class="pre">metric</span></code> returns a value less than 5e-7 when with two identical
4d tensors as input (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>). (This threshold was chosen because
1-SSIM of two identical images is 5e-8 on GPU).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>]]</span>) – The metric to validate.</p></li>
<li><p><strong>image_shape</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – Some models (e.g., the steerable pyramid) can only accept inputs of a
certain shape. If that’s the case for <code class="docutils literal notranslate"><span class="pre">model</span></code>, use this to
specify the expected shape. If None, we use an image of shape
(1,1,16,16)</p></li>
<li><p><strong>image_dtype</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></span>) – What dtype to validate against.</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>]</span>) – What device to place the test images on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.tools.validate.validate_model">
<span class="sig-prename descclassname"><span class="pre">plenoptic.tools.validate.</span></span><span class="sig-name descname"><span class="pre">validate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/tools/validate.html#validate_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.tools.validate.validate_model" title="Link to this definition"></a></dt>
<dd><p>Determine whether model can be used for sythesis.</p>
<p>In particular, this function checks the following (with their associated
errors raised):</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> adds a gradient to an input tensor, which implies that some of
it is learnable (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> returns a tensor when given a tensor, failure implies that not
all computations are done using torch (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> strips gradient from an input with gradient attached
(<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> casts an input tensor to something else and returns it to a
tensor before returning it (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> changes the precision of the input tensor (<code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> returns a 3d or 4d output when given a 4d input
(<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">model</span></code> changes the device of the input (<code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>).</p></li>
</ul>
<p>Finally, we check if <code class="docutils literal notranslate"><span class="pre">model</span></code> is in training mode and raise a warning if so.
Note that this is different from having learnable parameters, see <a href="#id1"><span class="problematic" id="id2">``</span></a>pytorch
docs
&lt;<a class="reference external" href="https://pytorch.org/docs/stable/notes/autograd.html#locally-disable-grad-doc">https://pytorch.org/docs/stable/notes/autograd.html#locally-disable-grad-doc</a>&gt;``_</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></span>) – The model to validate.</p></li>
<li><p><strong>image_shape</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – Some models (e.g., the steerable pyramid) can only accept inputs of a
certain shape. If that’s the case for <code class="docutils literal notranslate"><span class="pre">model</span></code>, use this to
specify the expected shape. If None, we use an image of shape
(1,1,16,16)</p></li>
<li><p><strong>image_dtype</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dtype</span></code></span>) – What dtype to validate against.</p></li>
<li><p><strong>device</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">device</span></code>]</span>) – What device to place test image on.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.tools.validate.remove_grad" title="plenoptic.tools.validate.remove_grad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_grad</span></code></a></dt><dd><p>Helper function for detaching all parameters (in place).</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="module-plenoptic.tools">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-plenoptic.tools" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plenoptic.synthesize.html" class="btn btn-neutral float-left" title="plenoptic.synthesize package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tutorials/advanced/Display.html" class="btn btn-neutral float-right" title="Display and animate functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Plenoptic authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>