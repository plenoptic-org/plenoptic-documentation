

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plenoptic.simulate.canonical_computations package &mdash; plenoptic 1.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=1f29e9d3"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=35a8b989"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="plenoptic.simulate.models package" href="plenoptic.simulate.models.html" />
    <link rel="prev" title="plenoptic.simulate package" href="plenoptic.simulate.html" /> 
</head>

<body class="wy-body-for-nav">

<div style="background-color: rgb(248, 215, 218); color: rgb(114, 28, 36); text-align: center;">
  <div>
    <div>This is documentation for <strong>an old version</strong>.
      <a href="https://docs.plenoptic.org/" style="background-color: rgb(220, 53, 69); color: rgb(255, 255, 255); margin: 1rem; padding: 0.375rem 0.75rem; border-radius: 4px; display: inline-block; text-align: center;">Switch to stable version</a>
    </div>
  </div>
</div>
 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            plenoptic
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basic concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter.html">Using Jupyter to Run Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conceptual_intro.html">Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Model requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/00_quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citation Guide and Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method introductions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/02_Eigendistortions.html">Eigendistortions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/06_Metamer.html">Metamers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/07_Simple_MAD.html">MAD Competition Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/08_MAD_Competition.html">MAD Competition Usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models and metrics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/03_Steerable_Pyramid.html">Steerable Pyramid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/04_Perceptual_distance.html">Perceptual distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/Metamer-Portilla-Simoncelli.html">Portilla-Simoncelli Texture Metamer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/09_Original_MAD.html">Reproducing Wang and Simoncelli, 2008 (MAD Competition)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/Demo_Eigendistortion.html">Reproducing Berardino et al., 2017 (Eigendistortions)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../synthesis.html">Synthesis object design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tips.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reproducibility.html">Reproducibility</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="plenoptic.html">plenoptic package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="plenoptic.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="plenoptic.data.html">plenoptic.data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="plenoptic.metric.html">plenoptic.metric package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="plenoptic.simulate.html">plenoptic.simulate package</a></li>
<li class="toctree-l4"><a class="reference internal" href="plenoptic.synthesize.html">plenoptic.synthesize package</a></li>
<li class="toctree-l4"><a class="reference internal" href="plenoptic.tools.html">plenoptic.tools package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plenoptic.html#module-plenoptic">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Display.html">Display and animate functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Synthesis_extensions.html">Extending existing synthesis objects</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">plenoptic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">plenoptic</a></li>
          <li class="breadcrumb-item"><a href="plenoptic.html">plenoptic package</a></li>
          <li class="breadcrumb-item"><a href="plenoptic.simulate.html">plenoptic.simulate package</a></li>
      <li class="breadcrumb-item active">plenoptic.simulate.canonical_computations package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/plenoptic.simulate.canonical_computations.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plenoptic-simulate-canonical-computations-package">
<h1>plenoptic.simulate.canonical_computations package<a class="headerlink" href="#plenoptic-simulate-canonical-computations-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-plenoptic.simulate.canonical_computations.filters">
<span id="plenoptic-simulate-canonical-computations-filters-module"></span><h2>plenoptic.simulate.canonical_computations.filters module<a class="headerlink" href="#module-plenoptic.simulate.canonical_computations.filters" title="Link to this heading"></a></h2>
<p>Simple filters for visual models.</p>
<p>The functions in this module only create tensors, they do not perform convolution.</p>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.filters.circular_gaussian2d">
<span class="sig-name descname"><span class="pre">circular_gaussian2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/filters.html#circular_gaussian2d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.filters.circular_gaussian2d" title="Link to this definition"></a></dt>
<dd><p>Create normalized, centered circular 2D gaussian tensor with which to convolve.</p>
<p>The filter is normalized by total pixel-sum (<em>not</em> by <code class="docutils literal notranslate"><span class="pre">2*pi*std</span></code>) and has shape
<code class="docutils literal notranslate"><span class="pre">(out_channels,</span> <span class="pre">1,</span> <span class="pre">height,</span> <span class="pre">width)</span></code>. For 2d convolutions in torch, the first
dimensions of the filter tensor corresponds to <code class="docutils literal notranslate"><span class="pre">out_channels</span></code> and the second to
<code class="docutils literal notranslate"><span class="pre">in_channels</span></code>, see <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Conv2d.html#torch.nn.Conv2d" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Conv2d</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) – Filter kernel size. Recommended to be odd so that kernel is properly centered.
If you use same-padding, convolution with an odd-length kernel will be faster,
see <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.functional.conv2d.html#torch.nn.functional.conv2d" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.functional.conv2d()</span></code></a>.</p></li>
<li><p><strong>std</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>] | <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>] | <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Standard deviation of 2D circular Gaussian. If a scalar and <code class="docutils literal notranslate"><span class="pre">out_channels</span></code> is
not <code class="docutils literal notranslate"><span class="pre">None</span></code>, all out channels will have the same value. If not a scalar and
<code class="docutils literal notranslate"><span class="pre">out_channels</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">len(std)</span></code> must equal <code class="docutils literal notranslate"><span class="pre">out_channels</span></code>.</p></li>
<li><p><strong>out_channels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – Number of output channels. If None, inferred from shape of <code class="docutils literal notranslate"><span class="pre">std</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>filt</em> – Circular gaussian kernel.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError:</strong> – If out_channels is not a positive integer.</p></li>
<li><p><strong>ValueError:</strong> – If kernel_size is not one or two positive integers.</p></li>
<li><p><strong>ValueError:</strong> – If std is not positive.</p></li>
<li><p><strong>ValueError:</strong> – If std is non-scalar and <code class="docutils literal notranslate"><span class="pre">len(std)</span> <span class="pre">!=</span> <span class="pre">out_channels</span></code></p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plenoptic.simulate.models.html#plenoptic.simulate.models.naive.Gaussian" title="plenoptic.simulate.models.naive.Gaussian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian</span></code></a></dt><dd><p>Torch Module to perform this convolution.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Single output channel.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">plenoptic.simulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">circular_gaussian2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">conv2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt_2d</span> <span class="o">=</span> <span class="n">circular_gaussian2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt_2d</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 1, 32, 32])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">einstein_img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_einstein</span> <span class="o">=</span> <span class="n">conv2d</span><span class="p">(</span><span class="n">einstein_img</span><span class="p">,</span> <span class="n">filt_2d</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">einstein_img</span><span class="p">,</span> <span class="n">filt_2d</span><span class="p">,</span> <span class="n">blurred_einstein</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Einstein&quot;</span><span class="p">,</span> <span class="s2">&quot;2D Gaussian Filter&quot;</span><span class="p">,</span> <span class="s2">&quot;Blurred Einstein&quot;</span><span class="p">],</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/89770886052c86939dda8465a9492ed7/plenoptic-simulate-canonical_computations-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/d25a020b38237e678ed03e4d87b8e117/plenoptic-simulate-canonical_computations-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/edc0ab91eb1065bc68840751da0618f7/plenoptic-simulate-canonical_computations-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-1.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-1.png" />
</figure>
<p>Multiple output channels with different standard deviations.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">plenoptic.simulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">circular_gaussian2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">conv2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt_2d</span> <span class="o">=</span> <span class="n">circular_gaussian2d</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">],</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt_2d</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([2, 1, 32, 32])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">einstein_img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_einstein</span> <span class="o">=</span> <span class="n">conv2d</span><span class="p">(</span><span class="n">einstein_img</span><span class="p">,</span> <span class="n">filt_2d</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">titles</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="s2">&quot;Einstein&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;2D Gaussian Filter&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;Larger 2D Gaussian Filter&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;Blurred Einstein&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;Blurrier Einstein&quot;</span><span class="p">,</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">einstein_img</span><span class="p">,</span> <span class="n">filt_2d</span><span class="p">,</span> <span class="n">blurred_einstein</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/c3b36d18186d35c209e03b05089ee8d4/plenoptic-simulate-canonical_computations-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/fd8ca01eeaa9053cafe8eb1aeca10498/plenoptic-simulate-canonical_computations-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/82248334b6fb1ec98b52abaca919e1e6/plenoptic-simulate-canonical_computations-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-2.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-2.png" />
</figure>
<p>Multiple input and output channels, convolved independently. See
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.functional.conv2d.html#torch.nn.functional.conv2d" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.functional.conv2d()</span></code></a> to understand the behavior below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">plenoptic.simulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">circular_gaussian2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">conv2d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt_2d</span> <span class="o">=</span> <span class="n">circular_gaussian2d</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">],</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">... </span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt_2d</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 1, 32, 32])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wheel</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">color_wheel</span><span class="p">(</span><span class="n">as_gray</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blurred_wheel</span> <span class="o">=</span> <span class="n">conv2d</span><span class="p">(</span><span class="n">wheel</span><span class="p">,</span> <span class="n">filt_2d</span><span class="p">,</span> <span class="n">groups</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Wheel&quot;</span><span class="p">,</span> <span class="s2">&quot;Blurred Wheel&quot;</span><span class="p">,</span> <span class="s2">&quot;Blurrier Wheel&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># note that the order of channels: the first two correspond to the first</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># channel of the input image, convolved with the each of the two gaussians,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># and so on.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">wheel</span><span class="p">,</span> <span class="n">blurred_wheel</span><span class="p">[:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">blurred_wheel</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]],</span>
<span class="gp">... </span>    <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">as_rgb</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/9e7046b95429d3620a9edd1da624bc30/plenoptic-simulate-canonical_computations-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/81309f9909c98a02b23612b83a6a790c/plenoptic-simulate-canonical_computations-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/cd42f96a23edbb5093e4813c0ac10a58/plenoptic-simulate-canonical_computations-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-3.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-3.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.filters.gaussian1d">
<span class="sig-name descname"><span class="pre">gaussian1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">11</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/filters.html#gaussian1d"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.filters.gaussian1d" title="Link to this definition"></a></dt>
<dd><p>Create normalized 1D Gaussian.</p>
<p>1d Gaussian of size <code class="docutils literal notranslate"><span class="pre">kernel_size</span></code>, centered half-way, with variable std
deviation, and sum of 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_size</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Size of Gaussian. Recommended to be odd so that kernel is properly centered.</p></li>
<li><p><strong>std</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code> | <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Standard deviation of Gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>filt</em> – 1d Gaussian with <code class="docutils literal notranslate"><span class="pre">Size([kernel_size])</span></code>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">std</span></code> non-scalar.</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">std</span></code> non-positive.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">plenoptic.simulate</span><span class="w"> </span><span class="kn">import</span> <span class="n">gaussian1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.nn.functional</span><span class="w"> </span><span class="kn">import</span> <span class="n">conv1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># define a filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">21</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filt</span> <span class="o">=</span> <span class="n">gaussian1d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># define a sinusoid + noise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_plus_noise</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sin_plus_noise</span> <span class="o">=</span> <span class="n">sin_plus_noise</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># convolve signal with the Gaussian filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smooth_sin</span> <span class="o">=</span> <span class="n">conv1d</span><span class="p">(</span><span class="n">sin_plus_noise</span><span class="p">,</span> <span class="n">filt</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># plot filter, signal and convolved signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># plot filter and convolution results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">filt</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">[...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;1D Gaussian filter&quot;</span><span class="p">)</span>
<span class="go">Text(0.5, 1.0, &#39;1D Gaussian filter&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sin_plus_noise</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">[...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Sin + Noise&quot;</span><span class="p">)</span>
<span class="go">Text(0.5, 1.0, &#39;Sin + Noise&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">smooth_sin</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">[...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Convolved Sin + Noise&quot;</span><span class="p">)</span>
<span class="go">Text(0.5, 1.0, &#39;Convolved Sin + Noise&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/2e58a75e42188c88273f1693b711e18e/plenoptic-simulate-canonical_computations-4.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/f08f0d263d95f3a3082bd03fdb75ae65/plenoptic-simulate-canonical_computations-4.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/013db7a90fc702f932796c4425254e1e/plenoptic-simulate-canonical_computations-4.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-4.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-4.png" />
</figure>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 1.2.0: </span>gaussian1d will be removed soon.</p>
</div>
</dd></dl>

</section>
<section id="module-plenoptic.simulate.canonical_computations.laplacian_pyramid">
<span id="plenoptic-simulate-canonical-computations-laplacian-pyramid-module"></span><h2>plenoptic.simulate.canonical_computations.laplacian_pyramid module<a class="headerlink" href="#module-plenoptic.simulate.canonical_computations.laplacian_pyramid" title="Link to this heading"></a></h2>
<p>Laplacian pyramid.</p>
<p>Simple class for handling the Laplacian Pyramid.</p>
<dl class="py class">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LaplacianPyramid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/laplacian_pyramid.html#LaplacianPyramid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Laplacian Pyramid in Torch.</p>
<p>The Laplacian pyramid <a class="reference internal" href="#r26b8b7689908-1" id="id1">[1]</a> is a multiscale image representation. It
decomposes the image by computing the local mean using Gaussian blurring
filters and substracting it from the image and repeating this operation on
the local mean itself after downsampling. This representation is
overcomplete and invertible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_scales</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Number of scales to compute.</p></li>
<li><p><strong>scale_filter</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the norm of the downsampling/upsampling filter is 1. If <code class="docutils literal notranslate"><span class="pre">False</span></code>,
it is 2. If the norm is 1, the image is multiplied by 4 during the upsampling
operation; the net effect is that the <span class="math notranslate nohighlight">\(n\)</span> -th scale of the pyramid is
divided by <span class="math notranslate nohighlight">\(2^n\)</span>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.n_scales">
<span class="sig-name descname"><span class="pre">n_scales</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.n_scales" title="Link to this definition"></a></dt>
<dd><p>Number of computed scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.scale_filter">
<span class="sig-name descname"><span class="pre">scale_filter</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.scale_filter" title="Link to this definition"></a></dt>
<dd><p>Whether the filter is scaled or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r26b8b7689908-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Burt, P. and Adelson, E., 1983. The Laplacian pyramid as a compact
image code. IEEE Transactions on communications, 31(4), pp.532-540.</p>
</div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">LaplacianPyramid</span><span class="p">(</span><span class="n">n_scales</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">scale_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.forward" title="plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x)</p></td>
<td><p>Build the Laplacian pyramid of an image.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.recon_pyr" title="plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.recon_pyr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recon_pyr</span></code></a>(y)</p></td>
<td><p>Reconstruct the image from its Laplacian pyramid coefficients.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/laplacian_pyramid.html#LaplacianPyramid.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.forward" title="Link to this definition"></a></dt>
<dd><p>Build the Laplacian pyramid of an image.</p>
<p>Builds a Laplacian pyramid of height <code class="docutils literal notranslate"><span class="pre">self.n_scales</span></code>. Because the tensor at
each scale will have a different height and width, we return a list of tensors
instead of a single tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Image, or batch of images of shape (batch, channel, height, width). If there
are multiple batches or channels, the Laplacian is computed separately for
each of them.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>y</em> – Laplacian pyramid representation, each element of the list corresponds to a
scale, from fine to coarse.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">LaplacianPyramid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">lpyr</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/6af60ead17dd7f33a3b5adb33f9da4c5/plenoptic-simulate-canonical_computations-5.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/264347ab71abaf30ae9430dd68066510/plenoptic-simulate-canonical_computations-5.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/ff6608bd991b4674f2332cca9dab7740/plenoptic-simulate-canonical_computations-5.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-5.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-5.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.recon_pyr">
<span class="sig-name descname"><span class="pre">recon_pyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/laplacian_pyramid.html#LaplacianPyramid.recon_pyr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.laplacian_pyramid.LaplacianPyramid.recon_pyr" title="Link to this definition"></a></dt>
<dd><p>Reconstruct the image from its Laplacian pyramid coefficients.</p>
<p>The input to <code class="docutils literal notranslate"><span class="pre">recon_pyr</span></code> should be list of tensors similar to those returned
by <code class="docutils literal notranslate"><span class="pre">self.forward</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – Laplacian pyramid representation, each element of the list
corresponds to a scale, from fine to coarse. <code class="docutils literal notranslate"><span class="pre">len(y)</span></code> should be
<code class="docutils literal notranslate"><span class="pre">self.n_scales</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>x</em> – Image, or batch of images.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lpyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">LaplacianPyramid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">lpyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recon</span> <span class="o">=</span> <span class="n">lpyr</span><span class="o">.</span><span class="n">recon_pyr</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">recon</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="s2">&quot;Reconstructed&quot;</span><span class="p">,</span> <span class="s2">&quot;Difference&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">img</span><span class="p">,</span> <span class="n">recon</span><span class="p">,</span> <span class="n">img</span> <span class="o">-</span> <span class="n">recon</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/4955e078690df146e91edc9f1e46c92a/plenoptic-simulate-canonical_computations-6.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/5a54ba74e6c3f6cc57c489c7b535883f/plenoptic-simulate-canonical_computations-6.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/5e8beaf7f8f054f0214081b247c99bd5/plenoptic-simulate-canonical_computations-6.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-6.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-6.png" />
</figure>
</dd></dl>

</dd></dl>

</section>
<section id="module-plenoptic.simulate.canonical_computations.non_linearities">
<span id="plenoptic-simulate-canonical-computations-non-linearities-module"></span><h2>plenoptic.simulate.canonical_computations.non_linearities module<a class="headerlink" href="#module-plenoptic.simulate.canonical_computations.non_linearities" title="Link to this heading"></a></h2>
<p>Some useful non-linearities for visual models.</p>
<p>The functions operate on dictionaries or tensors.</p>
<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control">
<span class="sig-name descname"><span class="pre">local_gain_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/non_linearities.html#local_gain_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control" title="Link to this definition"></a></dt>
<dd><p>Spatially local gain control.</p>
<p>Compute the local energy and phase of a real-valued tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Tensor of shape (batch, channel, height, width).</p></li>
<li><p><strong>epsilon</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Small constant to avoid division by zero.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>norm</em> – The local energy of <code class="docutils literal notranslate"><span class="pre">x</span></code>, shape (batch, channel, height/2,
width/2).</p></li>
<li><p><em>direction</em> – The local phase of <code class="docutils literal notranslate"><span class="pre">x</span></code> (a.k.a. local unit vector, or local
state), shape (batch, channel, height, width).</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_control_dict</span></code></a></dt><dd><p>Same operation on dictionaries.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_release</span></code></a></dt><dd><p>The inverse operation.</p>
</dd>
<dt><a class="reference internal" href="plenoptic.tools.html#plenoptic.tools.signal.rectangular_to_polar" title="plenoptic.tools.signal.rectangular_to_polar"><code class="xref py py-func docutils literal notranslate"><span class="pre">rectangular_to_polar()</span></code></a></dt><dd><p>The analogous function for complex-valued signals.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Norm and direction (analogous to complex modulus and phase) are defined using
blurring operator and division. Indeed blurring the responses removes high
frequencies introduced by the squaring operation. In the complex case adding the
quadrature pair response has the same effect (note that this is most clearly seen in
the frequency domain). Here computing the direction (phase) reduces to dividing out
the norm (modulus), indeed the signal only has one real component. This is a
normalization operation (local unit vector), hence the connection to local gain
control.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict">
<span class="sig-name descname"><span class="pre">local_gain_control_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/non_linearities.html#local_gain_control_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict" title="Link to this definition"></a></dt>
<dd><p>Spatially local gain control, for each element in a dictionary.</p>
<p>For more details, see <a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control"><code class="xref py py-func docutils literal notranslate"><span class="pre">local_gain_control()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff_dict</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span>) – A dictionary containing tensors of shape (batch, channel, height, width).</p></li>
<li><p><strong>residuals</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – An option to carry around residuals in the energy dict.
Note that the transformation is not applied to the residuals,
that is dictionary elements with a key starting in “residual”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>energy</em> – The dictionary of torch.Tensors containing the local energy of
<code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><em>state</em> – The dictionary of torch.Tensors containing the local phase of
<code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_control</span></code></a></dt><dd><p>Same operation on tensors.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_release_dict</span></code></a></dt><dd><p>The inverse operation.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.rectangular_to_polar_dict" title="plenoptic.simulate.canonical_computations.non_linearities.rectangular_to_polar_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rectangular_to_polar_dict</span></code></a></dt><dd><p>The analogous function for complex-valued signals.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Note that energy and state are not computed on the residuals.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release">
<span class="sig-name descname"><span class="pre">local_gain_release</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/non_linearities.html#local_gain_release"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release" title="Link to this definition"></a></dt>
<dd><p>Spatially local gain release.</p>
<p>Convert the local energy and phase to a single real-valued tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>norm</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – The local energy of a tensor, with shape (batch, channel, height/2,
width/2).</p></li>
<li><p><strong>direction</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – The local phase of a tensor (a.k.a. local unit vector, or local state),
with shape (batch, channel, height, width).</p></li>
<li><p><strong>epsilon</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></span>) – Small constant to avoid division by zero.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>x</em> – Tensor of shape (batch, channel, height, width).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_release_dict</span></code></a></dt><dd><p>Same operation on dictionaries.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_control</span></code></a></dt><dd><p>The inverse operation.</p>
</dd>
<dt><a class="reference internal" href="plenoptic.tools.html#plenoptic.tools.signal.polar_to_rectangular" title="plenoptic.tools.signal.polar_to_rectangular"><code class="xref py py-func docutils literal notranslate"><span class="pre">polar_to_rectangular()</span></code></a></dt><dd><p>The analogous function for complex-valued signals.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Norm and direction (analogous to complex modulus and phase) are defined using
blurring operator and division. Indeed blurring the responses removes high
frequencies introduced by the squaring operation. In the complex case adding the
quadrature pair response has the same effect (note that this is most clearly seen in
the frequency domain). Here computing the direction (phase) reduces to dividing out
the norm (modulus), indeed the signal only has one real component. This is a
normalization operation (local unit vector), hence the connection to local gain
control.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict">
<span class="sig-name descname"><span class="pre">local_gain_release_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/non_linearities.html#local_gain_release_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict" title="Link to this definition"></a></dt>
<dd><p>Spatially local gain release, for each element in a dictionary.</p>
<p>For more details, see <a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release"><code class="xref py py-func docutils literal notranslate"><span class="pre">local_gain_release()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span>) – The dictionary of torch.Tensors containing the local energy of
<code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><strong>state</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span>) – The dictionary of torch.Tensors containing the local phase of
<code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><strong>residuals</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – An option to carry around residuals in the energy dict.
Note that the transformation is not applied to the residuals,
that is dictionary elements with a key starting in “residual”.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>coeff_dict</em> – A dictionary containing tensors of shape (batch, channel, height, width).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_release</span></code></a></dt><dd><p>Same operation on tensors.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_control_dict</span></code></a></dt><dd><p>The inverse operation.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.polar_to_rectangular_dict" title="plenoptic.simulate.canonical_computations.non_linearities.polar_to_rectangular_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">polar_to_rectangular_dict</span></code></a></dt><dd><p>The analogous function for complex-valued signals.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.non_linearities.polar_to_rectangular_dict">
<span class="sig-name descname"><span class="pre">polar_to_rectangular_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/non_linearities.html#polar_to_rectangular_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.non_linearities.polar_to_rectangular_dict" title="Link to this definition"></a></dt>
<dd><p>Return the real and imaginary parts of tensor in a dictionary.</p>
<p>Keys are preserved, with the option of dropping <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code> by setting <code class="docutils literal notranslate"><span class="pre">residuals=False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span>) – The dictionary of torch.Tensors containing the local complex
modulus.</p></li>
<li><p><strong>state</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span>) – The dictionary of torch.Tensors containing the local phase.</p></li>
<li><p><strong>residuals</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – An option to carry around residuals in the energy branch.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>coeff_dict</em> – A dictionary containing complex tensors of coefficients.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plenoptic.tools.html#plenoptic.tools.signal.polar_to_rectangular" title="plenoptic.tools.signal.polar_to_rectangular"><code class="xref py py-func docutils literal notranslate"><span class="pre">polar_to_rectangular()</span></code></a></dt><dd><p>Same operation on tensors.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.rectangular_to_polar_dict" title="plenoptic.simulate.canonical_computations.non_linearities.rectangular_to_polar_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rectangular_to_polar_dict</span></code></a></dt><dd><p>The inverse operation.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_release_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_release_dict</span></code></a></dt><dd><p>The analogous function for real-valued signals.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.non_linearities.rectangular_to_polar_dict">
<span class="sig-name descname"><span class="pre">rectangular_to_polar_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coeff_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/non_linearities.html#rectangular_to_polar_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.non_linearities.rectangular_to_polar_dict" title="Link to this definition"></a></dt>
<dd><p>Return the complex modulus and the phase of each complex tensor in a dictionary.</p>
<p>Keys are preserved, with the option of dropping <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code> and
<code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code> by setting <code class="docutils literal notranslate"><span class="pre">residuals=False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coeff_dict</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span>) – A dictionary containing complex tensors.</p></li>
<li><p><strong>residuals</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – An option to include residuals in the returned <code class="docutils literal notranslate"><span class="pre">energy</span></code> dict.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>energy</em> – The dictionary of torch.Tensors containing the local complex
modulus of <code class="docutils literal notranslate"><span class="pre">coeff_dict</span></code>.</p></li>
<li><p><em>state</em> – The dictionary of torch.Tensors containing the local phase of
<code class="docutils literal notranslate"><span class="pre">coeff_dict</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plenoptic.tools.html#plenoptic.tools.signal.rectangular_to_polar" title="plenoptic.tools.signal.rectangular_to_polar"><code class="xref py py-func docutils literal notranslate"><span class="pre">rectangular_to_polar()</span></code></a></dt><dd><p>Same operation on tensors.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.polar_to_rectangular_dict" title="plenoptic.simulate.canonical_computations.non_linearities.polar_to_rectangular_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">polar_to_rectangular_dict</span></code></a></dt><dd><p>The inverse operation.</p>
</dd>
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict" title="plenoptic.simulate.canonical_computations.non_linearities.local_gain_control_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">local_gain_control_dict</span></code></a></dt><dd><p>The analogous function for complex-valued signals.</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="module-plenoptic.simulate.canonical_computations.steerable_pyramid_freq">
<span id="plenoptic-simulate-canonical-computations-steerable-pyramid-freq-module"></span><h2>plenoptic.simulate.canonical_computations.steerable_pyramid_freq module<a class="headerlink" href="#module-plenoptic.simulate.canonical_computations.steerable_pyramid_freq" title="Link to this heading"></a></h2>
<p>Steerable frequency pyramid.</p>
<p>Construct a steerable pyramid on matrix two dimensional signals, in the
Fourier domain.</p>
<dl class="py class">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SteerablePyramidFreq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Steerable frequency pyramid in Torch.</p>
<p>Construct a steerable pyramid on matrix two dimensional signals, in the Fourier
domain. Boundary-handling is circular. Reconstruction is exact (within floating
point errors). However, if the image has an odd-shape, the reconstruction will not
be exact due to boundary-handling issues that have not been resolved. Similarly,
a complex pyramid of order=0 has non-exact reconstruction and cannot be tight-frame.</p>
<p>The squared radial functions tile the Fourier plane with a raised-cosine
falloff. Angular functions are</p>
<div class="math notranslate nohighlight">
\[\cos\left(\frac{\theta-k*\pi}{o+1}\right)^o\]</div>
<p>where <span class="math notranslate nohighlight">\(o\)</span> is the order parameter set at initialization and <span class="math notranslate nohighlight">\(k\)</span> runs from
0 to <span class="math notranslate nohighlight">\(o\)</span> for a total of <span class="math notranslate nohighlight">\(o+1\)</span> orientations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_shape</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) – Shape of input image.</p></li>
<li><p><strong>height</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'auto'</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]</span>) – The height of the pyramid. If <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>, will automatically determine based on
the size of <code class="docutils literal notranslate"><span class="pre">image</span></code>. If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, must be non-negative and less than
<code class="docutils literal notranslate"><span class="pre">log2(min(image_shape[1],</span> <span class="pre">image_shape[1]))-2</span></code>. If <code class="docutils literal notranslate"><span class="pre">height=0</span></code>, this only
returns the residuals.</p></li>
<li><p><strong>order</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – The Gaussian derivative order used for the steerable filters, in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">15]</span></code>.
Note that to achieve steerability the minimum number of orientation is
<code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">+</span> <span class="pre">1</span></code>, which is used here. To get more orientations at the same order,
use the method <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">steer_coeffs()</span></code></a>.</p></li>
<li><p><strong>twidth</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – The width of the transition region of the radial lowpass function, in
octaves.</p></li>
<li><p><strong>is_complex</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether the pyramid coefficients should be complex or not. If True, the
real and imaginary parts correspond to a pair of even and odd symmetric
filters. If False, the coefficients only include the real part / even filters.</p></li>
<li><p><strong>downsample</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether to downsample each scale in the pyramid or keep the output
pyramid coefficients in fixed bands of size <code class="docutils literal notranslate"><span class="pre">image_shape</span></code>. When
downsample is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the forward method returns a tensor.</p></li>
<li><p><strong>tight_frame</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether the pyramid obeys the generalized parseval theorem or not (i.e.
is a tight frame). If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the energy of the pyr_coeffs equals the energy
of the image. If not this is not true. In order to match the <a class="reference external" href="http://github.com/labForComputationalVision/matlabpyrtools">matlabPyrTools</a> or <a class="reference external" href="https://github.com/labForComputationalVision/pyrtools">pyrtools</a> implementations, this
must be set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.image_shape">
<span class="sig-name descname"><span class="pre">image_shape</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.image_shape" title="Link to this definition"></a></dt>
<dd><p>Shape of input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.pyr_size">
<span class="sig-name descname"><span class="pre">pyr_size</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.pyr_size" title="Link to this definition"></a></dt>
<dd><p>Dictionary containing the sizes of the pyramid coefficients. Keys are
<code class="docutils literal notranslate"><span class="pre">(level,</span> <span class="pre">band)</span></code> tuples and values are tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.fft_norm">
<span class="sig-name descname"><span class="pre">fft_norm</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.fft_norm" title="Link to this definition"></a></dt>
<dd><p>The way the ffts are normalized, see <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.fft.fft2.html#torch.fft.fft2" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.fft.fft2()</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.is_complex">
<span class="sig-name descname"><span class="pre">is_complex</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.is_complex" title="Link to this definition"></a></dt>
<dd><p>Whether the coefficients are complex- or real-valued.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">image_shape</span></code> contains non-integers.</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">len(image_shape)</span> <span class="pre">!=</span> <span class="pre">2</span></code> .</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">height</span></code> is not a non-negative integer or is larger than the biggest
possible value (determined by <code class="docutils literal notranslate"><span class="pre">image_shape</span></code>).</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">order</span></code> not an integer in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">15]</span></code>.</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">==</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">is_complex</span> <span class="pre">is</span> <span class="pre">False</span></code>. See
<a class="reference external" href="https://github.com/plenoptic-org/plenoptic/issues/326">https://github.com/plenoptic-org/plenoptic/issues/326</a> for an explanation</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">twidth</span></code> not positive.</p></li>
</ul>
</dd>
<dt class="field-even">Warns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>UserWarning</strong> – If <code class="docutils literal notranslate"><span class="pre">image_shape</span></code> has an odd value, because then reconstruction will be
imperfect.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Transform described in <a class="reference internal" href="#r19dab1595aee-1" id="id2">[1]</a>, filter kernel design described in <a class="reference internal" href="#r19dab1595aee-2" id="id3">[2]</a>.
For further information see the project <a class="reference internal" href="#r19dab1595aee-3" id="id4">[3]</a>.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r19dab1595aee-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">1</a><span class="fn-bracket">]</span></span>
<p>E P Simoncelli and W T Freeman, “The Steerable Pyramid: A Flexible
Architecture for Multi-Scale Derivative Computation,” Second Int’l Conf
on Image Processing, Washington, DC, Oct 1995.</p>
</div>
<div class="citation" id="r19dab1595aee-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>A Karasaridis and E P Simoncelli, “A Filter Design Technique for
Steerable Pyramid Image Transforms”, ICASSP, Atlanta, GA, May 1996. ..</p>
</div>
<div class="citation" id="r19dab1595aee-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.cns.nyu.edu/~eero/steerpyr/">https://www.cns.nyu.edu/~eero/steerpyr/</a></p>
</div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_pyr_to_tensor</span></code></a>(pyr_coeffs[, ...])</p></td>
<td><p>Convert coefficient dictionary to a tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_tensor_to_pyr</span></code></a>(pyr_tensor, ...)</p></td>
<td><p>Convert pyramid coefficient tensor to dictionary format.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x[, scales])</p></td>
<td><p>Generate the steerable pyramid coefficients for an image.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.recon_pyr" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.recon_pyr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recon_pyr</span></code></a>(pyr_coeffs[, levels, bands])</p></td>
<td><p>Reconstruct the image or batch of images, optionally using subset coefficients.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">steer_coeffs</span></code></a>(pyr_coeffs, angles[, even_phase])</p></td>
<td><p>Steer pyramid coefficients to the specified angles.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_pyr_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.convert_pyr_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor" title="Link to this definition"></a></dt>
<dd><p>Convert coefficient dictionary to a tensor.</p>
<p>The output tensor has shape (batch, channel, height, width) and is
intended to be used in an <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a> downstream. In the
multichannel case, all bands for each channel will be stacked together
(i.e. if there are 2 channels and 18 bands per channel,
<code class="docutils literal notranslate"><span class="pre">pyr_tensor[:,0:18,...]</span></code> will contain the pyr responses for channel 1 and
<code class="docutils literal notranslate"><span class="pre">pyr_tensor[:,</span> <span class="pre">18:36,</span> <span class="pre">...]</span></code> will contain the responses for channel 2). In
the case of a complex, multichannel pyramid with <code class="docutils literal notranslate"><span class="pre">split_complex=True</span></code>,
the real/imaginary bands will be intereleaved so that they appear as
pairs with neighboring indices in the channel dimension of the tensor
(Note: the residual bands are always real so they will only ever have a
single band even when <code class="docutils literal notranslate"><span class="pre">split_complex=True</span></code>.)</p>
<p>This only works if <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code> was created with a pyramid with
<code class="docutils literal notranslate"><span class="pre">downsample=False</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_coeffs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></span>) – The pyramid coefficients.</p></li>
<li><p><strong>split_complex</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Indicates whether the output should split complex bands into
real/imag channels or keep them as a single channel. This should be
True if you intend to use a convolutional layer on top of the
output.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]]]]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>pyr_tensor</em> – Tensor with shape (batch, channel, height, width). pyramid coefficients
reshaped into tensor. The first channel will be the residual
highpass and the last will be the residual lowpass. Each band is
then a separate channel, going from fine to coarse (i.e., starting with all
of scale 0’s orientations, then scale 1’s, etc.).</p></li>
<li><p><em>pyr_info</em> – Information required to recreate the dictionary, containing the
number of channels, if split_complex was used in this function
call, and the list of pyramid keys for the dictionary.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If <code class="docutils literal notranslate"><span class="pre">self.downsample</span> <span class="pre">is</span> <span class="pre">True</span></code>. In this case, we can’t concatenate across
scales, because each scale is a different size.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_tensor_to_pyr</span></code></a></dt><dd><p>Convert tensor representation to pyramid dictionary.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">downsample</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_pyr_to_tensor</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 26, 256, 256])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># rearrange so that the residuals are at the end</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">coeffs_tensor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">coeffs_tensor</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">coeffs_tensor</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="n">spyr</span><span class="o">.</span><span class="n">num_orientations</span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/084477bf803c9d600f50f81af71aa36a/plenoptic-simulate-canonical_computations-7.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/f4749b598defeac63e2f15a2dbbc02a0/plenoptic-simulate-canonical_computations-7.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/c09ddc3d92565f7f082ab8b6b1588bd8/plenoptic-simulate-canonical_computations-7.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-7.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-7.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_tensor_to_pyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_complex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyr_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.convert_tensor_to_pyr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr" title="Link to this definition"></a></dt>
<dd><p>Convert pyramid coefficient tensor to dictionary format.</p>
<p><code class="docutils literal notranslate"><span class="pre">num_channels</span></code>, <code class="docutils literal notranslate"><span class="pre">split_complex</span></code>, and <code class="docutils literal notranslate"><span class="pre">pyr_keys</span></code> are elements of
the <code class="docutils literal notranslate"><span class="pre">pyr_info</span></code> tuple returned by <code class="docutils literal notranslate"><span class="pre">convert_pyr_to_tensor</span></code>. You
should always unpack the arguments for this function from that
<code class="docutils literal notranslate"><span class="pre">pyr_info</span></code> tuple. See Examples section below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_tensor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Shape (batch, channel, height, width). The pyramid coefficients.</p></li>
<li><p><strong>num_channels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – Number of channels in the original input tensor the pyramid was
created for (i.e. if the input was an RGB image, this would be 3).</p></li>
<li><p><strong>split_complex</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Whether the <code class="docutils literal notranslate"><span class="pre">pyr_tensor</span></code> was created with complex channels split
or not (if the pyramid was a complex pyramid).</p></li>
<li><p><strong>pyr_keys</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>], <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]]]</span>) – Tuple containing the list of keys for the original pyramid dictionary.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>pyr_coeffs</em> – Pyramid coefficients in dictionary format.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_pyr_to_tensor</span></code></a></dt><dd><p>Convert pyramid dictionary representation to tensor.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">downsample</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="n">pyr_info</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_pyr_to_tensor</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_tensor_to_pyr</span><span class="p">(</span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="o">*</span><span class="n">pyr_info</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_coeffs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="Link to this definition"></a></dt>
<dd><p>Generate the steerable pyramid coefficients for an image.</p>
<p>The steerable pyramid coefficients run from fine to coarse and split the image
into subbands corresponding to different orientations and scales (i.e., spatial
frequencies).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – A tensor containing the image to analyze. We want to operate
on this in the pytorch-y way, so we want it to be 4d (batch,
channel, height, width).</p></li>
<li><p><strong>scales</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]]] | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – Which scales to include in the returned representation. If None, we
include all scales. Otherwise, can contain subset of values present
in this model’s <code class="docutils literal notranslate"><span class="pre">scales</span></code> attribute (ints from 0 up to
<code class="docutils literal notranslate"><span class="pre">self.num_scales-1</span></code> and the strs ‘residual_highpass’ and
‘residual_lowpass’. Can contain a single value or multiple values.
If it’s an int, we include all orientations from that scale. Order
within the list does not matter.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>representation</em> – Pyramid coefficients. These will be stored in an ordered dictionary with
keys that are <code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code>, or tuples of
form <code class="docutils literal notranslate"><span class="pre">(scale,</span> <span class="pre">orientation)</span></code>, where <code class="docutils literal notranslate"><span class="pre">scale</span></code> runs from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">self.num_scales-1</span></code> and <code class="docutils literal notranslate"><span class="pre">orientation</span></code> runs from 0 to <code class="docutils literal notranslate"><span class="pre">self.order</span></code>.
Coefficients have shape <code class="docutils literal notranslate"><span class="pre">(*x.shape[:2],</span> <span class="pre">x.shape[2]</span> <span class="pre">/</span> <span class="pre">2**scale,</span> <span class="pre">x.shape[3]</span> <span class="pre">/</span>
<span class="pre">2**scale)</span></code>, with the <code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code> height and width matching that
of <code class="docutils literal notranslate"><span class="pre">x</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code> having height and width <code class="docutils literal notranslate"><span class="pre">(x.shape[2]</span> <span class="pre">/</span>
<span class="pre">2**self.num_scales,</span> <span class="pre">x.shape[3]</span> <span class="pre">/</span> <span class="pre">2**self.num_scales)</span></code>. They are ordered
from fine to coarse: <code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;,</span> <span class="pre">(scale=0,</span> <span class="pre">orientation=0),</span>
<span class="pre">(scale=0,</span> <span class="pre">orientation=1),</span> <span class="pre">...,</span> <span class="pre">(scale=num_scales-1,</span> <span class="pre">orientation=order),</span>
<span class="pre">&quot;residual_lowpass&quot;</span></code>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">image</span></code> is the wrong shape, i.e. <code class="docutils literal notranslate"><span class="pre">image.shape[-2:]</span> <span class="pre">!=</span>
<span class="pre">self.image_shape</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">pyrshow</span><span class="p">(</span><span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/35417ed3166bffe46d54cd97f77a765a/plenoptic-simulate-canonical_computations-8.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/a5a3c93f3c162a7f2f8c46e9b4cd022a/plenoptic-simulate-canonical_computations-8.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/15d28401aba7b62fecc3db1505f84e49/plenoptic-simulate-canonical_computations-8.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-8.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-8.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.recon_pyr">
<span class="sig-name descname"><span class="pre">recon_pyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.recon_pyr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.recon_pyr" title="Link to this definition"></a></dt>
<dd><p>Reconstruct the image or batch of images, optionally using subset coefficients.</p>
<p>NOTE: in order to call this function, you need to have previously called
<a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code></a>, with the tensor you wish to reconstruct. This will fail if
you called <code class="docutils literal notranslate"><span class="pre">forward()</span></code> with a subset of scales.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_coeffs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></span>) – Pyramid coefficients to reconstruct from.</p></li>
<li><p><strong>levels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'all'</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]]]]</span>) – If <code class="docutils literal notranslate"><span class="pre">list</span></code> should contain some subset of integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">self.num_scales-1</span></code> (inclusive), <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code>, and
<code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>, returned value will contain all
valid levels. Otherwise, must be one of the valid levels.</p></li>
<li><p><strong>bands</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'all'</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]</span>) – If list, should contain some subset of integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">self.num_orientations-1</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>, returned value will contain
all valid orientations. Otherwise, must be one of the valid
orientations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>recon</em> – The reconstructed image, of shape (batch, channel, height, width).</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">self.forward()</span></code> was called with <code class="docutils literal notranslate"><span class="pre">scales</span></code> argument not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>TypeError</strong> – If <code class="docutils literal notranslate"><span class="pre">levels</span></code> is not one of the allowed values.</p></li>
<li><p><strong>TypeError</strong> – If <code class="docutils literal notranslate"><span class="pre">bands</span></code> is not an integer or <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code> .</p></li>
<li><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">bands</span></code> is an integer outside of the range <code class="docutils literal notranslate"><span class="pre">[0,</span>
<span class="pre">self.num_orientations-1]</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recon</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">recon_pyr</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">recon</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="s2">&quot;Reconstructed&quot;</span><span class="p">,</span> <span class="s2">&quot;Difference&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">img</span><span class="p">,</span> <span class="n">recon</span><span class="p">,</span> <span class="n">img</span> <span class="o">-</span> <span class="n">recon</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/8342e5194a4cf5d3cd7a67ac8117abb2/plenoptic-simulate-canonical_computations-9.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/c05405267d139610898da1c4589ec8fa/plenoptic-simulate-canonical_computations-9.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/cca9339ab34c12e631b576216dedc5c5/plenoptic-simulate-canonical_computations-9.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-9.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-9.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs">
<span class="sig-name descname"><span class="pre">steer_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.steer_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs" title="Link to this definition"></a></dt>
<dd><p>Steer pyramid coefficients to the specified angles.</p>
<p>This allows you to have filters that have the Gaussian derivative order
specified in construction, but arbitrary angles or number of orientations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_coeffs</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></span>) – The pyramid coefficients to steer.</p></li>
<li><p><strong>angles</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]</span>) – List of angles (in radians) to steer the pyramid coefficients to.</p></li>
<li><p><strong>even_phase</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) – Specifies whether the harmonics are cosine or sine phase aligned
about those positions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>resteered_coeffs</em> – Dictionary of re-steered pyramid coefficients. will have the same
number of scales as the original pyramid (though it will not
contain the residual highpass or lowpass). like <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code>, keys
are 2-tuples of ints indexing the scale and orientation, but now
we’re indexing <code class="docutils literal notranslate"><span class="pre">angles</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.num_orientations</span></code>.</p></li>
<li><p><em>resteering_weights</em> – Dictionary of weights used to re-steer the pyramid coefficients.
will have the same keys as <code class="docutils literal notranslate"><span class="pre">resteered_coeffs</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-plenoptic.simulate.canonical_computations">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-plenoptic.simulate.canonical_computations" title="Link to this heading"></a></h2>
<p>Canonical computations.</p>
<p>These functions and classes may be useful when building models.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plenoptic.simulate.html" class="btn btn-neutral float-left" title="plenoptic.simulate package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plenoptic.simulate.models.html" class="btn btn-neutral float-right" title="plenoptic.simulate.models package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Plenoptic authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>