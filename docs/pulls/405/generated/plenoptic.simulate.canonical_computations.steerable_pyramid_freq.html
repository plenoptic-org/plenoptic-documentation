

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plenoptic.simulate.canonical_computations.steerable_pyramid_freq &mdash; plenoptic 1.3.2.dev217 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a2d047e6" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=4ba52da5"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=6dbb43f8"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=1ae7504c"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            plenoptic
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basic concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter.html">Using Jupyter to Run Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conceptual_intro.html">Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Model requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citation Guide and Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method introductions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/Eigendistortions.html">Eigendistortions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/MAD_Competition_1.html">MAD Competition Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/MAD_Competition_2.html">MAD Competition Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/Metamer.html">Metamers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models and metrics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/Perceptual_distance.html">Perceptual distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/Steerable_Pyramid.html">Steerable Pyramid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/portilla_simoncelli/ps_index.html">Portilla-Simoncelli Texture Model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/Demo_Eigendistortion.html">Reproducing Berardino et al., 2017 (Eigendistortions)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/Original_MAD.html">Reproducing Wang and Simoncelli, 2008 (MAD Competition)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tips.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reproducibility.html">Reproducibility and Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Display.html">Display and animate functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Synthesis_extensions.html">Extending existing synthesis objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../synthesis.html">Synthesis object design</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">plenoptic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">plenoptic.simulate.canonical_computations.steerable_pyramid_freq</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/plenoptic.simulate.canonical_computations.steerable_pyramid_freq.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-plenoptic.simulate.canonical_computations.steerable_pyramid_freq">
<span id="plenoptic-simulate-canonical-computations-steerable-pyramid-freq"></span><h1>plenoptic.simulate.canonical_computations.steerable_pyramid_freq<a class="headerlink" href="#module-plenoptic.simulate.canonical_computations.steerable_pyramid_freq" title="Link to this heading"></a></h1>
<p>Steerable frequency pyramid.</p>
<p>Construct a steerable pyramid on matrix two dimensional signals, in the
Fourier domain.</p>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SteerablePyramidFreq</span></code></a>(image_shape[, height, ...])</p></td>
<td><p>Steerable frequency pyramid in Torch.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">SteerablePyramidFreq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">twidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Steerable frequency pyramid in Torch.</p>
<p>Construct a steerable pyramid on matrix two dimensional signals, in the Fourier
domain. Boundary-handling is circular. Reconstruction is exact (within floating
point errors). However, if the image has an odd-shape, the reconstruction will not
be exact due to boundary-handling issues that have not been resolved. Similarly,
a complex pyramid of order=0 has non-exact reconstruction and cannot be tight-frame.</p>
<p>The squared radial functions tile the Fourier plane with a raised-cosine
falloff. Angular functions are</p>
<div class="math notranslate nohighlight">
\[\cos\left(\frac{\theta-k*\pi}{o+1}\right)^o\]</div>
<p>where <span class="math notranslate nohighlight">\(o\)</span> is the order parameter set at initialization and <span class="math notranslate nohighlight">\(k\)</span> runs from
0 to <span class="math notranslate nohighlight">\(o\)</span> for a total of <span class="math notranslate nohighlight">\(o+1\)</span> orientations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_shape</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Shape of input image.</p></li>
<li><p><strong>height</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'auto'</span></code>] | <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>)) – The height of the pyramid. If <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>, will automatically determine based on
the size of <code class="docutils literal notranslate"><span class="pre">image</span></code>. If an <code class="docutils literal notranslate"><span class="pre">int</span></code>, must be non-negative and less than
<code class="docutils literal notranslate"><span class="pre">log2(min(image_shape[1],</span> <span class="pre">image_shape[1]))-2</span></code>. If <code class="docutils literal notranslate"><span class="pre">height=0</span></code>, this only
returns the residuals.</p></li>
<li><p><strong>order</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">3</span></code>)) – The Gaussian derivative order used for the steerable filters, in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">15]</span></code>.
Note that to achieve steerability the minimum number of orientation is
<code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">+</span> <span class="pre">1</span></code>, which is used here. To get more orientations at the same order,
use the method <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">steer_coeffs</span></code></a>.</p></li>
<li><p><strong>twidth</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)) – The width of the transition region of the radial lowpass function, in
octaves.</p></li>
<li><p><strong>is_complex</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)) – Whether the pyramid coefficients should be complex or not. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the real
and imaginary parts correspond to a pair of odd and even symmetric filters. If
<code class="docutils literal notranslate"><span class="pre">False</span></code>, the coefficients only include the real part. Regardless of the value
of <code class="docutils literal notranslate"><span class="pre">is_complex</span></code>, the symmetry of the real part is determined by the <code class="docutils literal notranslate"><span class="pre">order</span></code>
parameter: if <code class="docutils literal notranslate"><span class="pre">order</span></code> is even, then the real coefficients are even symmetric;
if <code class="docutils literal notranslate"><span class="pre">order</span></code> is odd, then the real coefficients are odd symmetric. (If
<code class="docutils literal notranslate"><span class="pre">is_complex=True</span></code>, then the imaginary coefficients will have the opposite
symmetry of the real ones).</p></li>
<li><p><strong>downsample</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)) – Whether to downsample each scale in the pyramid or keep the output
pyramid coefficients in fixed bands of size <code class="docutils literal notranslate"><span class="pre">image_shape</span></code>. When
downsample is <code class="docutils literal notranslate"><span class="pre">False</span></code>, the forward method returns a tensor.</p></li>
<li><p><strong>tight_frame</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)) – Whether the pyramid obeys the generalized parseval theorem or not (i.e.
is a tight frame). If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the energy of the pyr_coeffs equals the energy
of the image. In order to match the <a class="reference external" href="http://github.com/labForComputationalVision/matlabpyrtools">matlabPyrTools</a> or <a class="reference external" href="https://github.com/labForComputationalVision/pyrtools">pyrtools</a> implementations, this
must be set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.image_shape">
<span class="sig-name descname"><span class="pre">image_shape</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.image_shape" title="Link to this definition"></a></dt>
<dd><p>Shape of input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.pyr_size">
<span class="sig-name descname"><span class="pre">pyr_size</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.pyr_size" title="Link to this definition"></a></dt>
<dd><p>Dictionary containing the height and width of the pyramid coefficients. Keys are
the same as those in <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code> returned by <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward</span></code></a>, in order:
<code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code>, the integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to (the initialization
argument) <code class="docutils literal notranslate"><span class="pre">order</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code>. The values are 2-tuples of
ints. While the dictionary is initialized with the object, the values are not
set until the first time <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward</span></code></a> is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.fft_norm">
<span class="sig-name descname"><span class="pre">fft_norm</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.fft_norm" title="Link to this definition"></a></dt>
<dd><p>The way the ffts are normalized, see <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.fft.fft2.html#torch.fft.fft2" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.fft.fft2</span></code></a> for more details.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.is_complex">
<span class="sig-name descname"><span class="pre">is_complex</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.is_complex" title="Link to this definition"></a></dt>
<dd><p>Whether the coefficients are complex- or real-valued.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.scales">
<span class="sig-name descname"><span class="pre">scales</span></span><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.scales" title="Link to this definition"></a></dt>
<dd><p>All the scales of the representation (including residuals) in coarse-to-fine
order. A subset of this list can be passed to the <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward</span></code></a> method to
restrict the output.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">image_shape</span></code> contains non-integers.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">len(image_shape)</span> <span class="pre">!=</span> <span class="pre">2</span></code> .</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">height</span></code> is not a non-negative integer or is larger than the biggest
    possible value (determined by <code class="docutils literal notranslate"><span class="pre">image_shape</span></code>).</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">order</span></code> not an integer in <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">15]</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">==</span> <span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">is_complex</span> <span class="pre">is</span> <span class="pre">False</span></code>. See
    <a class="reference external" href="https://github.com/plenoptic-org/plenoptic/issues/326">https://github.com/plenoptic-org/plenoptic/issues/326</a> for an explanation</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">twidth</span></code> not positive.</p></li>
</ul>
</dd>
<dt class="field-even">Warns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>UserWarning</strong> – If <code class="docutils literal notranslate"><span class="pre">image_shape</span></code> has an odd value, because then reconstruction will be
imperfect.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Transform described in Simoncelli and Freeman, 1995 <a class="footnote-reference brackets" href="#id4" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, filter kernel design
described in Karasaridis and Smoncelli, 1996 <a class="footnote-reference brackets" href="#id5" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. For further information see
online <a class="footnote-reference brackets" href="#id6" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>E P Simoncelli and W T Freeman, “The Steerable Pyramid: A Flexible
Architecture for Multi-Scale Derivative Computation,” Second Int’l Conf
on Image Processing, Washington, DC, Oct 1995.</p>
</aside>
<aside class="footnote brackets" id="id5" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>A Karasaridis and E P Simoncelli, “A Filter Design Technique for
Steerable Pyramid Image Transforms”, ICASSP, Atlanta, GA, May 1996. ..</p>
</aside>
<aside class="footnote brackets" id="id6" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://www.cns.nyu.edu/~eero/steerpyr/">https://www.cns.nyu.edu/~eero/steerpyr/</a></p>
</aside>
</aside>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">convert_pyr_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_complex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.convert_pyr_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor" title="Link to this definition"></a></dt>
<dd><p>Convert coefficient dictionary to a tensor.</p>
<p>The output tensor has shape (batch, channel, height, width) and is
intended to be used in an <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a> downstream. In the
multichannel case, all bands for each channel will be stacked together
(i.e. if there are 2 channels and 18 bands per channel,
<code class="docutils literal notranslate"><span class="pre">pyr_tensor[:,0:18,...]</span></code> will contain the pyr responses for channel 1 and
<code class="docutils literal notranslate"><span class="pre">pyr_tensor[:,</span> <span class="pre">18:36,</span> <span class="pre">...]</span></code> will contain the responses for channel 2). In
the case of a complex, multichannel pyramid with <code class="docutils literal notranslate"><span class="pre">split_complex=True</span></code>,
the real/imaginary bands will be intereleaved so that they appear as
pairs with neighboring indices in the channel dimension of the tensor.
(Note: the residual bands are always real so they will only ever have a
single band even when <code class="docutils literal notranslate"><span class="pre">split_complex=True</span></code>.)</p>
<p>This only works if <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code> was created with a pyramid with
<code class="docutils literal notranslate"><span class="pre">downsample=False</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_coeffs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></a></span>) – The pyramid coefficients.</p></li>
<li><p><strong>split_complex</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)) – Indicates whether the output should split complex bands into
real/imag channels or keep them as a single channel. This should be
<code class="docutils literal notranslate"><span class="pre">True</span></code> if you intend to use a convolutional layer on top of the
output.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/size.html#torch.Size" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Size</span></code></a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/size.html#torch.Size" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Size</span></code></a>] | <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>pyr_tensor</em> – Tensor with shape (batch, channel, height, width). pyramid coefficients
reshaped into tensor. The first channel will be the residual
highpass and the last will be the residual lowpass. Each band is
then a separate channel, going from fine to coarse (i.e., starting with all
of scale 0’s orientations, then scale 1’s, etc.).</p></li>
<li><p><em>pyr_info</em> – Information required to recreate the dictionary, containing the
number of channels, the list of pyramid keys for the dictionary,
info on how to unpack the coefficients, and info on how <code class="docutils literal notranslate"><span class="pre">split_complex</span></code>
was used.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.14)"><strong>RuntimeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">self.downsample</span> <span class="pre">is</span> <span class="pre">True</span></code>. In this case, we can’t concatenate across
    scales, because each scale is a different size.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_tensor_to_pyr</span></code></a></dt><dd><p>Convert tensor representation to pyramid dictionary.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">downsample</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_pyr_to_tensor</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 26, 256, 256])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># rearrange so that the residuals are at the end</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">... </span>    <span class="n">coeffs_tensor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">coeffs_tensor</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">coeffs_tensor</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:],</span>
<span class="gp">... </span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="n">spyr</span><span class="o">.</span><span class="n">num_orientations</span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/ae08e65f27a898f754be3c1f8367a272/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/7f8ed55f77164114ed87190ddb7546ae/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/c3838cf6dea0b3f0863f3ae7c9cdef74/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-1.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-1.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">convert_tensor_to_pyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_channels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyr_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pack_info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_complex_pack_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.convert_tensor_to_pyr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_tensor_to_pyr" title="Link to this definition"></a></dt>
<dd><p>Convert pyramid coefficient tensor to dictionary format.</p>
<p>The arguments other than <code class="docutils literal notranslate"><span class="pre">pyr_tensor</span></code> are elements of the
<code class="docutils literal notranslate"><span class="pre">pyr_info</span></code> tuple returned by <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convert_pyr_to_tensor</span></code></a>. You
should always unpack the arguments for this function from that
<code class="docutils literal notranslate"><span class="pre">pyr_info</span></code> tuple. See Examples section below.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_tensor</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – Shape (batch, channel, height, width). The pyramid coefficients.</p></li>
<li><p><strong>num_channels</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Number of channels in the original input tensor the pyramid was
created for (i.e. if the input was an RGB image, this would be 3).</p></li>
<li><p><strong>pyr_keys</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]]</span>) – Keys from the original pyramid dictionary.</p></li>
<li><p><strong>pack_info</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/size.html#torch.Size" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Size</span></code></a>]</span>) – List of sizes of the fifth dimension for each coefficient (i.e., the number
of orientations) used to pack/unpack the tensors.</p></li>
<li><p><strong>split_complex_pack_info</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/size.html#torch.Size" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Size</span></code></a>] | <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convert_pyr_to_tensor</span></code></a> was called with <code class="docutils literal notranslate"><span class="pre">split_complex=True</span></code>,
another list of sizes used to pack/unpack the tensors. Else, <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>pyr_coeffs</em> – Pyramid coefficients in dictionary format as returned by <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward</span></code></a>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.convert_pyr_to_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_pyr_to_tensor</span></code></a></dt><dd><p>Convert pyramid dictionary representation to tensor.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">downsample</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_complex</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="n">pyr_info</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_pyr_to_tensor</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 26, 256, 256])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">torch.complex64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_tensor_to_pyr</span><span class="p">(</span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="o">*</span><span class="n">pyr_info</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_coeffs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="n">pyr_info</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_pyr_to_tensor</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">coeffs</span><span class="p">,</span> <span class="n">split_complex</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 50, 256, 256])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs_tensor</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">torch.float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">convert_tensor_to_pyr</span><span class="p">(</span><span class="n">coeffs_tensor</span><span class="p">,</span> <span class="o">*</span><span class="n">pyr_info</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">([</span><span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">new_coeffs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scales</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="Link to this definition"></a></dt>
<dd><p>Generate the steerable pyramid coefficients for an image.</p>
<p>The steerable pyramid coefficients run from fine to coarse and split the image
into subbands corresponding to different orientations and scales (i.e., spatial
frequencies).</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>The returned <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code> dictionary’s keys are now either strings
specifying the residual or integers specifying the scale. The non-residual
coefficients are now 5d tensors of shape (batch, channel, num_orientations,
height, width).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – A tensor containing the image to analyze. We want to operate
on this in the pytorch-y way, so we want it to be 4d (batch,
channel, height, width).</p></li>
<li><p><strong>scales</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]] | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Which scales to include in the returned representation. If None, we
include all scales. Otherwise, can contain subset of values present
in this model’s <code class="docutils literal notranslate"><span class="pre">scales</span></code> attribute (ints from 0 up to
<code class="docutils literal notranslate"><span class="pre">self.num_scales-1</span></code> and the strs ‘residual_highpass’ and
‘residual_lowpass’. Can contain a single value or multiple values.
If it’s an int, we include all orientations from that scale. Order
within the list does not matter.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>pyr_coeffs</em> – Pyramid coefficients. These will be stored in an ordered dictionary with
keys that are, in order: <code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code>, the integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
(the initialization argument) <code class="docutils literal notranslate"><span class="pre">order</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code>.
Coefficients have shape <code class="docutils literal notranslate"><span class="pre">(*image.shape[:2],</span> <span class="pre">self.num_orientations,</span>
<span class="pre">image.shape[2]</span> <span class="pre">/</span> <span class="pre">2**scale,</span> <span class="pre">image.shape[3]</span> <span class="pre">/</span> <span class="pre">2**scale)</span></code>, with the
<code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code> height and width matching that of <code class="docutils literal notranslate"><span class="pre">image</span></code>, and
<code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code> having height and width <code class="docutils literal notranslate"><span class="pre">(image.shape[2]</span> <span class="pre">/</span>
<span class="pre">2**self.num_scales,</span> <span class="pre">image.shape[3]</span> <span class="pre">/</span> <span class="pre">2**self.num_scales)</span></code>. They are
ordered from fine to coarse: <code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;,</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">...,</span>
<span class="pre">num_scales-1,</span> <span class="pre">&quot;residual_lowpass&quot;</span></code>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">image</span></code> is the wrong shape, i.e. <code class="docutils literal notranslate"><span class="pre">image.shape[-2:]</span> <span class="pre">!=</span>
&#160;&#160;&#160; <span class="pre">self.image_shape</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">pyrshow</span><span class="p">(</span><span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/e92cd419e941a5b43909791e2931d549/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-2.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/feac64a5aee7accae0bfddd9dbe7e1d5/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-2.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/fd9a9063ba200940a9e0f834de7329b1/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-2.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-2.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.recon_pyr">
<span class="sig-name descname"><span class="pre">recon_pyr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.recon_pyr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.recon_pyr" title="Link to this definition"></a></dt>
<dd><p>Reconstruct image from coefficients, optionally using a subset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_coeffs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></a></span>) – Pyramid coefficients to reconstruct from.</p></li>
<li><p><strong>levels</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'all'</span></code>] | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'residual_lowpass'</span></code>, <code class="docutils literal notranslate"><span class="pre">'residual_highpass'</span></code>]]</span> (default: <code class="docutils literal notranslate"><span class="pre">'all'</span></code>)) – If <code class="docutils literal notranslate"><span class="pre">list</span></code> should contain some subset of integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">self.num_scales-1</span></code> (inclusive), <code class="docutils literal notranslate"><span class="pre">&quot;residual_lowpass&quot;</span></code>, and
<code class="docutils literal notranslate"><span class="pre">&quot;residual_highpass&quot;</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>, returned value will contain all
valid levels. Otherwise, must be one of the valid levels.</p></li>
<li><p><strong>bands</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'all'</span></code>] | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">'all'</span></code>)) – If list, should contain some subset of integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
<code class="docutils literal notranslate"><span class="pre">self.num_orientations-1</span></code>. If <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code>, returned value will contain
all valid orientations. Otherwise, must be one of the valid
orientations.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>recon</em> – The reconstructed image, of shape (batch, channel, height, width).</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">self.forward()</span></code> was called with <code class="docutils literal notranslate"><span class="pre">scales</span></code> argument not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.14)"><strong>TypeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">levels</span></code> is not one of the allowed values.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.14)"><strong>TypeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">bands</span></code> is not an integer or <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code> .</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">bands</span></code> is an integer outside of the range <code class="docutils literal notranslate"><span class="pre">[0,</span>
&#160;&#160;&#160; <span class="pre">self.num_orientations-1]</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recon</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">recon_pyr</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">recon</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Original&quot;</span><span class="p">,</span> <span class="s2">&quot;Reconstructed&quot;</span><span class="p">,</span> <span class="s2">&quot;Difference&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">img</span><span class="p">,</span> <span class="n">recon</span><span class="p">,</span> <span class="n">img</span> <span class="o">-</span> <span class="n">recon</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">titles</span><span class="p">)</span>
<span class="go">&lt;PyrFigure ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/1367a970d0a689d48b490ce23fe0c992/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-3.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/895719682995ed144d4479166e592781/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-3.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/05289c0cdaa394d8877b336664fad172/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-3.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-3.png" class="plot-directive" src="../_images/plenoptic-simulate-canonical_computations-steerable_pyramid_freq-3.png" />
</figure>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs">
<span class="sig-name descname"><span class="pre">steer_coeffs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyr_coeffs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even_phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/simulate/canonical_computations/steerable_pyramid_freq.html#SteerablePyramidFreq.steer_coeffs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.steer_coeffs" title="Link to this definition"></a></dt>
<dd><p>Steer pyramid coefficients to the specified angles.</p>
<p>This allows you to have filters that have the Gaussian derivative order
specified in construction, but arbitrary angles or number of orientations.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.4: </span>The returned <code class="docutils literal notranslate"><span class="pre">resteered_coeffs</span></code> dictionary now only contains the new
angles, as opposed to concatenating the new angles onto those found in
the input <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code>. Like the input <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code>, the dictionary
keys are now integers specifying the scale and the coefficients are
5d tensors of shape (batch, channel, angles, height, width).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pyr_coeffs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.OrderedDict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrderedDict</span></code></a></span>) – The pyramid coefficients to steer, as returned by <a class="reference internal" href="#plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward" title="plenoptic.simulate.canonical_computations.steerable_pyramid_freq.SteerablePyramidFreq.forward"><code class="xref py py-meth docutils literal notranslate"><span class="pre">forward</span></code></a>.</p></li>
<li><p><strong>angles</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – List of angles (in radians) to steer the pyramid coefficients to.</p></li>
<li><p><strong>even_phase</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)) – Specifies whether the harmonics are cosine or sine phase aligned
about those positions.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>resteered_coeffs</em> – Dictionary of re-steered pyramid coefficients. will have the same
number of scales as the original pyramid (though it will not
contain the residual highpass or lowpass). Like the input <code class="docutils literal notranslate"><span class="pre">pyr_coeffs</span></code>,
keys are ints indexing the scale and values are tensors of shape (batch,
channel, orientations, height, width), but now orientations index <code class="docutils literal notranslate"><span class="pre">angles</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">self.num_orientations</span></code>.</p></li>
<li><p><em>resteering_weights</em> – Dictionary of weights used to re-steer the pyramid coefficients.
will have the same keys as <code class="docutils literal notranslate"><span class="pre">resteered_coeffs</span></code>.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spyr</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">SteerablePyramidFreq</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">spyr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resteered_coeffs</span><span class="p">,</span> <span class="n">resteering_weights</span> <span class="o">=</span> <span class="n">spyr</span><span class="o">.</span><span class="n">steer_coeffs</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">coeffs</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ani</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">animshow</span><span class="p">(</span><span class="n">resteered_coeffs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framerate</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save the video (here we&#39;re saving it as a .gif)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ani</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;resteered_coeffs.gif&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/resteered_coeffs.gif" src="../_images/resteered_coeffs.gif" />
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2025, Plenoptic authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>