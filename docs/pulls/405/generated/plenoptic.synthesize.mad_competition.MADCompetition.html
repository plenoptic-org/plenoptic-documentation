

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plenoptic.synthesize.mad_competition.MADCompetition &mdash; plenoptic 1.3.2.dev217 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=a2d047e6" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=4ba52da5"></script>
      <script src="../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=6dbb43f8"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="../_static/togglebutton.js?v=1ae7504c"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tips and Tricks" href="../tips.html" />
    <link rel="prev" title="plenoptic.synthesize.eigendistortion.Eigendistortion" href="plenoptic.synthesize.eigendistortion.Eigendistortion.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            plenoptic
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Basic concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter.html">Using Jupyter to Run Example Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conceptual_intro.html">Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Model requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citation Guide and Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method introductions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/Eigendistortions.html">Eigendistortions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/MAD_Competition_1.html">MAD Competition Conceptual Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/MAD_Competition_2.html">MAD Competition Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/intro/Metamer.html">Metamers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models and metrics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/Perceptual_distance.html">Perceptual distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/Steerable_Pyramid.html">Steerable Pyramid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/models/portilla_simoncelli/ps_index.html">Portilla-Simoncelli Texture Model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synthesis method examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/Demo_Eigendistortion.html">Reproducing Berardino et al., 2017 (Eigendistortions)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/applications/Original_MAD.html">Reproducing Wang and Simoncelli, 2008 (MAD Competition)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#synthesis-objects">Synthesis objects</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plenoptic.synthesize.metamer.Metamer.html">plenoptic.synthesize.metamer.Metamer</a></li>
<li class="toctree-l3"><a class="reference internal" href="plenoptic.synthesize.metamer.MetamerCTF.html">plenoptic.synthesize.metamer.MetamerCTF</a></li>
<li class="toctree-l3"><a class="reference internal" href="plenoptic.synthesize.eigendistortion.Eigendistortion.html">plenoptic.synthesize.eigendistortion.Eigendistortion</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">plenoptic.synthesize.mad_competition.MADCompetition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition"><code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#metrics">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#synthesis-helper-functions">Synthesis helper functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#canonical-computations">Canonical Computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#loading-creating-and-accessing-images">Loading, creating, and accessing images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#validation">Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#display">Display</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#optimization">Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#debugging">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#external">External</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tips.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reproducibility.html">Reproducibility and Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Display.html">Display and animate functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/advanced/Synthesis_extensions.html">Extending existing synthesis objects</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../synthesis.html">Synthesis object design</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">plenoptic</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Reference</a></li>
      <li class="breadcrumb-item active">plenoptic.synthesize.mad_competition.MADCompetition</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/plenoptic.synthesize.mad_competition.MADCompetition.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plenoptic-synthesize-mad-competition-madcompetition">
<h1>plenoptic.synthesize.mad_competition.MADCompetition<a class="headerlink" href="#plenoptic-synthesize-mad-competition-madcompetition" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">MADCompetition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimized_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_tradeoff_lambda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_penalty_lambda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">1)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition" title="Link to this definition"></a></dt>
<dd><p>Synthesize a single maximally-differentiating image for two metrics.</p>
<p>Following the basic idea in <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, this class synthesizes a
maximally-differentiating image for two given metrics, based on a given
image. We start by adding noise to this image and then iteratively
adjusting its pixels so as to either minimize or maximize
<code class="docutils literal notranslate"><span class="pre">optimized_metric</span></code> while holding the value of <code class="docutils literal notranslate"><span class="pre">reference_metric</span></code> constant.</p>
<p>MADCompetiton accepts two metrics as its input. These should be callables
that take two images and return a single number, and that number should be
0 if and only if the two images are identical (thus, the larger the number,
the more different the two images).</p>
<p>Note that a full set of MAD Competition images consists of two pairs: a maximal and
a minimal image for each metric. A single instantiation of <code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code> will
generate one of these four images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – A tensor, this is the image we use as the reference point.</p></li>
<li><p><strong>optimized_metric</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – The metric whose value you wish to minimize or maximize, which takes
two tensors and returns a scalar.</p></li>
<li><p><strong>reference_metric</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span>) – The metric whose value you wish to keep fixed, which takes two tensors
and returns a scalar.</p></li>
<li><p><strong>minmax</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'min'</span></code>, <code class="docutils literal notranslate"><span class="pre">'max'</span></code>]</span>) – Whether you wish to minimize or maximize <code class="docutils literal notranslate"><span class="pre">optimized_metric</span></code>.</p></li>
<li><p><strong>metric_tradeoff_lambda</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Lambda to multiply by <code class="docutils literal notranslate"><span class="pre">reference_metric</span></code> loss and add to
<code class="docutils literal notranslate"><span class="pre">optimized_metric</span></code> loss. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we pick a value so the two
initial losses are approximately equal in magnitude.</p></li>
<li><p><strong>range_penalty_lambda</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code>)) – Lambda to multiply by range penalty and add to loss.</p></li>
<li><p><strong>allowed_range</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1)</span></code>)) – Range (inclusive) of allowed pixel values. Any values outside this
range will be penalized.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Wang, Z., &amp; Simoncelli, E. P. (2008). Maximum differentiation (MAD)
competition: A methodology for comparing computational models of
perceptual discriminability. Journal of Vision, 8(12), 1–13.
<a class="reference external" href="https://dx.doi.org/10.1167/8.12.8">https://dx.doi.org/10.1167/8.12.8</a></p>
</aside>
</aside>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.get_progress" title="plenoptic.synthesize.mad_competition.MADCompetition.get_progress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_progress</span></code></a>(iteration[, iteration_selection])</p></td>
<td><p>Return dictionary summarizing synthesis progress at <code class="docutils literal notranslate"><span class="pre">iteration</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.load" title="plenoptic.synthesize.mad_competition.MADCompetition.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(file_path[, map_location, ...])</p></td>
<td><p>Load all relevant stuff from a .pt file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.objective_function" title="plenoptic.synthesize.mad_competition.MADCompetition.objective_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">objective_function</span></code></a>([mad_image, image])</p></td>
<td><p>Compute the MADCompetition synthesis loss.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.save" title="plenoptic.synthesize.mad_competition.MADCompetition.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(file_path)</p></td>
<td><p>Save all relevant variables in .pt file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.setup" title="plenoptic.synthesize.mad_competition.MADCompetition.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>([initial_noise, optimizer, ...])</p></td>
<td><p>Initialize the MAD image, optimizer, and scheduler.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.synthesize" title="plenoptic.synthesize.mad_competition.MADCompetition.synthesize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">synthesize</span></code></a>([max_iter, store_progress, ...])</p></td>
<td><p>Synthesize a MAD image.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.to" title="plenoptic.synthesize.mad_competition.MADCompetition.to"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code></a>(*args, **kwargs)</p></td>
<td><p>Move and/or casts the parameters and buffers.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.allowed_range" title="plenoptic.synthesize.mad_competition.MADCompetition.allowed_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allowed_range</span></code></a></p></td>
<td><p>Allowable range of pixel values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient_norm</span></code></a></p></td>
<td><p>Optimization gradient's L2 norm over iterations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.image" title="plenoptic.synthesize.mad_competition.MADCompetition.image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code></a></p></td>
<td><p>The reference image for this MAD Competition.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.initial_image" title="plenoptic.synthesize.mad_competition.MADCompetition.initial_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initial_image</span></code></a></p></td>
<td><p>Initial image for MAD Competition.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.losses" title="plenoptic.synthesize.mad_competition.MADCompetition.losses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></a></p></td>
<td><p>Optimization loss over iterations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.mad_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mad_image</span></code></a></p></td>
<td><p>Maximally-differentiating image, the parameter we are optimizing.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda" title="plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metric_tradeoff_lambda</span></code></a></p></td>
<td><p>Tradeoff between the two metrics in synthesis loss.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.minmax" title="plenoptic.synthesize.mad_competition.MADCompetition.minmax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">minmax</span></code></a></p></td>
<td><p>Whether we are minimizing or maximizing <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimized_metric</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimized_metric</span></code></a></p></td>
<td><p>The metric whose value we are minimizing or maximizing.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric_loss" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimized_metric_loss</span></code></a></p></td>
<td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimized_metric</span></code></a> loss over iterations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimizer" title="plenoptic.synthesize.mad_competition.MADCompetition.optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimizer</span></code></a></p></td>
<td><p>Torch optimizer object which updates the synthesis target.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a></p></td>
<td><p>L2 norm change in pixel values over iterations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda" title="plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda"><code class="xref py py-obj docutils literal notranslate"><span class="pre">range_penalty_lambda</span></code></a></p></td>
<td><p>Magnitude of the penalty on pixel values outside <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.allowed_range" title="plenoptic.synthesize.mad_competition.MADCompetition.allowed_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_range</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reference_metric</span></code></a></p></td>
<td><p>The metric whose value we are keeping constant.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric_loss" title="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reference_metric_loss</span></code></a></p></td>
<td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reference_metric</span></code></a> loss over iterations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saved_mad_image</span></code></a></p></td>
<td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mad_image</span></code></a>, cached over time for later examination.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.scheduler" title="plenoptic.synthesize.mad_competition.MADCompetition.scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scheduler</span></code></a></p></td>
<td><p>Learning rate scheduler which adjusts optimizer learning rate.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.store_progress" title="plenoptic.synthesize.mad_competition.MADCompetition.store_progress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_progress</span></code></a></p></td>
<td><p>How often we are caching progress.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.get_progress">
<span class="sig-name descname"><span class="pre">get_progress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'round'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition.get_progress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.get_progress" title="Link to this definition"></a></dt>
<dd><p>Return dictionary summarizing synthesis progress at <code class="docutils literal notranslate"><span class="pre">iteration</span></code>.</p>
<p>This returns a dictionary containing info from <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.losses" title="plenoptic.synthesize.mad_competition.MADCompetition.losses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">losses</span></code></a>,
<a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a>, <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient_norm</span></code></a>, and
<a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_mad_image</span></code></a> corresponding to <code class="docutils literal notranslate"><span class="pre">iteration</span></code>. If synthesis was
run with <code class="docutils literal notranslate"><span class="pre">store_progress=False</span></code> (and so we did not cache anything in
<a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_mad_image</span></code></a>), then that key will be missing. If synthesis was
run with <code class="docutils literal notranslate"><span class="pre">store_progress&gt;1</span></code>, we will grab the corresponding tensor
from <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_mad_image</span></code></a>, with behavior determined by
<code class="docutils literal notranslate"><span class="pre">iteration_selection</span></code>.</p>
<p>The returned dictionary will additionally contain the keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;iteration&quot;</span></code>: the (0-indexed positive) synthesis iteration that the
values for <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.losses" title="plenoptic.synthesize.mad_competition.MADCompetition.losses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">losses</span></code></a>, <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a>, and
<a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient_norm</span></code></a> come from.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">self.store_progress</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;store_progress_iteration&quot;</span></code>: the (0-indexed
positive) synthesis iteration that the value for <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_mad_image</span></code></a> comes
from.</p></li>
</ul>
<p>Note that for the most recent iteration (<code class="docutils literal notranslate"><span class="pre">iteration=-1</span></code> or <code class="docutils literal notranslate"><span class="pre">iteration=None</span></code>
or <code class="docutils literal notranslate"><span class="pre">iteration==len(self.losses)-1</span></code>), we do not have values for
<a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm" title="plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient_norm</span></code></a>, since in this case we are
showing the loss and value for the current MAD image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Synthesis iteration to summarize. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, grab the most recent.
Negative values are allowed.</p></li>
<li><p><strong>iteration_selection</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'floor'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ceiling'</span></code>, <code class="docutils literal notranslate"><span class="pre">'round'</span></code>]</span> (default: <code class="docutils literal notranslate"><span class="pre">'round'</span></code>)) – <p>How to select the relevant iteration from <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_mad_image</span></code></a>
when the request iteration wasn’t stored.</p>
<p>When synthesis was run with <code class="docutils literal notranslate"><span class="pre">store_progress=n</span></code> (where <code class="docutils literal notranslate"><span class="pre">n&gt;1</span></code>),
MAD images are only saved every <code class="docutils literal notranslate"><span class="pre">n</span></code> iterations. If you request an
iteration where a MAD image wasn’t saved, this determines which available
iteration is used instead:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;floor&quot;</span></code>: use the closest saved iteration <strong>before</strong> the
requested one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ceiling&quot;</span></code>: use the closest saved iteration <strong>after</strong> the
requested one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;round&quot;</span></code>: use the closest saved iteration.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>progress_info</em> – Dictionary summarizing synthesis progress.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IndexError" title="(in Python v3.14)"><strong>IndexError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">iteration</span></code> takes an illegal value.</p>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>UserWarning</strong> – If the iteration used for <code class="docutils literal notranslate"><span class="pre">saved_mad_image</span></code> is not the same as the
argument <code class="docutils literal notranslate"><span class="pre">iteration</span></code> (because e.g., you set <code class="docutils literal notranslate"><span class="pre">iteration=3</span></code> but
<code class="docutils literal notranslate"><span class="pre">self.store_progress=2</span></code>).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_equality_atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_equality_rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pickle_load_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.load" title="Link to this definition"></a></dt>
<dd><p>Load all relevant stuff from a .pt file.</p>
<p>This must be called by a <code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code> object initialized just like the
saved object.</p>
<p>Note this operates in place and so doesn’t return anything.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.2: </span>load behavior changed in a backwards-incompatible manner in order to
compatible with breaking changes in torch 2.6.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The path to load the synthesis object from.</p></li>
<li><p><strong>map_location</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Argument to pass to <code class="docutils literal notranslate"><span class="pre">torch.load</span></code> as <code class="docutils literal notranslate"><span class="pre">map_location</span></code>. If you save
stuff that was being run on a GPU and are loading onto a
CPU, you’ll need this to make sure everything lines up
properly. This should be structured like the str you would
pass to <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.device</span></code></a>.</p></li>
<li><p><strong>tensor_equality_atol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">1e-08</span></code>)) – Absolute tolerance to use when checking for tensor equality during load,
passed to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.allclose.html#torch.allclose" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.allclose</span></code></a>. It may be necessary to increase if you are
saving and loading on two machines with torch built by different cuda
versions. Be careful when changing this! See
<a class="reference external" href="https://docs.pytorch.org/docs/stable/type_info.html#torch.torch.finfo" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.finfo</span></code></a> for more details about floating
point precision of different data types (especially, <code class="docutils literal notranslate"><span class="pre">eps</span></code>); if you have
to increase this by more than 1 or 2 decades, then you are probably not
dealing with a numerical issue.</p></li>
<li><p><strong>tensor_equality_rtol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">1e-05</span></code>)) – Relative tolerance to use when checking for tensor equality during load,
passed to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.allclose.html#torch.allclose" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.allclose</span></code></a>. It may be necessary to increase if you are
saving and loading on two machines with torch built by different cuda
versions. Be careful when changing this! See
<a class="reference external" href="https://docs.pytorch.org/docs/stable/type_info.html#torch.torch.finfo" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.finfo</span></code></a> for more details about floating
point precision of different data types (especially, <code class="docutils literal notranslate"><span class="pre">eps</span></code>); if you have
to increase this by more than 1 or 2 decades, then you are probably not
dealing with a numerical issue.</p></li>
<li><p><strong>**pickle_load_args</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – Any additional kwargs will be added to <code class="docutils literal notranslate"><span class="pre">pickle_module.load</span></code> via
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.load.html#torch.load" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.load</span></code></a>, see that function’s docstring for details.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.setup" title="plenoptic.synthesize.mad_competition.MADCompetition.setup"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.synthesize" title="plenoptic.synthesize.mad_competition.MADCompetition.synthesize"><code class="xref py py-func docutils literal notranslate"><span class="pre">synthesize</span></code></a> has been called before this call
    to <code class="docutils literal notranslate"><span class="pre">load</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the object saved at <code class="docutils literal notranslate"><span class="pre">file_path</span></code> is not a <code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code> object.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the saved and loading <code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code> objects have a different value
    for any of <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.image" title="plenoptic.synthesize.mad_competition.MADCompetition.image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">image</span></code></a>, <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda" title="plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda"><code class="xref py py-attr docutils literal notranslate"><span class="pre">range_penalty_lambda</span></code></a>,
    <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.allowed_range" title="plenoptic.synthesize.mad_competition.MADCompetition.allowed_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_range</span></code></a>, <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda" title="plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_tradeoff_lambda</span></code></a>, or <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.minmax" title="plenoptic.synthesize.mad_competition.MADCompetition.minmax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">minmax</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the behavior of <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimized_metric</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reference_metric</span></code></a> is
    different between the saved and loading objects.</p></li>
</ul>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>UserWarning</strong> – If <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.setup" title="plenoptic.synthesize.mad_competition.MADCompetition.setup"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup</span></code></a> will need to be called after <code class="docutils literal notranslate"><span class="pre">load</span></code>, to finish
initializing <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimizer" title="plenoptic.synthesize.mad_competition.MADCompetition.optimizer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimizer</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.scheduler" title="plenoptic.synthesize.mad_competition.MADCompetition.scheduler"><code class="xref py py-attr docutils literal notranslate"><span class="pre">scheduler</span></code></a>.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plenoptic.tools.io.html#plenoptic.tools.io.examine_saved_synthesis" title="plenoptic.tools.io.examine_saved_synthesis"><code class="xref py py-func docutils literal notranslate"><span class="pre">examine_saved_synthesis</span></code></a></dt><dd><p>Examine metadata from saved object: pytorch and plenoptic versions, name of the synthesis object, shapes of tensors, etc.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span><span class="w"> </span><span class="nf">ds_ssim</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MADCompetition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img</span><span class="p">,</span> <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span> <span class="n">ds_ssim</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">metric_tradeoff_lambda</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">store_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;mad.pt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad_copy</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MADCompetition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img</span><span class="p">,</span> <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span> <span class="n">ds_ssim</span><span class="p">,</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="n">metric_tradeoff_lambda</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad_copy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mad.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.objective_function">
<span class="sig-name descname"><span class="pre">objective_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mad_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition.objective_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.objective_function" title="Link to this definition"></a></dt>
<dd><p>Compute the MADCompetition synthesis loss.</p>
<p>This computes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}t L_1(x, \hat{x}) &amp;+ \lambda_1 [L_2(x, x+\epsilon) - L_2(x, \hat{x})]^2 \\
                  &amp;+ \lambda_2 \mathcal{B}(\hat{x})\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is 1 if <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.minmax" title="plenoptic.synthesize.mad_competition.MADCompetition.minmax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">minmax</span></code></a> is <code class="docutils literal notranslate"><span class="pre">'min'</span></code> and -1 if it’s <code class="docutils literal notranslate"><span class="pre">'max'</span></code>,
<span class="math notranslate nohighlight">\(L_1\)</span> is <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimized_metric</span></code></a>, <span class="math notranslate nohighlight">\(L_2\)</span> is
<a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reference_metric</span></code></a>, <span class="math notranslate nohighlight">\(x\)</span> is <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.image" title="plenoptic.synthesize.mad_competition.MADCompetition.image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">image</span></code></a>, <span class="math notranslate nohighlight">\(\hat{x}\)</span> is
<a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mad_image</span></code></a>, <span class="math notranslate nohighlight">\(\epsilon\)</span> is the initial noise, <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> is
the quadratic bound penalty, <span class="math notranslate nohighlight">\(\lambda_1\)</span> is <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda" title="plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metric_tradeoff_lambda</span></code></a>
and <span class="math notranslate nohighlight">\(\lambda_2\)</span> is <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda" title="plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda"><code class="xref py py-attr docutils literal notranslate"><span class="pre">range_penalty_lambda</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mad_image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Proposed <code class="docutils literal notranslate"><span class="pre">mad_image</span></code>, <span class="math notranslate nohighlight">\(\hat{x}\)</span> in the above equation. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, use <code class="docutils literal notranslate"><span class="pre">self.mad_image</span></code>.</p></li>
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Proposed <code class="docutils literal notranslate"><span class="pre">image</span></code>, <span class="math notranslate nohighlight">\(x\)</span> in the above equation. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, use <code class="docutils literal notranslate"><span class="pre">self.image</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>loss</em> – 1-element tensor containing the loss on this step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.save" title="Link to this definition"></a></dt>
<dd><p>Save all relevant variables in .pt file.</p>
<p>Note that if <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> is True, this will probably be very
large.</p>
<p>See <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.load" title="plenoptic.synthesize.mad_competition.MADCompetition.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load</span></code></a> docstring for an example of use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The path to save the MADCompetition object to.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.setup" title="Link to this definition"></a></dt>
<dd><p>Initialize the MAD image, optimizer, and scheduler.</p>
<p>Can only be called once. If <code class="docutils literal notranslate"><span class="pre">load()</span></code> has been called, <code class="docutils literal notranslate"><span class="pre">initial_noise</span></code> must
be None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_noise</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mad_image</span></code></a> is initialized to <code class="docutils literal notranslate"><span class="pre">self.image</span> <span class="pre">+</span> <span class="pre">initial_noise</span> <span class="pre">*</span>
<span class="pre">torch.randn_like(self.image)</span></code>, so this gives the standard deviation of the
Gaussian noise. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we use a value of 0.1.</p></li>
<li><p><strong>optimizer</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The un-initialized optimizer object to use. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we use Adam.</p></li>
<li><p><strong>optimizer_kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The keyword arguments to pass to the optimizer on initialization. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, we use <code class="docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">.01}</span></code> and, if optimizer is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">{&quot;amsgrad&quot;:</span> <span class="pre">True}</span></code>.</p></li>
<li><p><strong>scheduler</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LRScheduler</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The un-initialized learning rate scheduler object to use. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we
don’t use one.</p></li>
<li><p><strong>scheduler_kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The keyword arguments to pass to the scheduler on initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If you try to set <code class="docutils literal notranslate"><span class="pre">initial_noise</span></code> after calling <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.load" title="plenoptic.synthesize.mad_competition.MADCompetition.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">setup</span></code> is called more than once or after <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.synthesize" title="plenoptic.synthesize.mad_competition.MADCompetition.synthesize"><code class="xref py py-func docutils literal notranslate"><span class="pre">synthesize</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Set initial noise:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MADCompetition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img</span><span class="p">,</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">metric_tradeoff_lambda</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Set optimizer:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MADCompetition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img</span><span class="p">,</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">metric_tradeoff_lambda</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">,</span> <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Use with save/load. Only the optimizer object is necessary, its kwargs and the
initial noise are handled by load.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MADCompetition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img</span><span class="p">,</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">metric_tradeoff_lambda</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">,</span> <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;mad_setup.pt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MADCompetition</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">img</span><span class="p">,</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">ssim</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">po</span><span class="o">.</span><span class="n">metric</span><span class="o">.</span><span class="n">mse</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;min&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">metric_tradeoff_lambda</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mad_setup.pt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mad</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.synthesize">
<span class="sig-name descname"><span class="pre">synthesize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_iters_to_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition.synthesize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.synthesize" title="Link to this definition"></a></dt>
<dd><p>Synthesize a MAD image.</p>
<p>Update the pixels of <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.initial_image" title="plenoptic.synthesize.mad_competition.MADCompetition.initial_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">initial_image</span></code></a> to maximize or minimize
(depending on the value of <code class="docutils literal notranslate"><span class="pre">minmax</span></code>) the value of
<code class="docutils literal notranslate"><span class="pre">optimized_metric(image,</span> <span class="pre">mad_image)</span></code> while keeping the value of
<code class="docutils literal notranslate"><span class="pre">reference_metric(image,</span> <span class="pre">mad_image)</span></code> constant.</p>
<p>We run this until either we reach <code class="docutils literal notranslate"><span class="pre">max_iter</span></code> or the loss changes less than
<code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code> over the past <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> iterations,
whichever comes first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_iter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">100</span></code>)) – The maximum number of iterations to run before we end synthesis
(unless we hit the stop criterion).</p></li>
<li><p><strong>store_progress</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)) – Whether we should store the MAD image in progress during synthesis. If
<code class="docutils literal notranslate"><span class="pre">False</span></code>, we don’t save anything. If True, we save every iteration. If an
int, we save every <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> iterations (note then that <code class="docutils literal notranslate"><span class="pre">0</span></code> is
the same as <code class="docutils literal notranslate"><span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> the same as <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></li>
<li><p><strong>stop_criterion</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">0.0001</span></code>)) – If the loss over the past <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> has changed
less than <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>, we terminate synthesis.</p></li>
<li><p><strong>stop_iters_to_check</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">50</span></code>)) – How many iterations back to check in order to see if the
loss has stopped decreasing (for <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If we find a NaN during optimization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/mad_competition.html#MADCompetition.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.to" title="Link to this definition"></a></dt>
<dd><p>Move and/or casts the parameters and buffers.</p>
<p>This can be called as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">to</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Its signature is similar to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.Tensor.to.html#torch.Tensor.to" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.to</span></code></a>, but only accepts
floating point desired <code class="docutils literal notranslate"><span class="pre">dtype</span></code>. In addition, this method will
only cast the floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">dtype</span></code>
(if given). The integral parameters and buffers will be moved
<code class="docutils literal notranslate"><span class="pre">device</span></code>, if that is given, but with dtypes unchanged. When
<cite>on_blocking`</cite> is set, it tries to convert/move asynchronously
with respect to the host if possible, e.g., moving CPU Tensors with
pinned memory to CUDA devices.</p>
<p>See <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module.to" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.to</span></code></a> for examples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method modifies the module in-place.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>torch.device</em></a>) – The desired device of the parameters and buffers in this module.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><em>torch.dtype</em></a>) – The desired floating point type of the floating point parameters and
buffers in this module.</p></li>
<li><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>torch.Tensor</em></a>) – Tensor whose dtype and device are the desired dtype and device for
all parameters and buffers in this module.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.allowed_range">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">allowed_range</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.allowed_range" title="Link to this definition"></a></dt>
<dd><p>Allowable range of pixel values.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">gradient_norm</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.gradient_norm" title="Link to this definition"></a></dt>
<dd><p>Optimization gradient’s L2 norm over iterations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.image">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">image</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.image" title="Link to this definition"></a></dt>
<dd><p>The reference image for this MAD Competition.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.initial_image">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">initial_image</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.initial_image" title="Link to this definition"></a></dt>
<dd><p>Initial image for MAD Competition.</p>
<p>This is the image whose distance to <code class="docutils literal notranslate"><span class="pre">image</span></code>, the reference, we are
maximizing/minimizing for <code class="docutils literal notranslate"><span class="pre">optimized_metric</span></code>, while keeping constant for
<code class="docutils literal notranslate"><span class="pre">reference_metric</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.losses">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">losses</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.losses" title="Link to this definition"></a></dt>
<dd><p>Optimization loss over iterations.</p>
<p>Will have <code class="docutils literal notranslate"><span class="pre">length=num_iter+1</span></code>, where <code class="docutils literal notranslate"><span class="pre">num_iter</span></code> is the number of
iterations of synthesis run so far.</p>
<p>This tensor always lives on the CPU.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.mad_image">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">mad_image</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.mad_image" title="Link to this definition"></a></dt>
<dd><p>Maximally-differentiating image, the parameter we are optimizing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">metric_tradeoff_lambda</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.metric_tradeoff_lambda" title="Link to this definition"></a></dt>
<dd><p>Tradeoff between the two metrics in synthesis loss.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.minmax">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">minmax</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'min'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'max'</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.minmax" title="Link to this definition"></a></dt>
<dd><p>Whether we are minimizing or maximizing <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimized_metric</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">optimized_metric</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><span class="pre">Module</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="Link to this definition"></a></dt>
<dd><p>The metric whose value we are minimizing or maximizing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric_loss">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">optimized_metric_loss</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric_loss" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.optimized_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimized_metric</span></code></a> loss over iterations.</p>
<p>That is, the value of <code class="docutils literal notranslate"><span class="pre">optimized_metric(image,</span> <span class="pre">mad_image)</span></code>. Ideally, this is
either very different from <code class="docutils literal notranslate"><span class="pre">optimized_metric(image,</span> <span class="pre">initial_image)</span></code>.</p>
<p>This tensor always lives on the CPU, regardless of the device of the
<code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code> object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.optimizer">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">optimizer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.10)"><span class="pre">Optimizer</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.optimizer" title="Link to this definition"></a></dt>
<dd><p>Torch optimizer object which updates the synthesis target.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">pixel_change_norm</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.pixel_change_norm" title="Link to this definition"></a></dt>
<dd><p>L2 norm change in pixel values over iterations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">range_penalty_lambda</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.range_penalty_lambda" title="Link to this definition"></a></dt>
<dd><p>Magnitude of the penalty on pixel values outside <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.allowed_range" title="plenoptic.synthesize.mad_competition.MADCompetition.allowed_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_range</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">reference_metric</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><span class="pre">Module</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric" title="Link to this definition"></a></dt>
<dd><p>The metric whose value we are keeping constant.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric_loss">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">reference_metric_loss</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric_loss" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.reference_metric" title="plenoptic.synthesize.mad_competition.MADCompetition.reference_metric"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reference_metric</span></code></a> loss over iterations.</p>
<p>That is, the value of <code class="docutils literal notranslate"><span class="pre">reference_metric(image,</span> <span class="pre">mad_image)</span></code>. Ideally, this is
equal to <code class="docutils literal notranslate"><span class="pre">reference_metric(image,</span> <span class="pre">initial_image)</span></code>.</p>
<p>This tensor always lives on the CPU, regardless of the device of the
<code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code> object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">saved_mad_image</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.saved_mad_image" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mad_image</span></code></a>, cached over time for later examination.</p>
<p>How often the MAD image is cached is determined by the <code class="docutils literal notranslate"><span class="pre">store_progress</span></code>
argument to the <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.synthesize" title="plenoptic.synthesize.mad_competition.MADCompetition.synthesize"><code class="xref py py-func docutils literal notranslate"><span class="pre">synthesize</span></code></a> function.</p>
<p>The last entry will always be the current <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.mad_image" title="plenoptic.synthesize.mad_competition.MADCompetition.mad_image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mad_image</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">store_progress==1</span></code>, then this corresponds directly to <a class="reference internal" href="#plenoptic.synthesize.mad_competition.MADCompetition.losses" title="plenoptic.synthesize.mad_competition.MADCompetition.losses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">losses</span></code></a>:
<code class="docutils literal notranslate"><span class="pre">losses[i]</span></code> is the error for <code class="docutils literal notranslate"><span class="pre">saved_mad_image[i]</span></code></p>
<p>This tensor always lives on the CPU, regardless of the device of the
<code class="docutils literal notranslate"><span class="pre">MADCompetition</span></code> object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.scheduler">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">scheduler</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.10)"><span class="pre">LRScheduler</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.scheduler" title="Link to this definition"></a></dt>
<dd><p>Learning rate scheduler which adjusts optimizer learning rate.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.mad_competition.MADCompetition.store_progress">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">store_progress</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><a class="headerlink" href="#plenoptic.synthesize.mad_competition.MADCompetition.store_progress" title="Link to this definition"></a></dt>
<dd><p>How often we are caching progress.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, we don’t save anything. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we save every iteration. If
an int, we save every <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> iterations (note then that 0 is the
same as <code class="docutils literal notranslate"><span class="pre">False</span></code> and 1 the same as <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plenoptic.synthesize.eigendistortion.Eigendistortion.html" class="btn btn-neutral float-left" title="plenoptic.synthesize.eigendistortion.Eigendistortion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tips.html" class="btn btn-neutral float-right" title="Tips and Tricks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2025, Plenoptic authors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>