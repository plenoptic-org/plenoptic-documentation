
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>MetamerCTF &#8212; plenoptic 1.3.2.dev304 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d54d67fd" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=69473dd2"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=6dbb43f8"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'generated/plenoptic.synthesize.metamer.MetamerCTF';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.plenoptic.org/docs/branch/main/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.3.2';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <script src="../_static/custom-icon.js?v=0bae05a2"></script>
    <link rel="icon" href="../_static/plenoptic.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Eigendistortion" href="plenoptic.synthesize.eigendistortion.Eigendistortion.html" />
    <link rel="prev" title="Metamer" href="plenoptic.synthesize.metamer.Metamer.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.3.2" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/Plenoptic_Logo_CMYK_Full_Wide.svg" class="logo__image only-light" alt="plenoptic 1.3.2.dev304 documentation - Home"/>
    <img src="../_static/Plenoptic_Logo_CMYK_Full_DarkMode_Wide.svg" class="logo__image only-dark pst-js-only" alt="plenoptic 1.3.2.dev304 documentation - Home"/>
  
  
</a></div>
    
      <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://github.com/plenoptic-org/plenoptic/releases">
    Changelog
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../developers/index.html">
    For developers
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://plenoptic.org" title="Home" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-house fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Home</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/plenoptic-org/plenoptic" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/plenoptic" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../reference/index.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/plenoptic-org/plenoptic/releases">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers/index.html">
    For developers
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://plenoptic.org" title="Home" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-house fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Home</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/plenoptic-org/plenoptic" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/plenoptic" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../api.html" class="nav-link">API</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">MetamerCTF</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="metamerctf">
<h1>MetamerCTF<a class="headerlink" href="#metamerctf" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">MetamerCTF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;function</span> <span class="pre">mse&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_penalty_lambda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coarse_to_fine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'together'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/metamer.html#MetamerCTF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF" title="Link to this definition">#</a></dt>
<dd><p>Synthesize model metamers with coarse-to-fine synthesis.</p>
<p>This is a special case of <code class="docutils literal notranslate"><span class="pre">Metamer</span></code>, which uses the coarse-to-fine
synthesis procedure described in <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>: we start by updating metamer with
respect to only a subset of the model’s representation (generally, that
which corresponds to the lowest spatial frequencies), and changing which
subset we consider over the course of synthesis. This is similar to
optimizing with a blurred version of the objective function and gradually
adding in finer details. It improves synthesis performance for some models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span>) – A tensor, this is the image whose representation we wish to
match.</p></li>
<li><p><strong>model</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></span>) – A visual model.</p></li>
<li><p><strong>loss_function</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">&lt;function</span> <span class="pre">mse</span> <span class="pre">at</span> <span class="pre">0x7f330290ba60&gt;</span></code>)) – The loss function to use to compare the representations of the models
in order to determine their loss.</p></li>
<li><p><strong>range_penalty_lambda</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">0.1</span></code>)) – Strength of the regularizer that enforces the allowed_range. Must be
non-negative.</p></li>
<li><p><strong>allowed_range</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span> (default: <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1)</span></code>)) – Range (inclusive) of allowed pixel values. Any values outside this
range will be penalized.</p></li>
<li><p><strong>coarse_to_fine</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'together'</span></code>, <code class="docutils literal notranslate"><span class="pre">'separate'</span></code>]</span> (default: <code class="docutils literal notranslate"><span class="pre">'together'</span></code>)) – <ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;together&quot;</span></code>: start with the coarsest scale, then gradually
add each finer scale.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;separate&quot;</span></code>: compute the gradient with respect to each
scale separately (ignoring the others), then with respect
to all of them at the end.</p></li>
</ul>
<p>(see <a class="reference internal" href="../user_guide/synthesis/Metamer.html#metamer-nb"><span class="std std-ref">Metamer tutorial</span></a> for more details).</p>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>J Portilla and E P Simoncelli. A Parametric Texture Model
based on Joint Statistics of Complex Wavelet Coefficients. Int’l
Journal of Computer Vision. 40(1):49-71, October, 2000.
<a class="reference external" href="https://www.cns.nyu.edu/~eero/ABSTRACTS/portilla99-abstract.html">https://www.cns.nyu.edu/~eero/ABSTRACTS/portilla99-abstract.html</a>
<a class="reference external" href="https://www.cns.nyu.edu/~lcv/texture/">https://www.cns.nyu.edu/~lcv/texture/</a></p>
</aside>
</aside>
<p class="rubric">Examples</p>
<p>Synthesize and visualize a metamer using coarse-to-fine synthesis:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reptile_skin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">PortillaSimoncelli</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># to work with MetamerCTF, models must have a scales attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">scales</span>
<span class="go">[&#39;pixel_statistics&#39;, &#39;residual_lowpass&#39;, 3, 2, 1, 0, &#39;residual_highpass&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_function</span><span class="o">=</span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">l2_norm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># initialize with an image that has a comparable mean and standard deviation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_img</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="n">img</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">init_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="n">change_scale_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctf_iters_to_check</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Target image&quot;</span><span class="p">)</span>
<span class="go">&lt;Figure size ... with 4 Axes&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">metamer</span><span class="o">.</span><span class="n">plot_synthesis_status</span><span class="p">(</span><span class="n">met</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes_idx</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;misc&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Figure size ...&gt;</span>
</pre></div>
</div>
<p>(<a class="reference download internal" download="" href="../_downloads/e32f7ef935a4277fb7f96d3fe54a705b/plenoptic-synthesize-metamer-MetamerCTF-1.png"><code class="xref download docutils literal notranslate"><span class="pre">png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/39a300928134e9a91cc59074ee70796b/plenoptic-synthesize-metamer-MetamerCTF-1.hires.png"><code class="xref download docutils literal notranslate"><span class="pre">hires.png</span></code></a>, <a class="reference download internal" download="" href="../_downloads/dbc864b1772cda29a9225c48ea06d0af/plenoptic-synthesize-metamer-MetamerCTF-1.pdf"><code class="xref download docutils literal notranslate"><span class="pre">pdf</span></code></a>)</p>
<figure class="align-default">
<img alt="../_images/plenoptic-synthesize-metamer-MetamerCTF-1.png" class="plot-directive" src="../_images/plenoptic-synthesize-metamer-MetamerCTF-1.png" />
</figure>
<p>Not all models work with <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">remove_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">AttributeError</span>: <span class="n">model has no scales attribute ...</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.get_progress" title="plenoptic.synthesize.metamer.MetamerCTF.get_progress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_progress</span></code></a>(iteration[, iteration_selection])</p></td>
<td><p>Return dictionary summarizing synthesis progress at <code class="docutils literal notranslate"><span class="pre">iteration</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.load" title="plenoptic.synthesize.metamer.MetamerCTF.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(file_path[, map_location, ...])</p></td>
<td><p>Load all relevant stuff from a .pt file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.objective_function" title="plenoptic.synthesize.metamer.MetamerCTF.objective_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">objective_function</span></code></a>([metamer, ...])</p></td>
<td><p>Compute the metamer synthesis loss.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.save" title="plenoptic.synthesize.metamer.MetamerCTF.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(file_path)</p></td>
<td><p>Save all relevant variables in .pt file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.setup" title="plenoptic.synthesize.metamer.MetamerCTF.setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setup</span></code></a>([initial_image, optimizer, ...])</p></td>
<td><p>Initialize the metamer, optimizer, and scheduler.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.synthesize" title="plenoptic.synthesize.metamer.MetamerCTF.synthesize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">synthesize</span></code></a>([max_iter, store_progress, ...])</p></td>
<td><p>Synthesize a metamer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.to" title="plenoptic.synthesize.metamer.MetamerCTF.to"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code></a>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Attributes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.allowed_range" title="plenoptic.synthesize.metamer.MetamerCTF.allowed_range"><code class="xref py py-obj docutils literal notranslate"><span class="pre">allowed_range</span></code></a></p></td>
<td><p>Allowable range of pixel values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.coarse_to_fine" title="plenoptic.synthesize.metamer.MetamerCTF.coarse_to_fine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coarse_to_fine</span></code></a></p></td>
<td><p>How we scales are handled, see <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF" title="plenoptic.synthesize.metamer.MetamerCTF"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetamerCTF</span></code></a> for details.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.gradient_norm" title="plenoptic.synthesize.metamer.MetamerCTF.gradient_norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient_norm</span></code></a></p></td>
<td><p>Optimization gradient's L2 norm over iterations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.image" title="plenoptic.synthesize.metamer.MetamerCTF.image"><code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code></a></p></td>
<td><p>Target image of metamer optimization.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.losses" title="plenoptic.synthesize.metamer.MetamerCTF.losses"><code class="xref py py-obj docutils literal notranslate"><span class="pre">losses</span></code></a></p></td>
<td><p>Optimization loss over iterations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.metamer" title="plenoptic.synthesize.metamer.MetamerCTF.metamer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metamer</span></code></a></p></td>
<td><p>Model metamer, the parameter we are optimizing.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.model" title="plenoptic.synthesize.metamer.MetamerCTF.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a></p></td>
<td><p>The model for which the metamer is synthesized.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.optimizer" title="plenoptic.synthesize.metamer.MetamerCTF.optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optimizer</span></code></a></p></td>
<td><p>Torch optimizer object which updates the synthesis target.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm" title="plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a></p></td>
<td><p>L2 norm change in pixel values over iterations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.range_penalty_lambda" title="plenoptic.synthesize.metamer.MetamerCTF.range_penalty_lambda"><code class="xref py py-obj docutils literal notranslate"><span class="pre">range_penalty_lambda</span></code></a></p></td>
<td><p>Magnitude of the penalty on pixel values outside <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.allowed_range" title="plenoptic.synthesize.metamer.MetamerCTF.allowed_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_range</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.saved_metamer" title="plenoptic.synthesize.metamer.MetamerCTF.saved_metamer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">saved_metamer</span></code></a></p></td>
<td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.metamer" title="plenoptic.synthesize.metamer.MetamerCTF.metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metamer</span></code></a>, cached over time for later examination.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.scales" title="plenoptic.synthesize.metamer.MetamerCTF.scales"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scales</span></code></a></p></td>
<td><p>Model scales that we've yet to optimize, modified during optimization.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.scales_finished" title="plenoptic.synthesize.metamer.MetamerCTF.scales_finished"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scales_finished</span></code></a></p></td>
<td><p>Model scales that we've finished optimizing, modified during optimization.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.scales_loss" title="plenoptic.synthesize.metamer.MetamerCTF.scales_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scales_loss</span></code></a></p></td>
<td><p>Scale-specific loss at each iteration.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.scales_timing" title="plenoptic.synthesize.metamer.MetamerCTF.scales_timing"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scales_timing</span></code></a></p></td>
<td><p>Information about when each scale was started and stopped.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.scheduler" title="plenoptic.synthesize.metamer.MetamerCTF.scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scheduler</span></code></a></p></td>
<td><p>Learning rate scheduler which adjusts optimizer learning rate.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.store_progress" title="plenoptic.synthesize.metamer.MetamerCTF.store_progress"><code class="xref py py-obj docutils literal notranslate"><span class="pre">store_progress</span></code></a></p></td>
<td><p>How often we are caching progress.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.target_representation" title="plenoptic.synthesize.metamer.MetamerCTF.target_representation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">target_representation</span></code></a></p></td>
<td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.model" title="plenoptic.synthesize.metamer.MetamerCTF.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code></a> representation of <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.image" title="plenoptic.synthesize.metamer.MetamerCTF.image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">image</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.loss_function" title="plenoptic.synthesize.metamer.MetamerCTF.loss_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">loss_function</span></code></a></p></td>
<td><p>Callable which specifies how close metamer representation is to target.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.get_progress">
<span class="sig-name descname"><span class="pre">get_progress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iteration_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'round'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.get_progress" title="Link to this definition">#</a></dt>
<dd><p>Return dictionary summarizing synthesis progress at <code class="docutils literal notranslate"><span class="pre">iteration</span></code>.</p>
<p>This returns a dictionary containing info from <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.losses" title="plenoptic.synthesize.metamer.MetamerCTF.losses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">losses</span></code></a>,
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm" title="plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a>, <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.gradient_norm" title="plenoptic.synthesize.metamer.MetamerCTF.gradient_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient_norm</span></code></a>, and
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.saved_metamer" title="plenoptic.synthesize.metamer.MetamerCTF.saved_metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_metamer</span></code></a> corresponding to <code class="docutils literal notranslate"><span class="pre">iteration</span></code>. If synthesis was
run with <code class="docutils literal notranslate"><span class="pre">store_progress=False</span></code> (and so we did not cache anything in
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.saved_metamer" title="plenoptic.synthesize.metamer.MetamerCTF.saved_metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_metamer</span></code></a>), then that key will be missing. If synthesis was
run with <code class="docutils literal notranslate"><span class="pre">store_progress&gt;1</span></code>, we will grab the corresponding tensor
from <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.saved_metamer" title="plenoptic.synthesize.metamer.MetamerCTF.saved_metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_metamer</span></code></a>, with behavior determined by
<code class="docutils literal notranslate"><span class="pre">iteration_selection</span></code>.</p>
<p>The returned dictionary will additionally contain the keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;iteration&quot;</span></code>: the (0-indexed positive) synthesis iteration that the
values for <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.losses" title="plenoptic.synthesize.metamer.MetamerCTF.losses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">losses</span></code></a>, <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm" title="plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a>, and
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.gradient_norm" title="plenoptic.synthesize.metamer.MetamerCTF.gradient_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient_norm</span></code></a> come from.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">self.store_progress</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;store_progress_iteration&quot;</span></code>: the (0-indexed
positive) synthesis iteration that the value for <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.saved_metamer" title="plenoptic.synthesize.metamer.MetamerCTF.saved_metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_metamer</span></code></a> comes
from.</p></li>
</ul>
<p>Note that for the most recent iteration (<code class="docutils literal notranslate"><span class="pre">iteration=-1</span></code> or <code class="docutils literal notranslate"><span class="pre">iteration=None</span></code>
or <code class="docutils literal notranslate"><span class="pre">iteration==len(self.losses)-1</span></code>), we do not have values for
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm" title="plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pixel_change_norm</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.gradient_norm" title="plenoptic.synthesize.metamer.MetamerCTF.gradient_norm"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient_norm</span></code></a>, since in this case we are
showing the loss and value for the current metamer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Synthesis iteration to summarize. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, grab the most recent.
Negative values are allowed.</p></li>
<li><p><strong>iteration_selection</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code></a>[<code class="docutils literal notranslate"><span class="pre">'floor'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ceiling'</span></code>, <code class="docutils literal notranslate"><span class="pre">'round'</span></code>]</span> (default: <code class="docutils literal notranslate"><span class="pre">'round'</span></code>)) – <p>How to select the relevant iteration from <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.saved_metamer" title="plenoptic.synthesize.metamer.MetamerCTF.saved_metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">saved_metamer</span></code></a>
when the request iteration wasn’t stored.</p>
<p>When synthesis was run with <code class="docutils literal notranslate"><span class="pre">store_progress=n</span></code> (where <code class="docutils literal notranslate"><span class="pre">n&gt;1</span></code>),
metamers are only saved every <code class="docutils literal notranslate"><span class="pre">n</span></code> iterations. If you request an
iteration where a metamer wasn’t saved, this determines which available
iteration is used instead:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;floor&quot;</span></code>: use the closest saved iteration <strong>before</strong> the
requested one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ceiling&quot;</span></code>: use the closest saved iteration <strong>after</strong> the
requested one.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;round&quot;</span></code>: use the closest saved iteration.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>progress_info</em> – Dictionary summarizing synthesis progress.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IndexError" title="(in Python v3.14)"><strong>IndexError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">iteration</span></code> takes an illegal value.</p>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>UserWarning</strong> – If the iteration used for <code class="docutils literal notranslate"><span class="pre">saved_metamer</span></code> is not the same as the argument
<code class="docutils literal notranslate"><span class="pre">iteration</span></code> (because e.g., you set <code class="docutils literal notranslate"><span class="pre">iteration=3</span></code> but
<code class="docutils literal notranslate"><span class="pre">self.store_progress=2</span></code>).</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plenoptic.synthesize.metamer.html#plenoptic.synthesize.metamer.plot_synthesis_status" title="plenoptic.synthesize.metamer.plot_synthesis_status"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_synthesis_status</span></code></a></dt><dd><p>Create a plot summarizing synthesis status at a given iteration.</p>
</dd>
<dt><a class="reference internal" href="plenoptic.synthesize.metamer.html#plenoptic.synthesize.metamer.animate" title="plenoptic.synthesize.metamer.animate"><code class="xref py py-func docutils literal notranslate"><span class="pre">animate</span></code></a></dt><dd><p>Create a video of the metamer changing over the course of synthesis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">remove_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Get values from the first iteration:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{&#39;losses&#39;: tensor(0.0194),</span>
<span class="go">&#39;iteration&#39;: 0,</span>
<span class="go">&#39;pixel_change_norm&#39;: tensor(2.5326),</span>
<span class="go">&#39;gradient_norm&#39;: tensor(0.0010)}</span>
</pre></div>
</div>
<p>Get values from most last iteration of synthesis:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">{&#39;losses&#39;: tensor(0.0145),</span>
<span class="go">&#39;iteration&#39;: 4,</span>
<span class="go">&#39;pixel_change_norm&#39;: tensor(2.2698),</span>
<span class="go">&#39;gradient_norm&#39;: tensor(0.0268)}</span>
</pre></div>
</div>
<p>Get current values:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">{&#39;losses&#39;: tensor(0.0132),</span>
<span class="go">&#39;iteration&#39;: 5,</span>
<span class="go">&#39;pixel_change_norm&#39;: None,</span>
<span class="go">&#39;gradient_norm&#39;: None}</span>
</pre></div>
</div>
<p>When synthesis is run with <code class="docutils literal notranslate"><span class="pre">store_progress=True</span></code>, this function also
returns the metamer from the corresponding iteration:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">store_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">{&#39;losses&#39;: tensor(0.0124),</span>
<span class="go">&#39;iteration&#39;: 5,</span>
<span class="go">&#39;pixel_change_norm&#39;: None,</span>
<span class="go">&#39;gradient_norm&#39;: None,</span>
<span class="go">&#39;saved_metamer&#39;: tensor([[[[0.4554, ...]]]], grad_fn=&lt;SelectBackward0&gt;),</span>
<span class="go">&#39;store_progress_iteration&#39;: 5}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="s2">&quot;saved_metamer&quot;</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When synthesis is run with <code class="docutils literal notranslate"><span class="pre">store_progress&gt;1</span></code>, this function returns the
metamer from the closest iteration:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">store_progress</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="go">{&#39;losses&#39;: tensor(0.0152),</span>
<span class="go">&#39;iteration&#39;: 3,</span>
<span class="go">&#39;pixel_change_norm&#39;: tensor(2.3592),</span>
<span class="go">&#39;gradient_norm&#39;: tensor(0.0269),</span>
<span class="go">&#39;saved_metamer&#39;: tensor([[[[0.8532, ...]]]], grad_fn=&lt;SelectBackward0&gt;),</span>
<span class="go">&#39;store_progress_iteration&#39;: 4}</span>
</pre></div>
</div>
<p>When we cannot grab the saved metamer corresponding to the requested
iteration, <code class="docutils literal notranslate"><span class="pre">iteration_selection</span></code> controls how we determine “closest”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">iteration_selection</span><span class="o">=</span><span class="s2">&quot;floor&quot;</span><span class="p">))</span>
<span class="go">{&#39;losses&#39;: tensor(0.0152),</span>
<span class="go">&#39;iteration&#39;: 3,</span>
<span class="go">&#39;pixel_change_norm&#39;: tensor(2.3592),</span>
<span class="go">&#39;gradient_norm&#39;: tensor(0.0269),</span>
<span class="go">&#39;saved_metamer&#39;: tensor([[[[ 0.8730, ...]]]], grad_fn=&lt;SelectBackward0&gt;),</span>
<span class="go">&#39;store_progress_iteration&#39;: 2}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_equality_atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensor_equality_rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pickle_load_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/metamer.html#MetamerCTF.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.load" title="Link to this definition">#</a></dt>
<dd><p>Load all relevant stuff from a .pt file.</p>
<p>This should be called by an initialized <code class="docutils literal notranslate"><span class="pre">Metamer</span></code> object – we will
ensure that <code class="docutils literal notranslate"><span class="pre">image</span></code>, <code class="docutils literal notranslate"><span class="pre">target_representation</span></code> (and thus
<code class="docutils literal notranslate"><span class="pre">model</span></code>), and <code class="docutils literal notranslate"><span class="pre">loss_function</span></code> are all identical.</p>
<p>Note this operates in place and so doesn’t return anything.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The path to load the synthesis object from.</p></li>
<li><p><strong>map_location</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Argument to pass to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.load.html#torch.load" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.load</span></code></a> as <code class="docutils literal notranslate"><span class="pre">map_location</span></code>. If you
save stuff that was being run on a GPU and are loading onto a
CPU, you’ll need this to make sure everything lines up
properly. This should be structured like the str you would
pass to <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.device</span></code></a>.</p></li>
<li><p><strong>tensor_equality_atol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">1e-08</span></code>)) – Absolute tolerance to use when checking for tensor equality during load,
passed to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.allclose.html#torch.allclose" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.allclose</span></code></a>. It may be necessary to increase if you are
saving and loading on two machines with torch built by different cuda
versions. Be careful when changing this! See
<a class="reference external" href="https://docs.pytorch.org/docs/stable/type_info.html#torch.torch.finfo" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.finfo</span></code></a> for more details about floating
point precision of different data types (especially, <code class="docutils literal notranslate"><span class="pre">eps</span></code>); if you have
to increase this by more than 1 or 2 decades, then you are probably not
dealing with a numerical issue.</p></li>
<li><p><strong>tensor_equality_rtol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">1e-05</span></code>)) – Relative tolerance to use when checking for tensor equality during load,
passed to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.allclose.html#torch.allclose" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.allclose</span></code></a>. It may be necessary to increase if you are
saving and loading on two machines with torch built by different cuda
versions. Be careful when changing this! See
<a class="reference external" href="https://docs.pytorch.org/docs/stable/type_info.html#torch.torch.finfo" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.finfo</span></code></a> for more details about floating
point precision of different data types (especially, <code class="docutils literal notranslate"><span class="pre">eps</span></code>); if you have
to increase this by more than 1 or 2 decades, then you are probably not
dealing with a numerical issue.</p></li>
<li><p><strong>**pickle_load_args</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – Any additional kwargs will be added to <code class="docutils literal notranslate"><span class="pre">pickle_module.load</span></code> via
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.load.html#torch.load" title="(in PyTorch v2.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.load</span></code></a>, see that function’s docstring for details.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.setup" title="plenoptic.synthesize.metamer.MetamerCTF.setup"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.synthesize" title="plenoptic.synthesize.metamer.MetamerCTF.synthesize"><code class="xref py py-func docutils literal notranslate"><span class="pre">synthesize</span></code></a> has been called before this call
    to <code class="docutils literal notranslate"><span class="pre">load</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the object saved at <code class="docutils literal notranslate"><span class="pre">file_path</span></code> is not a <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code> object.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the saved and loading <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code> objects have a different value
    for any of <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.image" title="plenoptic.synthesize.metamer.MetamerCTF.image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">image</span></code></a>, <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.range_penalty_lambda" title="plenoptic.synthesize.metamer.MetamerCTF.range_penalty_lambda"><code class="xref py py-attr docutils literal notranslate"><span class="pre">range_penalty_lambda</span></code></a>,
    <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.allowed_range" title="plenoptic.synthesize.metamer.MetamerCTF.allowed_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_range</span></code></a>, or <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.coarse_to_fine" title="plenoptic.synthesize.metamer.MetamerCTF.coarse_to_fine"><code class="xref py py-attr docutils literal notranslate"><span class="pre">coarse_to_fine</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the behavior of <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.loss_function" title="plenoptic.synthesize.metamer.MetamerCTF.loss_function"><code class="xref py py-attr docutils literal notranslate"><span class="pre">loss_function</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.model" title="plenoptic.synthesize.metamer.MetamerCTF.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code></a> is different
    between the saved and loading objects.</p></li>
</ul>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>UserWarning</strong> – If <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.setup" title="plenoptic.synthesize.metamer.MetamerCTF.setup"><code class="xref py py-func docutils literal notranslate"><span class="pre">setup</span></code></a> will need to be called after load, to finish initializing
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.optimizer" title="plenoptic.synthesize.metamer.MetamerCTF.optimizer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">optimizer</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.scheduler" title="plenoptic.synthesize.metamer.MetamerCTF.scheduler"><code class="xref py py-attr docutils literal notranslate"><span class="pre">scheduler</span></code></a>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>In order to load a saved <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code> object, we must first initialize one
using the same arguments. (We use float64 / “double” precision rather than
torch’s default float32 because it increases reproducibility, see the
<a class="reference internal" href="../reference/reproducibility.html#reproduce"><span class="std std-ref">Reproducibility</span></a> page of our documentations for more details.)
Here, we load in a cached example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reptile_skin</span><span class="p">()</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">PortillaSimoncelli</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">l2_norm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">metamer</span><span class="p">)</span>
<span class="go">tensor([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="s2">&quot;example_metamerCTF_ps.pt&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">metamer</span><span class="p">)</span>
<span class="go">tensor([[[[0.3016, ...]]]], dtype=torch.float64, requires_grad=True)</span>
</pre></div>
</div>
<p>If the saved <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code> object lived on a CUDA device and you do not have
CUDA on the loading machine, use <code class="docutils literal notranslate"><span class="pre">map_location</span></code> to change device:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">l2_norm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">device</span>
<span class="go">device(type=&#39;cpu&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="s2">&quot;example_metamerCTF_ps-cuda.pt&quot;</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">RuntimeError</span>: <span class="n">Attempting to deserialize object on a CUDA device but</span>
<span class="x">torch.cuda.is_available() is False...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">load</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="s2">&quot;example_metamerCTF_ps-cuda.pt&quot;</span><span class="p">),</span> <span class="n">map_location</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">metamer</span><span class="p">)</span>
<span class="go">tensor([[[[0.3016, ...]]]], dtype=torch.float64, requires_grad=True)</span>
</pre></div>
</div>
<p>Loading and saving must both be done with <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="s2">&quot;example_metamerCTF_ps.pt&quot;</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">ValueError</span>: <span class="n">Saved object was a plenoptic.synthesize.metamer.MetamerCTF...</span>
</pre></div>
</div>
<p>If the loading <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code> object was not initialized with same values
as the saved object, an error will be raised:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">torch</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">model</span><span class="p">,</span> <span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">l2_norm</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="s2">&quot;example_metamerCTF_ps.pt&quot;</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">ValueError</span>: <span class="n">Saved and initialized attribute image have different values...</span>
</pre></div>
</div>
<p>If the loading <code class="docutils literal notranslate"><span class="pre">MetamerCTF</span></code> object has a different data type than the saved
object, an error will be raised:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">l2_norm</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="s2">&quot;example_metamerCTF_ps.pt&quot;</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">ValueError</span>: <span class="n">Saved and initialized attribute image have different dtype...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.objective_function">
<span class="sig-name descname"><span class="pre">objective_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metamer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_representation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">analyze_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.objective_function" title="Link to this definition">#</a></dt>
<dd><p>Compute the metamer synthesis loss.</p>
<p>This calls self.loss_function on
<code class="docutils literal notranslate"><span class="pre">self.model(metamer,</span> <span class="pre">**analyze_kwargs)</span></code> and
<code class="docutils literal notranslate"><span class="pre">target_representation</span></code> and then adds the weighted range penalty
on <code class="docutils literal notranslate"><span class="pre">metamer</span></code>.</p>
<p>Its output over time is stored in <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.losses" title="plenoptic.synthesize.metamer.MetamerCTF.losses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">losses</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metamer</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Current <code class="docutils literal notranslate"><span class="pre">metamer</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we use <code class="docutils literal notranslate"><span class="pre">self.metamer</span></code>.</p></li>
<li><p><strong>target_representation</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – Model response to <code class="docutils literal notranslate"><span class="pre">image</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we use
<code class="docutils literal notranslate"><span class="pre">self.target_representation</span></code>.</p></li>
<li><p><strong>**analyze_kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a></span>) – Additional kwargs to pass to <code class="docutils literal notranslate"><span class="pre">self.model(metamer)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>loss</em> – 1-element tensor containing the loss on this step.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">remove_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p>Before <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.setup" title="plenoptic.synthesize.metamer.MetamerCTF.setup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup</span></code></a> or <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.synthesize" title="plenoptic.synthesize.metamer.MetamerCTF.synthesize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">synthesize</span></code></a> is called, this returns an
empty tensor because the metamer attribute hasn’t been initialized:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">objective_function</span><span class="p">()</span>
<span class="go">tensor([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">store_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>When called without any arguments, this returns the current loss:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">objective_function</span><span class="p">()</span>
<span class="go">tensor(0.0132, grad_fn=&lt;AddBackward0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">losses</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">tensor(0.0132)</span>
</pre></div>
</div>
<p>Can be called with a different image. (Note that, because we called
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.synthesize" title="plenoptic.synthesize.metamer.MetamerCTF.synthesize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">synthesize</span></code></a> with <code class="docutils literal notranslate"><span class="pre">store_progress=True</span></code>, we cached the metamer
over the course of synthesis):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">objective_function</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">tensor(0.0194, grad_fn=&lt;AddBackward0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">losses</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">tensor(0.0194)</span>
</pre></div>
</div>
<p>This method differs from the <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.loss_function" title="plenoptic.synthesize.metamer.MetamerCTF.loss_function"><code class="xref py py-attr docutils literal notranslate"><span class="pre">loss_function</span></code></a> attribute because of its
inclusion of the penalty. In the following block, the pixels of
<code class="docutils literal notranslate"><span class="pre">rand_img</span></code> all lie within $[0, 1]$, and so the outputs of
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.objective_function" title="plenoptic.synthesize.metamer.MetamerCTF.objective_function"><code class="xref py py-attr docutils literal notranslate"><span class="pre">objective_function</span></code></a> and <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.loss_function" title="plenoptic.synthesize.metamer.MetamerCTF.loss_function"><code class="xref py py-attr docutils literal notranslate"><span class="pre">loss_function</span></code></a> are the same:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rand_img</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand_like</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rand_img</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rand_img</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">(tensor(7.9870e-06), tensor(1.0000))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">objective_function</span><span class="p">(</span><span class="n">rand_img</span><span class="p">)</span>
<span class="go">tensor(0.0190)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">loss_function</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">model</span><span class="p">(</span><span class="n">rand_img</span><span class="p">))</span>
<span class="go">tensor(0.0190)</span>
</pre></div>
</div>
<p>In this block, the image’s lie outside $[0, 1]$, and so the outputs of
<a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.objective_function" title="plenoptic.synthesize.metamer.MetamerCTF.objective_function"><code class="xref py py-attr docutils literal notranslate"><span class="pre">objective_function</span></code></a> and <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.loss_function" title="plenoptic.synthesize.metamer.MetamerCTF.loss_function"><code class="xref py py-attr docutils literal notranslate"><span class="pre">loss_function</span></code></a> are different:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rand_img</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rand_img</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">rand_img</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">(tensor(0.0001), tensor(2.0000))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">objective_function</span><span class="p">(</span><span class="n">rand_img</span><span class="p">)</span>
<span class="go">tensor(1100.9663)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">loss_function</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">model</span><span class="p">(</span><span class="n">rand_img</span><span class="p">))</span>
<span class="go">tensor(0.3133)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.save" title="Link to this definition">#</a></dt>
<dd><p>Save all relevant variables in .pt file.</p>
<p>Note that if <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> is True, this will probably be very
large.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_path</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – The path to save the metamer object to.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.load" title="plenoptic.synthesize.metamer.MetamerCTF.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a></dt><dd><p>Method to load in saved <code class="docutils literal notranslate"><span class="pre">Metamer</span></code> objects.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">remove_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">store_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;metamers.pt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_image</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.setup" title="Link to this definition">#</a></dt>
<dd><p>Initialize the metamer, optimizer, and scheduler.</p>
<p>Can only be called once. If <code class="docutils literal notranslate"><span class="pre">load()</span></code> has been called, <code class="docutils literal notranslate"><span class="pre">initial_image</span></code> must
be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_image</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The tensor we use to initialize the metamer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we initialize with
uniformly-distributed random noise lying within <code class="docutils literal notranslate"><span class="pre">self.allowed_range</span></code>.</p></li>
<li><p><strong>optimizer</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The un-initialized optimizer object to use. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we use
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.Adam.html#torch.optim.Adam" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.Adam</span></code></a>.</p></li>
<li><p><strong>optimizer_kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The keyword arguments to pass to the optimizer on initialization. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, we use <code class="docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">.01}</span></code> and, if optimizer is <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">{&quot;amsgrad&quot;:</span> <span class="pre">True}</span></code>.</p></li>
<li><p><strong>scheduler</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LRScheduler</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The un-initialized learning rate scheduler object to use. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we
don’t use one.</p></li>
<li><p><strong>scheduler_kwargs</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)) – The keyword arguments to pass to the scheduler on initialization.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If you try to set <code class="docutils literal notranslate"><span class="pre">initial_image</span></code> after calling <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.load" title="plenoptic.synthesize.metamer.MetamerCTF.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">setup</span></code> is called more than once or after <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.synthesize" title="plenoptic.synthesize.metamer.MetamerCTF.synthesize"><code class="xref py py-func docutils literal notranslate"><span class="pre">synthesize</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If you try to set <code class="docutils literal notranslate"><span class="pre">optimizer_kwargs</span></code> after calling <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.load" title="plenoptic.synthesize.metamer.MetamerCTF.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.14)"><strong>TypeError</strong></a> – If the loaded object had a non-Adam optimizer, but the <code class="docutils literal notranslate"><span class="pre">optimizer</span></code> arg
    is not specified.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the loaded object had an optimizer, and the <code class="docutils literal notranslate"><span class="pre">optimizer</span></code> arg is
    a different type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If you try to set <code class="docutils literal notranslate"><span class="pre">scheduler_kwargs</span></code> after calling <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.load" title="plenoptic.synthesize.metamer.MetamerCTF.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">load</span></code></a>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.14)"><strong>TypeError</strong></a> – If the loaded object had a scheduler, but the <code class="docutils literal notranslate"><span class="pre">scheduler</span></code> arg is not
    specified.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the loaded object had a scheduler, but the <code class="docutils literal notranslate"><span class="pre">scheduler</span></code> arg is
    a different type.</p></li>
</ul>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>UserWarning</strong> – If <code class="docutils literal notranslate"><span class="pre">initial_image</span></code> is a different shape than <code class="docutils literal notranslate"><span class="pre">self.image</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Set initial image:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">remove_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">curie</span><span class="p">())</span>
</pre></div>
</div>
<p>Set optimizer:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">,</span> <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">})</span>
</pre></div>
</div>
<p>Set optimizer and scheduler:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">scheduler</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>Use with save/load. We only pass the optimizer/scheduler objects when calling
setup after load, their kwargs and the initial image are handled during the
load.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">curie</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">optimizer_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">scheduler</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;metamer_setup.pt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;metamer_setup.pt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">optimizer</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">scheduler</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.synthesize">
<span class="sig-name descname"><span class="pre">synthesize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop_iters_to_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_scale_criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf_iters_to_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/metamer.html#MetamerCTF.synthesize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.synthesize" title="Link to this definition">#</a></dt>
<dd><p>Synthesize a metamer.</p>
<p>Update the pixels of <code class="docutils literal notranslate"><span class="pre">metamer</span></code> until its representation matches
that of <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p>
<p>We run this until either we reach <code class="docutils literal notranslate"><span class="pre">max_iter</span></code> or the change over the
past <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> iterations is less than
<code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>, whichever comes first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_iter</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">100</span></code>)) – The maximum number of iterations to run before we end synthesis
(unless we hit the stop criterion).</p></li>
<li><p><strong>store_progress</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)) – Whether we should store the metamer image in progress on every
iteration. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, we don’t save anything. If True, we save every
iteration. If an int, we save every <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> iterations
(note then that 0 is the same as False and 1 the same as True). This is
primarily useful for using
<a class="reference internal" href="plenoptic.synthesize.metamer.html#plenoptic.synthesize.metamer.animate" title="plenoptic.synthesize.metamer.animate"><code class="xref py py-func docutils literal notranslate"><span class="pre">animate</span></code></a> to create a video of the
course of synthesis.</p></li>
<li><p><strong>stop_criterion</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">0.0001</span></code>)) – If the loss over the past <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> has changed
less than <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>, we terminate synthesis.</p></li>
<li><p><strong>stop_iters_to_check</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">50</span></code>)) – How many iterations back to check in order to see if the
loss has stopped decreasing (for <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code>).</p></li>
<li><p><strong>change_scale_criterion</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">0.01</span></code>)) – Scale-specific analogue of <code class="docutils literal notranslate"><span class="pre">change_scale_criterion</span></code>: we consider
a given scale finished (and move onto the next) if the loss has
changed less than this in the past <code class="docutils literal notranslate"><span class="pre">ctf_iters_to_check</span></code>
iterations. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, we’ll change scales as soon as we’ve spent
<code class="docutils literal notranslate"><span class="pre">ctf_iters_to_check</span></code> on a given scale.</p></li>
<li><p><strong>ctf_iters_to_check</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span> (default: <code class="docutils literal notranslate"><span class="pre">50</span></code>)) – Scale-specific analogue of <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code>: how many
iterations back in order to check in order to see if we should
switch scales.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">stop_criterion</span> <span class="pre">&gt;=</span> <span class="pre">change_scale_criterion</span></code> – behavior is strange
    otherwise.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If we find a NaN during optimization.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="plenoptic.synthesize.metamer.html#plenoptic.synthesize.metamer.plot_synthesis_status" title="plenoptic.synthesize.metamer.plot_synthesis_status"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_synthesis_status</span></code></a></dt><dd><p>Create a plot summarizing synthesis status at a given iteration.</p>
</dd>
<dt><a class="reference internal" href="plenoptic.synthesize.metamer.html#plenoptic.synthesize.metamer.animate" title="plenoptic.synthesize.metamer.animate"><code class="xref py py-func docutils literal notranslate"><span class="pre">animate</span></code></a></dt><dd><p>Create a video of the metamer changing over the course of synthesis.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reptile_skin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">PortillaSimoncelli</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this isn&#39;t enough to run synthesis to completion, just an example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">losses</span>
<span class="go">tensor([0.0821, ..., 0.0805])</span>
</pre></div>
</div>
<p>You can examine scales_timing attribute to see when MetamerCTF started and
stopped optimizing each scale:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">scales_timing</span>
<span class="go">{&#39;pixel_statistics&#39;: [0],</span>
<span class="go"> &#39;residual_lowpass&#39;: [],</span>
<span class="go"> 3: [],</span>
<span class="go"> 2: [],</span>
<span class="go"> 1: [],</span>
<span class="go"> 0: [],</span>
<span class="go"> &#39;all&#39;: []}</span>
</pre></div>
</div>
<p>Synthesize a metamer, using <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> so we can examine progress
later. (This also enables us to create a video of the metamer changing over
the course of synthesis, see
<a class="reference internal" href="plenoptic.synthesize.metamer.html#plenoptic.synthesize.metamer.animate" title="plenoptic.synthesize.metamer.animate"><code class="xref py py-func docutils literal notranslate"><span class="pre">animate</span></code></a>.)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this isn&#39;t enough to run synthesis to completion, just an example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">store_progress</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([4, 1, 1, 256, 256])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># see loss, etc on the 4th iteration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">progress</span> <span class="o">=</span> <span class="n">met</span><span class="o">.</span><span class="n">get_progress</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">progress</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">dict_keys([&#39;losses&#39;, ..., &#39;saved_metamer&#39;, &#39;store_progress_iteration&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">progress</span><span class="p">[</span><span class="s2">&quot;losses&quot;</span><span class="p">]</span>
<span class="go">tensor(0.0850)</span>
</pre></div>
</div>
<p>Set <code class="docutils literal notranslate"><span class="pre">change_scale_criterion</span></code> and <code class="docutils literal notranslate"><span class="pre">ctf_iters_to_check</span></code> to change
scale-switching behavior.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this isn&#39;t enough to run synthesis to completion, just an example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">change_scale_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctf_iters_to_check</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">losses</span>
<span class="go">tensor([0.0863, ..., 0.0569])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">scales_timing</span>
<span class="go">{&#39;pixel_statistics&#39;: [0, 1],</span>
<span class="go"> &#39;residual_lowpass&#39;: [2, 3],</span>
<span class="go"> 3: [4],</span>
<span class="go"> 2: [],</span>
<span class="go"> 1: [],</span>
<span class="go"> 0: [],</span>
<span class="go"> &#39;all&#39;: []}</span>
</pre></div>
</div>
<p>Adjust <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code> and <code class="docutils literal notranslate"><span class="pre">stop_iters_to_check</span></code> to change how convergence
is determined. In this case, we stop early by making <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code> fairly
large. In practice, you’re more likely to make <code class="docutils literal notranslate"><span class="pre">stop_criterion</span></code> smaller to let
synthesis run for longer.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># this isn&#39;t enough to run synthesis to completion, just an example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">stop_criterion</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">stop_iters_to_check</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/plenoptic/synthesize/metamer.html#MetamerCTF.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.to" title="Link to this definition">#</a></dt>
<dd><p>Move and/or cast the parameters and buffers.</p>
<p>This can be called as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">to</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Its signature is similar to <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.Tensor.to.html#torch.Tensor.to" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.to</span></code></a>, but only accepts
floating point desired <code class="docutils literal notranslate"><span class="pre">dtype</span></code>. In addition, this method will
only cast the floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">dtype</span></code>
(if given). The integral parameters and buffers will be moved
<code class="docutils literal notranslate"><span class="pre">device</span></code>, if that is given, but with dtypes unchanged. When
<cite>on_blocking`</cite> is set, it tries to convert/move asynchronously
with respect to the host if possible, e.g., moving CPU Tensors with
pinned memory to CUDA devices.</p>
<p>See <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module.to" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.to</span></code></a> for examples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method modifies the module in-place.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.10)"><em>torch.device</em></a>) – The desired device of the parameters and buffers in this module.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.dtype" title="(in PyTorch v2.10)"><em>torch.dtype</em></a>) – The desired floating point type of the floating point parameters and
buffers in this module.</p></li>
<li><p><strong>tensor</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><em>torch.Tensor</em></a>) – Tensor whose dtype and device are the desired dtype and device for
all parameters and buffers in this module.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">reptile_skin</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">PortillaSimoncelli</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">MetamerCTF</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">torch.float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">torch.float32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">torch.float64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span>
<span class="go">torch.float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.allowed_range">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">allowed_range</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.allowed_range" title="Link to this definition">#</a></dt>
<dd><p>Allowable range of pixel values.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.coarse_to_fine">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">coarse_to_fine</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.coarse_to_fine" title="Link to this definition">#</a></dt>
<dd><p>How we scales are handled, see <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF" title="plenoptic.synthesize.metamer.MetamerCTF"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetamerCTF</span></code></a> for details.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.gradient_norm">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">gradient_norm</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.gradient_norm" title="Link to this definition">#</a></dt>
<dd><p>Optimization gradient’s L2 norm over iterations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.image">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">image</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.image" title="Link to this definition">#</a></dt>
<dd><p>Target image of metamer optimization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.loss_function" title="Link to this definition">#</a></dt>
<dd><p>Callable which specifies how close metamer representation is to target.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.losses">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">losses</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.losses" title="Link to this definition">#</a></dt>
<dd><p>Optimization loss over iterations.</p>
<p>Will have <code class="docutils literal notranslate"><span class="pre">length=num_iter+1</span></code>, where <code class="docutils literal notranslate"><span class="pre">num_iter</span></code> is the number of
iterations of synthesis run so far.</p>
<p>This tensor always lives on the CPU.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.metamer">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">metamer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.metamer" title="Link to this definition">#</a></dt>
<dd><p>Model metamer, the parameter we are optimizing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.model">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">model</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><span class="pre">Module</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.model" title="Link to this definition">#</a></dt>
<dd><p>The model for which the metamer is synthesized.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.optimizer">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">optimizer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.10)"><span class="pre">Optimizer</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.optimizer" title="Link to this definition">#</a></dt>
<dd><p>Torch optimizer object which updates the synthesis target.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">pixel_change_norm</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.pixel_change_norm" title="Link to this definition">#</a></dt>
<dd><p>L2 norm change in pixel values over iterations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.range_penalty_lambda">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">range_penalty_lambda</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.range_penalty_lambda" title="Link to this definition">#</a></dt>
<dd><p>Magnitude of the penalty on pixel values outside <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.allowed_range" title="plenoptic.synthesize.metamer.MetamerCTF.allowed_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">allowed_range</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.saved_metamer">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">saved_metamer</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.saved_metamer" title="Link to this definition">#</a></dt>
<dd><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.metamer" title="plenoptic.synthesize.metamer.MetamerCTF.metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metamer</span></code></a>, cached over time for later examination.</p>
<p>How often the metamer is cached is determined by the <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> argument
to the <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.synthesize" title="plenoptic.synthesize.metamer.MetamerCTF.synthesize"><code class="xref py py-func docutils literal notranslate"><span class="pre">synthesize</span></code></a> function.</p>
<p>The last entry will always be the current <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.metamer" title="plenoptic.synthesize.metamer.MetamerCTF.metamer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">metamer</span></code></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">store_progress==1</span></code>, then this corresponds directly to <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.losses" title="plenoptic.synthesize.metamer.MetamerCTF.losses"><code class="xref py py-attr docutils literal notranslate"><span class="pre">losses</span></code></a>:
<code class="docutils literal notranslate"><span class="pre">losses[i]</span></code> is the error for <code class="docutils literal notranslate"><span class="pre">saved_metamer[i]</span></code></p>
<p>This tensor always lives on the CPU, regardless of the device of the <code class="docutils literal notranslate"><span class="pre">Metamer</span></code>
object.</p>
<p class="rubric">Examples</p>
<p>If synthesize is called without <code class="docutils literal notranslate"><span class="pre">store_progress</span></code>, then this attribute
just contains the metamer, though the number of dimensions is different:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">remove_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span>
<span class="go">tensor([])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span>
<span class="go">tensor([[[[[ 0.0098, ...]]]]], grad_fn=&lt;StackBackward0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">metamer</span>
<span class="go">tensor([[[[ 0.0098, ...]]]], requires_grad=True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 1, 1, 256, 256])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">metamer</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([1, 1, 256, 256])</span>
</pre></div>
</div>
<p>If synthesize is called with <code class="docutils literal notranslate"><span class="pre">store_progress=1</span></code>, then this attribute
contains the metamer at each iteration, and <code class="docutils literal notranslate"><span class="pre">losses[i]</span></code> contains the error
for <code class="docutils literal notranslate"><span class="pre">saved_metamer[i]</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">synthesize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">store_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span><span class="o">.</span><span class="n">shape</span>
<span class="go">torch.Size([6, 1, 1, 256, 256])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">objective_function</span><span class="p">(</span><span class="n">met</span><span class="o">.</span><span class="n">saved_metamer</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">tensor(0.0169, grad_fn=&lt;AddBackward0&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span><span class="o">.</span><span class="n">losses</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">tensor(0.0169)</span>
</pre></div>
</div>
<p>(In the above example, <code class="docutils literal notranslate"><span class="pre">saved_metamer</span></code> has 6 elements because it includes the
metamer at the start of each of the 5 synthesis iterations, plus the current
one.)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.scales">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">scales</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.scales" title="Link to this definition">#</a></dt>
<dd><p>Model scales that we’ve yet to optimize, modified during optimization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.scales_finished">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">scales_finished</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.scales_finished" title="Link to this definition">#</a></dt>
<dd><p>Model scales that we’ve finished optimizing, modified during optimization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.scales_loss">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">scales_loss</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.scales_loss" title="Link to this definition">#</a></dt>
<dd><p>Scale-specific loss at each iteration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.scales_timing">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">scales_timing</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.scales_timing" title="Link to this definition">#</a></dt>
<dd><p>Information about when each scale was started and stopped.</p>
<p>Keys are the values found in <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.scales" title="plenoptic.synthesize.metamer.MetamerCTF.scales"><code class="xref py py-attr docutils literal notranslate"><span class="pre">scales</span></code></a>, and values are lists specifying
the iteration where we started and stopped optimizing this scale, which are
modified during optimization.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.scheduler">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">scheduler</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.10)"><span class="pre">LRScheduler</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.scheduler" title="Link to this definition">#</a></dt>
<dd><p>Learning rate scheduler which adjusts optimizer learning rate.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.store_progress">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">store_progress</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.store_progress" title="Link to this definition">#</a></dt>
<dd><p>How often we are caching progress.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, we don’t save anything. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, we save every iteration. If
an int, we save every <code class="docutils literal notranslate"><span class="pre">store_progress</span></code> iterations (note then that 0 is the
same as <code class="docutils literal notranslate"><span class="pre">False</span></code> and 1 the same as <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="plenoptic.synthesize.metamer.MetamerCTF.target_representation">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">target_representation</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><span class="pre">Tensor</span></a></span><a class="headerlink" href="#plenoptic.synthesize.metamer.MetamerCTF.target_representation" title="Link to this definition">#</a></dt>
<dd><p><a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.model" title="plenoptic.synthesize.metamer.MetamerCTF.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">model</span></code></a> representation of <a class="reference internal" href="#plenoptic.synthesize.metamer.MetamerCTF.image" title="plenoptic.synthesize.metamer.MetamerCTF.image"><code class="xref py py-attr docutils literal notranslate"><span class="pre">image</span></code></a>.</p>
<p>The goal of synthesis is for <code class="docutils literal notranslate"><span class="pre">model(metamer)</span></code> to match this value.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">plenoptic</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">po</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">einstein</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">simul</span><span class="o">.</span><span class="n">Gaussian</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">po</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">remove_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">met</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">synth</span><span class="o">.</span><span class="n">Metamer</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">met</span><span class="o">.</span><span class="n">target_representation</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plenoptic.synthesize.metamer.Metamer.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Metamer</p>
      </div>
    </a>
    <a class="right-next"
       href="plenoptic.synthesize.eigendistortion.Eigendistortion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Eigendistortion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2019-2025, Plenoptic authors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>